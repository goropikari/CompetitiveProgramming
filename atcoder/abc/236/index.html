<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/CompetitiveProgramming/libs/katex/katex.min.css"> <link rel=stylesheet  href="/CompetitiveProgramming/libs/highlight/github.min.css"> <link rel=stylesheet  href="/CompetitiveProgramming/css/franklin.css"> <link rel=stylesheet  href="/CompetitiveProgramming/css/poole_hyde.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } .result-title a { text-decoration: none; } .result-title a:hover { text-decoration: underline; } .result-preview { color: #808080; } .resultCount { color: #808080; } .result-query { font-weight: bold; } #lunrSearchForm { margin-top: 1em; } </style> <link rel=icon  href="/CompetitiveProgramming/assets/favicon.png"> <title>ABC 236</title> <script src="/CompetitiveProgramming/libs/lunr/lunr.min.js"></script> <script src="/CompetitiveProgramming/libs/lunr/lunr_index.js"></script> <script src="/CompetitiveProgramming/libs/lunr/lunrclient.min.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112840751-3"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-112840751-3'); </script> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <h1><a href="/CompetitiveProgramming/">競プロ メモ</a></h1> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/CompetitiveProgramming/">Home</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/algorithm/">Algorithm</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/atcoder/">AtCoder</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/abc/">ABC</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/arc/">ARC</a> <form id=lunrSearchForm  name=lunrSearchForm > <input class=search-input  name=q  placeholder="Enter search term" type=text > <input type=submit  value=Search  formaction="/CompetitiveProgramming/src/search"> </form> </nav> <p>&copy; <a href=https://github.com/goropikari>goropikari</a>.</p> </div> </div> <div class="content container"> <div class=franklin-content > <h1 id=a_hrefhttpsatcoderjpcontestsabc236abc_236 ><a href="#a_hrefhttpsatcoderjpcontestsabc236abc_236" class=header-anchor ><a href="https://atcoder.jp/contests/abc236">ABC 236</a></a></h1> <div class=franklin-toc ><ol><li><a href="#b_-_who_is_missing">B - Who is missing?</a><li><a href="#d_-_dance">D - Dance</a><li><a href="#f_-_spices">F - Spices</a></ol></div> <h2 id=b_-_who_is_missing ><a href="#b_-_who_is_missing" class=header-anchor >B - Who is missing?</a></h2> <p><a href="https://atcoder.jp/contests/abc236/tasks/abc236_b">問題</a></p> <p>出現回数が3回の数字を出力すればよい.</p> <p>愚直に解くと以下のようになる. これで AC は一応取れる.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-function >vint <span class=hljs-title >card</span><span class=hljs-params >(n+<span class=hljs-number >1</span>)</span></span>;
    <span class=hljs-built_in >rep</span>(i,<span class=hljs-number >4</span>*n<span class=hljs-number >-1</span>) {
        <span class=hljs-type >int</span> a;
        cin &gt;&gt; a;
        card[a]++;
    }

    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,n+<span class=hljs-number >1</span>) {
        <span class=hljs-keyword >if</span> (card[i] != <span class=hljs-number >4</span>) cout &lt;&lt; i &lt;&lt; endl;
    }
}</code></pre> <p>別解</p> <p>数字 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> を XOR で偶数回作用させると 0 になり, 奇数回作用させると <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> になることを思い出すと, 出力すべき数字だけ奇数回だけ出現するので, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mi>O</mi><mi>R</mi><mo stretchy=false >(</mo><msub><mi>A</mi><mn>1</mn></msub><mo separator=true >,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator=true >,</mo><mo>⋯</mo><mtext> </mtext><mo separator=true >,</mo><msub><mi>A</mi><mrow><mn>4</mn><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">XOR(A_1, A_2, \cdots, A_{4N-1})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">XOR</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> が答えとなる.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-type >int</span> x = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep</span>(i,<span class=hljs-number >4</span>*n<span class=hljs-number >-1</span>) {
        <span class=hljs-type >int</span> y; cin &gt;&gt; y;
        x ^= y;
    }
    cout &lt;&lt; x &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/abc236/submissions/28719049">tourist の提出コード</a> を見てこの解放を知った.</p> <p><a href="https://atcoder.jp/contests/abc236/submissions/28723521">提出コード 愚直にカウント</a> <a href="https://atcoder.jp/contests/abc236/submissions/28760849">提出コード XOR</a></p> <h2 id=d_-_dance ><a href="#d_-_dance" class=header-anchor >D - Dance</a></h2> <p><a href="https://atcoder.jp/contests/abc236/tasks/abc236_d">問題</a></p> <p>解説AC</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>N</mi></mrow><annotation encoding="application/x-tex">2N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> 人を二人組ずつに分ける組み合わせは</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mfrac><mrow><msub><mrow></mrow><mrow><mn>2</mn><mi>N</mi></mrow></msub><msub><mi mathvariant=normal >C</mi><mn>2</mn></msub><mo>×</mo><msub><mrow></mrow><mrow><mn>2</mn><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><msub><mi mathvariant=normal >C</mi><mn>2</mn></msub><mo>×</mo><mo>⋯</mo><msub><mrow></mrow><mn>2</mn></msub><msub><mi mathvariant=normal >C</mi><mn>2</mn></msub></mrow><mrow><mi>N</mi><mo stretchy=false >!</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mo stretchy=false >(</mo><mn>2</mn><mi>N</mi><mo stretchy=false >)</mo><mo stretchy=false >!</mo></mrow><mrow><msup><mn>2</mn><mi>N</mi></msup><mi>N</mi><mo stretchy=false >!</mo></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \frac{ {}_{ 2N}\mathrm{C}_{ 2} \times {}_{ 2N-2}\mathrm{C}_{ 2} \times \cdots {}_{ 2}\mathrm{C}_{ 2} }{N!} = \frac{(2N)!}{2^N N!}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.04633em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.36033em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >!</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.113em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >!</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mopen >(</span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >)!</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> <p>となる. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">N = 8</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >8</span></span></span></span> のとき, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>16</mn><mo stretchy=false >!</mo><mi mathvariant=normal >/</mi><mo stretchy=false >(</mo><msup><mn>2</mn><mn>8</mn></msup><mn>8</mn><mo stretchy=false >!</mo><mo stretchy=false >)</mo><mo>=</mo><mn>2027025</mn></mrow><annotation encoding="application/x-tex">16! / (2^8 8!) = 2027025</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class=mord >16</span><span class=mclose >!</span><span class=mord >/</span><span class=mopen >(</span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class=mord >8</span><span class=mclose >!)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2027025</span></span></span></span> 通りであるので組み合わせを全列挙して「舞踏会全体の楽しさ」の最大値を求めれば良い.</p> <pre><code class="cpp hljs"><span class=hljs-type >int</span> n;
vint v, used;
vvint A;

<span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >dfs</span><span class=hljs-params >(<span class=hljs-type >int</span> depth)</span> </span>{
    <span class=hljs-keyword >if</span> (depth == n) {
        <span class=hljs-type >int</span> ans = <span class=hljs-number >0</span>;
        <span class=hljs-built_in >rep</span>(i,n) ans ^= v[i];
        <span class=hljs-keyword >return</span> ans;
    }
    <span class=hljs-type >int</span> ans = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>*n) <span class=hljs-built_in >rep2</span>(j,i+<span class=hljs-number >1</span>,<span class=hljs-number >2</span>*n) {
        <span class=hljs-keyword >if</span> (!used[i] &amp;&amp; !used[j]) {
            used[i] = used[j] = <span class=hljs-number >1</span>;
            v.<span class=hljs-built_in >push_back</span>(A[i][j]);
            <span class=hljs-built_in >chmax</span>(ans, <span class=hljs-built_in >dfs</span>(depth+<span class=hljs-number >1</span>));
            used[i] = used[j] = <span class=hljs-number >0</span>;
            v.<span class=hljs-built_in >pop_back</span>();
        }
    }

    <span class=hljs-keyword >return</span> ans;
}</code></pre> <p>上のように書くと, 余分な組み合わせまで数えてしまっており, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mrow><mn>2</mn><mi>N</mi></mrow></msub><msub><mi mathvariant=normal >C</mi><mn>2</mn></msub><mo>×</mo><msub><mrow></mrow><mrow><mn>2</mn><mi>N</mi><mo>−</mo><mn>2</mn></mrow></msub><msub><mi mathvariant=normal >C</mi><mn>2</mn></msub><mo>×</mo><mo>⋯</mo><msub><mrow></mrow><mn>2</mn></msub><msub><mi mathvariant=normal >C</mi><mn>2</mn></msub><mo>=</mo><mn>81729648000</mn><mo stretchy=false >(</mo><mi>N</mi><mo>=</mo><mn>8</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">{}_{ 2N}\mathrm{C}_{ 2} \times {}_{ 2N-2}\mathrm{C}_{ 2} \times \cdots {}_{ 2}\mathrm{C}_{ 2} = 81729648000 (N = 8)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.891661em;vertical-align:-0.208331em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >81729648000</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >8</span><span class=mclose >)</span></span></span></span> 通りの組み合わせを数えているせいで TLE になる.</p> <p>ここで <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 個目のペアの一人目は, まだ選ばれていない人のうちの最小の番号の人と固定すると,</p> <ul> <li><p>1組目の二人目の選び方が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>N</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2N-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 通り</p> <li><p>2組目の二人目の選び方が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>N</mi><mo>−</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">2N-3</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >3</span></span></span></span> 通り</p> <li><p>...</p> <li><p>2組目の二人目の選び方が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 通り</p> </ul> <p>となり, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">N = 8</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >8</span></span></span></span> のとき <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>15</mn><mo>×</mo><mn>13</mn><mo>×</mo><mo>⋯</mo><mo>×</mo><mn>1</mn><mo>=</mo><mn>2027025</mn></mrow><annotation encoding="application/x-tex">15 \times 13 \times \cdots \times 1 = 2027025</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >15</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >13</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2027025</span></span></span></span> となり, 正しい組み合わせの数となる.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >dfs</span><span class=hljs-params >(<span class=hljs-type >int</span> depth)</span> </span>{
    <span class=hljs-keyword >if</span> (depth == n) {
        <span class=hljs-type >int</span> ans = <span class=hljs-number >0</span>;
        <span class=hljs-built_in >rep</span>(i,n) ans ^= v[i];
        <span class=hljs-keyword >return</span> ans;
    }

    <span class=hljs-type >int</span> s = <span class=hljs-number >-1</span>;
    <span class=hljs-built_in >rep</span>(i,<span class=hljs-number >2</span>*n) <span class=hljs-keyword >if</span> (!used[i]) {
        s = i;
        used[s] = <span class=hljs-number >1</span>;
        <span class=hljs-keyword >break</span>;
    }

    <span class=hljs-type >int</span> ans = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep</span>(j,<span class=hljs-number >2</span>*n) {
        <span class=hljs-keyword >if</span> (!used[j]) {
            used[j] = <span class=hljs-number >1</span>;
            v.<span class=hljs-built_in >push_back</span>(A[s][j]);
            <span class=hljs-built_in >chmax</span>(ans, <span class=hljs-built_in >dfs</span>(depth+<span class=hljs-number >1</span>));
            v.<span class=hljs-built_in >pop_back</span>();
            used[j] = <span class=hljs-number >0</span>;
        }
    }
    used[s] = <span class=hljs-number >0</span>;

    <span class=hljs-keyword >return</span> ans;
}</code></pre> <p><a href="https://atcoder.jp/contests/abc236/submissions/28758809">提出コード</a></p> <h2 id=f_-_spices ><a href="#f_-_spices" class=header-anchor >F - Spices</a></h2> <p><a href="https://atcoder.jp/contests/abc236/tasks/abc236_f">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><msub><mi>F</mi><mn>2</mn></msub><msup><mo stretchy=false >)</mo><mi>N</mi></msup></mrow><annotation encoding="application/x-tex">(F_2)^N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span></span></span></span>-ベクトル空間上の XOR と考えると, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><msub><mi>F</mi><mn>2</mn></msub><msup><mo stretchy=false >)</mo><mi>N</mi></msup><mo>=</mo><mrow><mi mathvariant=normal >s</mi><mi mathvariant=normal >p</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >n</mi></mrow><mo stretchy=false >(</mo><mi>S</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(F_2)^N = \mathrm{span}(S)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">span</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=mclose >)</span></span></span></span> となるような基底の集合 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> を構成するのに必要なコストの最小値はいくつか？という問題に言い換えられる. これを考えると, スパイスを昇順にソートして, 線形独立となるようにスパイスを選んでいけばよいということがわかる.</p> <p>線形独立な集合の構成方法は以下のようになる.</p> <pre><code class="cpp hljs"><span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> [cost, x] : spices) {
    <span class=hljs-built_in >rep</span>(i,n) <span class=hljs-keyword >if</span> (x&gt;&gt;i&amp;<span class=hljs-number >1</span>) x ^= base[i];
    <span class=hljs-keyword >if</span> (x == <span class=hljs-number >0</span>) <span class=hljs-keyword >continue</span>;
    ans += cost;
    <span class=hljs-built_in >rep</span>(i,n) <span class=hljs-keyword >if</span> (x&gt;&gt;i&amp;<span class=hljs-number >1</span>) { base[i] = x; <span class=hljs-keyword >break</span>; }
}</code></pre> <p>初期値として全ての <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> に対して <code>base&#91;i&#93; &#61; 0</code> とする. <code>base&#91;i&#93; &#33;&#61; 0</code> となるような <code>base&#91;i&#93;</code> は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目のビットが 1 である数字の代表であり, <code>base&#91;j&#93; &#40;i &#33;&#61; j&#41;</code> の数字では <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目のビットが 0 となっている.</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> がすでにピックした数字と線形従属ならば <code>rep&#40;i,n&#41; if &#40;x&gt;&gt;i&amp;1&#41; x ^&#61; base&#91;i&#93;;</code> をすると <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> となるので, そのスパイスは選ばない. 逆に線形独立だった場合は基底として採用する. <code>rep&#40;i,n&#41; if &#40;x&gt;&gt;i&amp;1&#41; x ^&#61; base&#91;i&#93;;</code> の部分は結局, ガウスの掃き出し法をしているようなものとなっている.</p> <p>正規直交基底にする場合は&#40;する必要ないけど&#41; <code>rep&#40;i,n&#41; rep&#40;j,n&#41; if &#40;&#40;base&#91;i&#93;&gt;&gt;j&amp;1&#41; &amp;&amp; i &#33;&#61; j&#41; base&#91;i&#93; ^&#61; base&#91;j&#93;;</code> とするとなる.</p> <p><a href="https://atcoder.jp/contests/abc236/submissions/28811515">提出コード</a></p> <div class=page-foot > <div class=copyright > &copy; <a href=https://github.com/goropikari>goropikari</a>. Last modified: February 06, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. This site source is located at <a href=https://goropikari.github.io/CompetitiveProgramming>goropikari/CompetitiveProgramming</a> </div> </div> </div> </div>