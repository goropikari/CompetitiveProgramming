<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/CompetitiveProgramming/libs/katex/katex.min.css"> <link rel=stylesheet  href="/CompetitiveProgramming/libs/highlight/github.min.css"> <link rel=stylesheet  href="/CompetitiveProgramming/css/franklin.css"> <link rel=stylesheet  href="/CompetitiveProgramming/css/poole_hyde.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } .result-title a { text-decoration: none; } .result-title a:hover { text-decoration: underline; } .result-preview { color: #808080; } .resultCount { color: #808080; } .result-query { font-weight: bold; } #lunrSearchForm { margin-top: 1em; } </style> <link rel=icon  href="/CompetitiveProgramming/assets/favicon.png"> <title>AtCoder上達のガイドライン 中級編</title> <script src="/CompetitiveProgramming/libs/lunr/lunr.min.js"></script> <script src="/CompetitiveProgramming/libs/lunr/lunr_index.js"></script> <script src="/CompetitiveProgramming/libs/lunr/lunrclient.min.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112840751-3"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-112840751-3'); </script> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <h1><a href="/CompetitiveProgramming/">競プロ メモ</a></h1> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/CompetitiveProgramming/">Home</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/algorithm/">Algorithm</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/atcoder/">AtCoder</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/abc/">ABC</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/arc/">ARC</a> <form id=lunrSearchForm  name=lunrSearchForm > <input class=search-input  name=q  placeholder="Enter search term" type=text > <input type=submit  value=Search  formaction="/CompetitiveProgramming/src/search"> </form> </nav> <p>&copy; <a href=https://github.com/goropikari>goropikari</a>.</p> </div> </div> <div class="content container"> <div class=franklin-content > <h1 id="レッドコーダーが教える_競プロatcoder上達のガイドライン中級編目指せ水色コーダー_掲載問題メモ"><a href="#レッドコーダーが教える_競プロatcoder上達のガイドライン中級編目指せ水色コーダー_掲載問題メモ" class=header-anchor >『 レッドコーダーが教える, 競プロ・AtCoder上達のガイドライン【中級編：目指せ水色コーダー！】 』掲載問題メモ</a></h1> <p><a href="https://qiita.com/e869120/items/eb50fdaece12be418faa">元記事</a></p> <div class=franklin-toc ><ol><li><a href="#全探索全列挙">全探索：全列挙</a><ol><li><a href="#itp17b_-_how_many_ways">ITP1<em>7</em>B - How Many Ways?</a><li><a href="#atcoder_beginner_contest_106_b_-_105">AtCoder Beginner Contest 106 B - 105</a><li><a href="#atcoder_beginner_contest_122_b_-_atcoder">AtCoder Beginner Contest 122 B - ATCoder</a><li><a href="#パ研杯2019_c_-_カラオケ">パ研杯2019 C - カラオケ</a></ol><li><a href="#全探索工夫して通り数を減らす全列挙">全探索：工夫して通り数を減らす全列挙</a><ol><li><a href="#atcoder_beginner_contest_095_c_-_half_and_half">AtCoder Beginner Contest 095 C - Half and Half</a><li><a href="#三井住友信託銀行プログラミングコンテスト_2019_d_-_lucky_pin">三井住友信託銀行プログラミングコンテスト 2019 D - Lucky PIN</a><li><a href="#joi_2007_本選_3_-_最古の遺跡">JOI 2007 本選 3 - 最古の遺跡</a><li><a href="#square869120contest_6_b_-_atcoder_markets">Square869120Contest #6 B - AtCoder Markets</a><li><a href="#joi_2008_予選_4_-_星座探し">JOI 2008 予選 4 - 星座探し</a></ol><li><a href="#全探索ビット全探索">全探索：ビット全探索</a><ol><li><a href="#alds5a_-_総当たり">ALDS<em>5</em>A - 総当たり</a><li><a href="#atcoder_beginner_contest_128_c_-_switches">AtCoder Beginner Contest 128 C - Switches</a><li><a href="#atcoder_beginner_contest_002_d_-_派閥">AtCoder Beginner Contest 002 D - 派閥</a><li><a href="#joi_2008_予選_5_-_おせんべい">JOI 2008 予選 5 - おせんべい</a><li><a href="#square869120contest_4_b_-_buildings_are_colorful">Square869120Contest #4 B - Buildings are Colorful&#33;</a></ol><li><a href="#全探索順列全探索">全探索：順列全探索</a><ol><li><a href="#atcoder_beginner_contest_145_c_-_average_length">AtCoder Beginner Contest 145 C - Average Length</a><li><a href="#atcoder_beginner_contest_150_c_-_count_order">AtCoder Beginner Contest 150 C - Count Order</a><li><a href="#alds13a_-_8_クイーン問題">ALDS<em>13</em>A - 8 クイーン問題</a></ol><li><a href="#二分探索">二分探索</a><ol><li><a href="#alds4b_-_二分探索">ALDS<em>4</em>B - 二分探索</a><li><a href="#joi_2009_本選_2_-_ピザ">JOI 2009 本選 2 - ピザ</a><li><a href="#atcoder_beginner_contest_077_c_-_snuke_festival">AtCoder Beginner Contest 077 C - Snuke Festival</a><li><a href="#atcoder_beginner_contest_023_d_-_射撃王">AtCoder Beginner Contest 023 D - 射撃王</a><li><a href="#atcoder_regular_contest_054_b_-_ムーアの法則">AtCoder Regular Contest 054 B - ムーアの法則</a><li><a href="#joi_2008_本選_3_-_ダーツ">JOI 2008 本選 3 - ダーツ</a></ol><li><a href="#深さ優先探索">深さ優先探索</a><ol><li><a href="#alds11b_-_深さ優先探索">ALDS<em>11</em>B - 深さ優先探索</a><li><a href="#aoj_1160_-_島はいくつある">AOJ 1160 - 島はいくつある？</a><li><a href="#atcoder_beginner_contest_138_d_-_ki">AtCoder Beginner Contest 138 D - Ki</a><li><a href="#joi_2009_予選_4_-_薄氷渡り">JOI 2009 予選 4 - 薄氷渡り</a></ol><li><a href="#幅優先探索">幅優先探索</a><ol><li><a href="#alds11c_-_幅優先探索">ALDS<em>11</em>C - 幅優先探索</a><li><a href="#atcoder_beginner_contest_007_c_-_幅優先探索">AtCoder Beginner Contest 007 C - 幅優先探索</a><li><a href="#joi_2011_予選_5_-_チーズ">JOI 2011 予選 5 - チーズ</a><li><a href="#joi_2012_予選_5_-_イルミネーション">JOI 2012 予選 5 - イルミネーション</a><li><a href="#aoj_1166_-_迷図と命ず">AOJ 1166 - 迷図と命ず</a><li><a href="#atcoder_beginner_contest_088_d_-_grid_repainting">AtCoder Beginner Contest 088 D - Grid Repainting</a></ol><li><a href="#動的計画法ナップザック_dp">動的計画法：ナップザック DP</a><ol><li><a href="#dpl1b_0-1_ナップザック問題">DPL<em>1</em>B: 0-1 ナップザック問題</a><li><a href="#dpl1c_ナップザック問題">DPL<em>1</em>C ナップザック問題</a><li><a href="#dpl1a_コイン問題">DPL<em>1</em>A コイン問題</a><li><a href="#alds110c_最長共通部分列">ALDS1<em>10</em>C 最長共通部分列</a><li><a href="#joi_2011_予選_4_-_1_年生">JOI 2011 予選 4 - 1 年生</a><li><a href="#joi_2012_予選_4_-_パスタ">JOI 2012 予選 4 - パスタ</a><li><a href="#joi_2013_予選_4_-_暑い日々">JOI 2013 予選 4 - 暑い日々</a><li><a href="#joi_2015_予選_4_-_シルクロード">JOI 2015 予選 4 - シルクロード</a><li><a href="#パ研杯2019_d_-_パ研軍旗">パ研杯2019 D - パ研軍旗</a><li><a href="#aoj_1167_-_ポロック予想">AOJ 1167 - ポロック予想</a><li><a href="#aoj_2199_-_差分パルス符号変調">AOJ 2199 - 差分パルス符号変調</a></ol><li><a href="#動的計画法区間_dp">動的計画法：区間 DP</a><ol><li><a href="#alds10b_-_連鎖行列積">ALDS<em>10</em>B - 連鎖行列積</a><li><a href="#joi_2015_本選_2_-_ケーキの切り分け_2">JOI 2015 本選 2 - ケーキの切り分け 2</a><li><a href="#aoj_1611_ダルマ落とし">AOJ 1611 ダルマ落とし</a></ol><li><a href="#動的計画法bit_dp">動的計画法：bit DP</a><ol><li><a href="#dpl2a_-_巡回セールスマン問題">DPL<em>2</em>A - 巡回セールスマン問題</a><li><a href="#square869120contest_1_g_-_revenge_of_traveling_salesman_problem">Square869120Contest #1 G - Revenge of Traveling Salesman Problem</a><li><a href="#joi_2014_予選_4_-_部活のスケジュール表">JOI 2014 予選 4 - 部活のスケジュール表</a><li><a href="#joi_2017_予選_4_-_ぬいぐるみの整理">JOI 2017 予選 4 - ぬいぐるみの整理</a></ol><li><a href="#動的計画法その他">動的計画法：その他</a><ol><li><a href="#dpl1d_-_最長増加部分列_lis_longest_increasing_subsequence">DPL<em>1</em>D - 最長増加部分列 &#40;LIS, Longest Increasing Subsequence&#41;</a><li><a href="#atcoder_beginner_contest_006_d_-_トランプ挿入ソート">AtCoder Beginner Contest 006 D - トランプ挿入ソート</a><li><a href="#atcoder_beginner_contest_134_e_-_sequence_decomposing">AtCoder Beginner Contest 134 E - Sequence Decomposing</a></ol><li><a href="#最短経路問題ダイクストラ法">最短経路問題：ダイクストラ法</a><ol><li><a href="#grl1a_-_単一始点最短経路">GRL<em>1</em>A - 単一始点最短経路</a><li><a href="#joi_2008_予選_6_-_船旅">JOI 2008 予選 6 - 船旅</a><li><a href="#joi_2016_予選_5_-_ゾンビ島">JOI 2016 予選 5 - ゾンビ島</a><li><a href="#joi_2014_予選_5_-_タクシー">JOI 2014 予選 5 - タクシー</a></ol><li><a href="#最短経路問題ワーシャルフロイド法">最短経路問題：ワーシャルフロイド法</a><ol><li><a href="#grl1c_-_全点対間最短経路">GRL<em>1</em>C - 全点対間最短経路</a><li><a href="#atcoder_beginner_contest_012_d_-_バスと避けられない運命">AtCoder Beginner Contest 012 D - バスと避けられない運命</a><li><a href="#atcoder_beginner_contest_079_d_-_wall">AtCoder Beginner Contest 079 D - Wall</a><li><a href="#atcoder_beginner_contest_074_d_-_restoring_road_network">AtCoder Beginner Contest 074 D - Restoring Road Network</a></ol><li><a href="#最小全域木問題">最小全域木問題</a><ol><li><a href="#grl2a_-_最小全域木">GRL<em>2</em>A - 最小全域木</a><li><a href="#joi_2010_春合宿_-_finals">JOI 2010 春合宿 - Finals</a><li><a href="#aoj_1127_-_building_a_space_station">AOJ 1127 - Building a Space Station</a><li><a href="#atcoder_beginner_contest_065_d_-_built">AtCoder Beginner Contest 065 D - Built?</a></ol><li><a href="#高速な素数判定法">高速な素数判定法</a><ol><li><a href="#ntl1a_-_素因数分解">NTL<em>1</em>A - 素因数分解</a><li><a href="#atcoder_beginner_contest_084_d_-_2017-like_number">AtCoder Beginner Contest 084 D - 2017-like Number</a></ol><li><a href="#高速なべき乗計算">高速なべき乗計算</a><ol><li><a href="#ntl1b_-_べき乗">NTL<em>1</em>B - べき乗</a><li><a href="#square869120contest_1_e_-_散歩">Square869120Contest #1 E - 散歩</a></ol><li><a href="#逆元を使う問題">逆元を使う問題</a><ol><li><a href="#atcoder_beginner_contest_034_c_-_経路">AtCoder Beginner Contest 034 C - 経路</a><li><a href="#atcoder_beginner_contest_145_d_-_knight">AtCoder Beginner Contest 145 D - Knight</a><li><a href="#atcoder_beginner_contest_021_d_-_多重ループ">AtCoder Beginner Contest 021 D - 多重ループ</a><li><a href="#atcoder_beginner_contest_149_f_-_surrounded_nodes">AtCoder Beginner Contest 149 F - Surrounded Nodes</a></ol><li><a href="#全国統一プログラミング王決定戦本戦_a_-_abundant_resources">全国統一プログラミング王決定戦本戦 A - Abundant Resources</a><ol><li><a href="#全国統一プログラミング王決定戦本戦_a_-_abundant_resources__2">全国統一プログラミング王決定戦本戦 A - Abundant Resources</a><li><a href="#joi_2010_本選_1_-_旅人">JOI 2010 本選 1 - 旅人</a><li><a href="#joi_2011_本選_1_-_惑星探査">JOI 2011 本選 1 - 惑星探査</a><li><a href="#atcoder_beginner_contest_106_d_-_atcoder_express_2">AtCoder Beginner Contest 106 D - AtCoder Express 2</a><li><a href="#gigacode_2019_d_-_家の建設">GigaCode 2019 D - 家の建設</a><li><a href="#atcoder_beginner_contest_014_c_-_atcolor">AtCoder Beginner Contest 014 C - AtColor</a><li><a href="#aoj_2013_-_大崎">AOJ 2013 - 大崎</a><li><a href="#joi_2015_本選_1_-_鉄道運賃">JOI 2015 本選 1 - 鉄道運賃</a><li><a href="#joi_2012_本選_4_-_釘">JOI 2012 本選 4 - 釘</a></ol><li><a href="#union-find">Union-Find</a><ol><li><a href="#dsl1a_-_互いに素な集合">DSL<em>1</em>A - 互いに素な集合</a><li><a href="#atcoder_beginner_contest_075_c_-_bridge">AtCoder Beginner Contest 075 C - Bridge</a><li><a href="#atcoder_beginner_contest_120_d_-_decayed_bridge">AtCoder Beginner Contest 120 D - Decayed Bridge</a><li><a href="#joi_2008_本選_1_-_碁石ならべ">JOI 2008 本選 1 - 碁石ならべ</a><li><a href="#joi_2013_本選_1_-_電飾">JOI 2013 本選 1 - 電飾</a><li><a href="#square869120contest_5_b_-_emblem">Square869120Contest #5 B - Emblem</a><li><a href="#atcoder_beginner_contest_144_d_-_water_bottle">AtCoder Beginner Contest 144 D - Water Bottle</a><li><a href="#aoj_1193_-_連鎖消滅パズル">AOJ 1193 - 連鎖消滅パズル</a><li><a href="#square869120contest_3_b_-_石落としゲーム">Square869120Contest #3 B - 石落としゲーム</a><li><a href="#aoj_1149_-_ケーキカット">AOJ 1149 - ケーキカット</a><li><a href="#atcoder_beginner_contest_149_b_-_greedy_takahashi">AtCoder Beginner Contest 149 B - Greedy Takahashi</a><li><a href="#atcoder_beginner_contest_139_d_-_modsum">AtCoder Beginner Contest 139 D - ModSum</a><li><a href="#atcoder_beginner_contest_150_d_-_semi_common_multiple">AtCoder Beginner Contest 150 D - Semi Common Multiple</a><li><a href="#三井住友信託銀行プログラミングコンテスト2019_予選_e_-_colorful_hats_2">三井住友信託銀行プログラミングコンテスト2019 予選 E - Colorful Hats 2</a><li><a href="#ddcc2020_予選_d_-_digit_sum_replace">DDCC2020 予選 D - Digit Sum Replace</a><li><a href="#tenka1_programmer_beginner_contest_d_-_crossing">Tenka1 Programmer Beginner Contest D - Crossing</a></ol></ol></div> <pre><code class="julia hljs"><span class=hljs-comment >###</span>
[問題]()
[提出コード]()</code></pre> <h2 id="全探索全列挙"><a href="#全探索全列挙" class=header-anchor >全探索：全列挙</a></h2> <h3 id=itp17b_-_how_many_ways ><a href="#itp17b_-_how_many_ways" class=header-anchor >ITP1<em>7</em>B - How Many Ways?</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/ITP1_7_B">問題</a> <a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/5/ITP1_7_B/judge/6156067/C&#43;&#43;17">提出コード</a></p> <h3 id=atcoder_beginner_contest_106_b_-_105 ><a href="#atcoder_beginner_contest_106_b_-_105" class=header-anchor >AtCoder Beginner Contest 106 B - 105</a></h3> <p><a href="https://atcoder.jp/contests/abc106/tasks/abc106_b">問題</a> <a href="https://atcoder.jp/contests/abc106/submissions/28158388">提出コード</a></p> <h3 id=atcoder_beginner_contest_122_b_-_atcoder ><a href="#atcoder_beginner_contest_122_b_-_atcoder" class=header-anchor >AtCoder Beginner Contest 122 B - ATCoder</a></h3> <p><a href="https://atcoder.jp/contests/abc122/tasks/abc122_b">問題</a> <a href="https://atcoder.jp/contests/abc122/submissions/28158330">提出コード</a></p> <h3 id="パ研杯2019_c_-_カラオケ"><a href="#パ研杯2019_c_-_カラオケ" class=header-anchor >パ研杯2019 C - カラオケ</a></h3> <p><a href="https://atcoder.jp/contests/pakencamp-2019-day3/tasks/pakencamp_2019_day3_c">問題</a> <a href="https://atcoder.jp/contests/pakencamp-2019-day3/submissions/28161419">提出コード</a></p> <h2 id="全探索工夫して通り数を減らす全列挙"><a href="#全探索工夫して通り数を減らす全列挙" class=header-anchor >全探索：工夫して通り数を減らす全列挙</a></h2> <h3 id=atcoder_beginner_contest_095_c_-_half_and_half ><a href="#atcoder_beginner_contest_095_c_-_half_and_half" class=header-anchor >AtCoder Beginner Contest 095 C - Half and Half</a></h3> <p><a href="https://atcoder.jp/contests/abc095/tasks/arc096_a">問題</a> <a href="https://atcoder.jp/contests/abc095/submissions/28158599">提出コード</a></p> <h3 id="三井住友信託銀行プログラミングコンテスト_2019_d_-_lucky_pin"><a href="#三井住友信託銀行プログラミングコンテスト_2019_d_-_lucky_pin" class=header-anchor >三井住友信託銀行プログラミングコンテスト 2019 D - Lucky PIN</a></h3> <p><a href="https://atcoder.jp/contests/sumitrust2019/tasks/sumitb2019_d">問題</a> <a href="https://atcoder.jp/contests/sumitrust2019/submissions/28159010">提出コード</a></p> <h3 id="joi_2007_本選_3_-_最古の遺跡"><a href="#joi_2007_本選_3_-_最古の遺跡" class=header-anchor >JOI 2007 本選 3 - 最古の遺跡</a></h3> <p><a href="https://atcoder.jp/contests/joi2007ho/tasks/joi2007ho_c">問題</a> <a href="https://atcoder.jp/contests/joi2007ho/submissions/28166905">提出コード</a></p> <h3 id=square869120contest_6_b_-_atcoder_markets ><a href="#square869120contest_6_b_-_atcoder_markets" class=header-anchor >Square869120Contest #6 B - AtCoder Markets</a></h3> <p><a href="https://atcoder.jp/contests/s8pc-6/tasks/s8pc_6_b">問題</a> <a href="https://atcoder.jp/contests/s8pc-6/submissions/28167076">提出コード</a></p> <h3 id="joi_2008_予選_4_-_星座探し"><a href="#joi_2008_予選_4_-_星座探し" class=header-anchor >JOI 2008 予選 4 - 星座探し</a></h3> <p><a href="https://atcoder.jp/contests/joi2008yo/tasks/joi2008yo_d">問題</a> <a href="https://atcoder.jp/contests/joi2008yo/submissions/28167332">提出コード</a></p> <h2 id="全探索ビット全探索"><a href="#全探索ビット全探索" class=header-anchor >全探索：ビット全探索</a></h2> <h3 id="alds5a_-_総当たり"><a href="#alds5a_-_総当たり" class=header-anchor >ALDS<em>5</em>A - 総当たり</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/ALDS1_5_A">問題</a> <a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/5/ALDS1_5_A/judge/6160514/C&#43;&#43;17">提出コード</a></p> <h3 id=atcoder_beginner_contest_128_c_-_switches ><a href="#atcoder_beginner_contest_128_c_-_switches" class=header-anchor >AtCoder Beginner Contest 128 C - Switches</a></h3> <p><a href="https://atcoder.jp/contests/abc128/tasks/abc128_c">問題</a> <a href="https://atcoder.jp/contests/abc128/submissions/28159189">提出コード</a></p> <h3 id="atcoder_beginner_contest_002_d_-_派閥"><a href="#atcoder_beginner_contest_002_d_-_派閥" class=header-anchor >AtCoder Beginner Contest 002 D - 派閥</a></h3> <p><a href="https://atcoder.jp/contests/abc002/tasks/abc002_4">問題</a> <a href="https://atcoder.jp/contests/abc002/submissions/28202911">提出コード</a></p> <h3 id="joi_2008_予選_5_-_おせんべい"><a href="#joi_2008_予選_5_-_おせんべい" class=header-anchor >JOI 2008 予選 5 - おせんべい</a></h3> <p><a href="https://atcoder.jp/contests/joi2008yo/tasks/joi2008yo_e">問題</a></p> <p>行をひっくり返すのが <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>R</mi></msup></mrow><annotation encoding="application/x-tex">2^R</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8413309999999999em;vertical-align:0em;"></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span></span></span></span></span></span></span></span> 通り. 行のひっくり返し方を決めたら列方向は白い丸が増えるようにひっくり返すかそのままにするかを決めればよい.</p> <p><a href="https://atcoder.jp/contests/joi2008yo/submissions/28203202">提出コード</a></p> <h3 id=square869120contest_4_b_-_buildings_are_colorful ><a href="#square869120contest_4_b_-_buildings_are_colorful" class=header-anchor >Square869120Contest #4 B - Buildings are Colorful&#33;</a></h3> <p><a href="https://atcoder.jp/contests/s8pc-4/tasks/s8pc_4_b">問題</a></p> <p>どの建物の高さを増やすかという <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>N</mi></msup></mrow><annotation encoding="application/x-tex">2^N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8413309999999999em;vertical-align:0em;"></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span></span></span></span> 通りを全て試して, 最小コストを求める.</p> <p><a href="https://atcoder.jp/contests/s8pc-4/submissions/28203429">提出コード</a></p> <h2 id="全探索順列全探索"><a href="#全探索順列全探索" class=header-anchor >全探索：順列全探索</a></h2> <h3 id=atcoder_beginner_contest_145_c_-_average_length ><a href="#atcoder_beginner_contest_145_c_-_average_length" class=header-anchor >AtCoder Beginner Contest 145 C - Average Length</a></h3> <p><a href="https://atcoder.jp/contests/abc145/tasks/abc145_c">問題</a> <a href="https://atcoder.jp/contests/abc145/submissions/28160521">提出コード</a></p> <h3 id=atcoder_beginner_contest_150_c_-_count_order ><a href="#atcoder_beginner_contest_150_c_-_count_order" class=header-anchor >AtCoder Beginner Contest 150 C - Count Order</a></h3> <p><a href="https://atcoder.jp/contests/abc150/tasks/abc150_c">問題</a> <a href="https://atcoder.jp/contests/abc150/submissions/28160609">提出コード</a></p> <h3 id="alds13a_-_8_クイーン問題"><a href="#alds13a_-_8_クイーン問題" class=header-anchor >ALDS<em>13</em>A - 8 クイーン問題</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/ALDS1_13_A">問題</a></p> <p>クイーンが <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mi>x</mi><mo separator=true >,</mo><mi>y</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span></span></span></span> にあるとき, そのクイーンが動ける範囲は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >{</mo><mo stretchy=false >(</mo><msup><mi>x</mi><mo mathvariant=normal >′</mo></msup><mo separator=true >,</mo><msup><mi>y</mi><mo mathvariant=normal >′</mo></msup><mo stretchy=false >)</mo><mo>:</mo><mi mathvariant=normal >∣</mi><mi>x</mi><mo>−</mo><msup><mi>x</mi><mo mathvariant=normal >′</mo></msup><mi mathvariant=normal >∣</mi><mo>=</mo><mi mathvariant=normal >∣</mi><mi>y</mi><mo>−</mo><msup><mi>y</mi><mo mathvariant=normal >′</mo></msup><mi mathvariant=normal >∣</mi><mo stretchy=false >}</mo></mrow><annotation encoding="application/x-tex">\{(x^\prime, y^\prime) : |x - x^\prime| = |y - y^\prime| \}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.001892em;vertical-align:-0.25em;"></span><span class=mopen >{(</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >:</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >∣</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.001892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mord >∣</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.001892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mord >∣</span><span class=mclose >}</span></span></span></span> となる. クイーンの置き場所 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mo stretchy=false >!</mo></mrow><annotation encoding="application/x-tex">8!</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class=mord >8</span><span class=mclose >!</span></span></span></span> 通りを全て試す.</p> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/5/ALDS1_13_A/judge/6160721/C&#43;&#43;14">提出コード</a></p> <h2 id="二分探索"><a href="#二分探索" class=header-anchor >二分探索</a></h2> <h3 id="alds4b_-_二分探索"><a href="#alds4b_-_二分探索" class=header-anchor >ALDS<em>4</em>B - 二分探索</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/ALDS1_4_B">問題</a> <a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/4/ALDS1_4_B/judge/6161188/C&#43;&#43;14">提出コード</a></p> <h3 id="joi_2009_本選_2_-_ピザ"><a href="#joi_2009_本選_2_-_ピザ" class=header-anchor >JOI 2009 本選 2 - ピザ</a></h3> <p><a href="https://atcoder.jp/contests/joi2009ho/tasks/joi2009ho_b">問題</a></p> <p>店の場所を表す <code>vector</code> に 0, N を追加し, ソートする. 0, N は本店を表し, 二分探索するときの番兵の役割を果たす.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> d, n, m;
    cin &gt;&gt; d &gt;&gt; n &gt;&gt;  m;
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >shop</span><span class=hljs-params >(n<span class=hljs-number >-1</span>)</span></span>;
    <span class=hljs-built_in >rep</span>(i,n<span class=hljs-number >-1</span>) cin &gt;&gt; shop[i];
    shop.<span class=hljs-built_in >push_back</span>(<span class=hljs-number >0</span>);
    shop.<span class=hljs-built_in >push_back</span>(d);
    <span class=hljs-built_in >sort</span>(<span class=hljs-built_in >all</span>(shop));

    ll ans = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep</span>(i,m) {
        <span class=hljs-type >int</span> k;
        cin &gt;&gt; k;
        <span class=hljs-keyword >auto</span> it = <span class=hljs-built_in >upper_bound</span>(<span class=hljs-built_in >all</span>(shop), k);
        ans += <span class=hljs-built_in >min</span>(*it - k, k - *(it<span class=hljs-number >-1</span>));
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p>二分探索するときは <code>upper_bound</code> の方を使う. <code>lower_bound</code> は指定された要素以上の値をところの iterator を返してくるので, 多くの場合は <code>min&#40;*it - k, k - *&#40;it - 1&#41;</code> で正しい距離が求まるが, k &#61; 0 のときは <code>it - 1</code> が <code>shohp.begin&#40;&#41;</code> よりも前のアドレスを指してしまうので芳しくない. &#40;lower_bound 番のコードでも AC 出てしまったけれど. &#41;</p> <p>upper_bound であればそのへんの心配がないので楽</p> <p><a href="https://atcoder.jp/contests/joi2009ho/submissions/28283279">提出コード</a></p> <h3 id=atcoder_beginner_contest_077_c_-_snuke_festival ><a href="#atcoder_beginner_contest_077_c_-_snuke_festival" class=header-anchor >AtCoder Beginner Contest 077 C - Snuke Festival</a></h3> <p><a href="https://atcoder.jp/contests/abc077/tasks/arc084_a">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> の値を動かして, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> のとり得る範囲を二分探索で調べる. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy=false >(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">O(N\log N)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop >lo<span style="margin-right:0.01389em;">g</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >)</span></span></span></span> で解ける.</p> <p><a href="https://atcoder.jp/contests/abc077/submissions/28207529">提出コード</a></p> <h3 id="atcoder_beginner_contest_023_d_-_射撃王"><a href="#atcoder_beginner_contest_023_d_-_射撃王" class=header-anchor >AtCoder Beginner Contest 023 D - 射撃王</a></h3> <p><a href="https://atcoder.jp/contests/abc023/tasks/abc023_d">問題</a></p> <p>風船 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> が割られる時刻を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> とすると, ゲームの得点が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> だったとき <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi mathvariant=normal >∀</mi><mi>i</mi><mo separator=true >,</mo><msub><mi>H</mi><mi>i</mi></msub><mo>+</mo><msub><mi>k</mi><mi>i</mi></msub><msub><mi>S</mi><mi>i</mi></msub><mo>≤</mo><mi>x</mi><mo>⇒</mo><msub><mi>k</mi><mi>i</mi></msub><mo>≤</mo><mfrac><mrow><mi>x</mi><mo>−</mo><msub><mi>H</mi><mi>i</mi></msub></mrow><msub><mi>S</mi><mi>i</mi></msub></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \forall i, H_i + k_i S_i \leq x \Rightarrow k_i \leq \frac{x - H_i}{S_i}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >∀</span><span class="mord mathnormal">i</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >⇒</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.19633em;vertical-align:-0.8360000000000001em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.36033em;"><span style="top:-2.3139999999999996em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> が成り立つ.</p> <p>不等式より, 得点を固定すると各風船は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>x</mi><mo>−</mo><msub><mi>H</mi><mi>i</mi></msub></mrow><msub><mi>S</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{x - H_i}{S_i}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.3335309999999998em;vertical-align:-0.44509999999999994em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8884309999999999em;"><span style="top:-2.655em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.05764em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.08125em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.44509999999999994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 秒以内に割らないといけないことがわかる. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 秒&#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">j \geq 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>&#41;経過したとき <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub><mo>≤</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">k_i \leq j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> を満たす <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> の数が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j+1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> を超えなければ得点の上限は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> となり, 逆に超えた場合は得点 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> を取ることは不可能である. この得点 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> は二分探索で求めることができる.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >H</span><span class=hljs-params >(n)</span>, <span class=hljs-title >S</span><span class=hljs-params >(n)</span></span>;
    ll ok = <span class=hljs-number >0</span>, ng = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep</span>(i,n) {
        cin &gt;&gt; H[i] &gt;&gt; S[i];
        <span class=hljs-built_in >chmax</span>(ng, H[i]<span class=hljs-number >-1</span>);
        <span class=hljs-built_in >chmax</span>(ok, H[i]+(n<span class=hljs-number >-1</span>)*S[i]);
    }

    ll ans = INF;
    <span class=hljs-keyword >while</span> (<span class=hljs-built_in >abs</span>(ok - ng) &gt; <span class=hljs-number >1</span>) {
        <span class=hljs-comment >// 答えが mid のとき, 各風船を何秒後までに割らないといけないかを計算する</span>
        ll mid = (ok + ng) / <span class=hljs-number >2</span>;
        <span class=hljs-comment >// cnt[i]: i 秒後までに割らないといけない風船の数</span>
        <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >cnt</span><span class=hljs-params >(n)</span></span>;
        <span class=hljs-built_in >rep</span>(i,n) {
            ll k = (mid - H[i]) / S[i];
            <span class=hljs-keyword >if</span> (k &gt; n<span class=hljs-number >-1</span>) cnt[n<span class=hljs-number >-1</span>]++;
            <span class=hljs-keyword >else</span> <span class=hljs-keyword >if</span> (k &lt; <span class=hljs-number >0</span>) cnt[<span class=hljs-number >0</span>]++;
            <span class=hljs-keyword >else</span> cnt[k]++;
        }
        <span class=hljs-built_in >rep</span>(i,n<span class=hljs-number >-1</span>) cnt[i+<span class=hljs-number >1</span>] += cnt[i];

        <span class=hljs-type >int</span> achievable = <span class=hljs-number >1</span>;
        <span class=hljs-built_in >rep</span>(i,n) {
            <span class=hljs-comment >// 答えが mid のとき, i 秒後までに割らないといけない風船の数が</span>
            <span class=hljs-comment >// i+1 個を超えていた場合, mid は答えとして小さすぎるため不適</span>
            <span class=hljs-keyword >if</span> (cnt[i] &gt; i+<span class=hljs-number >1</span>) {
                ng = mid;
                achievable = <span class=hljs-number >0</span>;
                <span class=hljs-keyword >break</span>;
            }
        }
        <span class=hljs-keyword >if</span> (achievable) {
            <span class=hljs-built_in >chmin</span>(ans, mid);
            ok = mid;
        }
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p>ここでは<a href="https://twitter.com/meguru_comp/status/697008509376835584">めぐる式二分探索</a>を使った.</p> <p><a href="https://atcoder.jp/contests/abc023/submissions/28208977">提出コード</a></p> <h3 id="atcoder_regular_contest_054_b_-_ムーアの法則"><a href="#atcoder_regular_contest_054_b_-_ムーアの法則" class=header-anchor >AtCoder Regular Contest 054 B - ムーアの法則</a></h3> <p><a href="https://atcoder.jp/contests/arc054/tasks/arc054_b">問題</a></p> <p>解いてない</p> <h3 id="joi_2008_本選_3_-_ダーツ"><a href="#joi_2008_本選_3_-_ダーツ" class=header-anchor >JOI 2008 本選 3 - ダーツ</a></h3> <p><a href="https://atcoder.jp/contests/joi2008ho/tasks/joi2008ho_c">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">P_0 = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> &#40;ダーツを投げなかった or 的を外したときの点数&#41; とすると1本投げて獲得できる点数は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">0 \leq i \leq N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.79549em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>&#41;, 2本投げて獲得できる点数は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>+</mo><msub><mi>P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">P_i + P_j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>i</mi><mo separator=true >,</mo><mi>j</mi><mo>≤</mo><mi>N</mi><mo>∧</mo><msub><mi>P</mi><mi>i</mi></msub><mo>+</mo><msub><mi>P</mi><mi>j</mi></msub><mo>≤</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">0 \leq i,j \leq N \wedge P_i + P_j \leq M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">i</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∧</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>&#41;となる.</p> <p>2本投げた時点での得点を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> とすると, 残り2本を投げて獲得できる得点が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>+</mo><msub><mi>P</mi><mi>j</mi></msub><mo>≤</mo><mi>M</mi><mo>−</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">P_i + P_j \leq M - x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> を満たす <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>+</mo><msub><mi>P</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">P_i + P_j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> のうちの最大値をとったとき合計得点が最も大きくなる.</p> <p>最初の2本の得点が決まったとき, 残りの2本の得点は二分探索で高速に探すことができる.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n, m;
    cin &gt;&gt; n &gt;&gt; m;
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >p</span><span class=hljs-params >(n+<span class=hljs-number >1</span>, <span class=hljs-number >0</span>)</span>, pp</span>;
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; p[i+<span class=hljs-number >1</span>];
    <span class=hljs-built_in >rep</span>(i,n+<span class=hljs-number >1</span>) <span class=hljs-built_in >rep2</span>(j,i,n+<span class=hljs-number >1</span>) <span class=hljs-keyword >if</span> (p[i]+p[j] &lt;= m) pp.<span class=hljs-built_in >push_back</span>(p[i]+p[j]);
    <span class=hljs-built_in >sort</span>(<span class=hljs-built_in >all</span>(pp));

    <span class=hljs-type >int</span> ans = <span class=hljs-number >0</span>;
    <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> x : pp) {
        <span class=hljs-keyword >auto</span> it = <span class=hljs-built_in >upper_bound</span>(<span class=hljs-built_in >all</span>(pp), m-x);
        <span class=hljs-built_in >chmax</span>(ans, *(it<span class=hljs-number >-1</span>) + x);
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p>上記のコードでは2本の得点を作る段階で <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> を超えた値は入れないようにしているが, その処理を入れない場合は <code>m - x</code> の値が負になることがある. その場合 <code>it</code> は <code>pp.begin&#40;&#41;</code> になるので飛ばすという書き方もある.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n, m;
    cin &gt;&gt; n &gt;&gt; m;
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >p</span><span class=hljs-params >(n+<span class=hljs-number >1</span>, <span class=hljs-number >0</span>)</span>, pp</span>;
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; p[i+<span class=hljs-number >1</span>];
    <span class=hljs-built_in >rep</span>(i,n+<span class=hljs-number >1</span>) <span class=hljs-built_in >rep2</span>(j,i,n+<span class=hljs-number >1</span>) pp.<span class=hljs-built_in >push_back</span>(p[i]+p[j]);
    <span class=hljs-built_in >sort</span>(<span class=hljs-built_in >all</span>(pp));

    <span class=hljs-type >int</span> ans = <span class=hljs-number >0</span>;
    <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> x : pp) {
        <span class=hljs-keyword >auto</span> it = <span class=hljs-built_in >upper_bound</span>(<span class=hljs-built_in >all</span>(pp), m-x);
        <span class=hljs-keyword >if</span> (it == pp.<span class=hljs-built_in >begin</span>()) <span class=hljs-keyword >continue</span>;
        <span class=hljs-built_in >chmax</span>(ans, *(it<span class=hljs-number >-1</span>) + x);
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/joi2008ho/submissions/28213217">提出コード</a></p> <h2 id="深さ優先探索"><a href="#深さ優先探索" class=header-anchor >深さ優先探索</a></h2> <h3 id="alds11b_-_深さ優先探索"><a href="#alds11b_-_深さ優先探索" class=header-anchor >ALDS<em>11</em>B - 深さ優先探索</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/ALDS1_11_B">問題</a> <a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/4/ALDS1_11_B/judge/6162203/C&#43;&#43;14">提出コード</a></p> <h3 id="aoj_1160_-_島はいくつある"><a href="#aoj_1160_-_島はいくつある" class=header-anchor >AOJ 1160 - 島はいくつある？</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/1160">問題</a> <a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/4/1160/judge/6162242/C&#43;&#43;14">提出コード</a></p> <h3 id=atcoder_beginner_contest_138_d_-_ki ><a href="#atcoder_beginner_contest_138_d_-_ki" class=header-anchor >AtCoder Beginner Contest 138 D - Ki</a></h3> <p><a href="https://atcoder.jp/contests/abc138/tasks/abc138_d">問題</a> <a href="https://atcoder.jp/contests/abc138/submissions/28213792">提出コード</a></p> <h3 id="joi_2009_予選_4_-_薄氷渡り"><a href="#joi_2009_予選_4_-_薄氷渡り" class=header-anchor >JOI 2009 予選 4 - 薄氷渡り</a></h3> <p><a href="https://atcoder.jp/contests/joi2009yo/tasks/joi2009yo_d">問題</a> <a href="https://atcoder.jp/contests/joi2009yo/submissions/28214093">提出コード</a></p> <h2 id="幅優先探索"><a href="#幅優先探索" class=header-anchor >幅優先探索</a></h2> <h3 id="alds11c_-_幅優先探索"><a href="#alds11c_-_幅優先探索" class=header-anchor >ALDS<em>11</em>C - 幅優先探索</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/ALDS1_11_C">問題</a> <a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/4/ALDS1_11_C/judge/6162659/C&#43;&#43;17">提出コード</a></p> <h3 id="atcoder_beginner_contest_007_c_-_幅優先探索"><a href="#atcoder_beginner_contest_007_c_-_幅優先探索" class=header-anchor >AtCoder Beginner Contest 007 C - 幅優先探索</a></h3> <p><a href="https://atcoder.jp/contests/abc007/tasks/abc007_3">問題</a> <a href="https://atcoder.jp/contests/abc007/submissions/28217073">提出コード</a></p> <h3 id="joi_2011_予選_5_-_チーズ"><a href="#joi_2011_予選_5_-_チーズ" class=header-anchor >JOI 2011 予選 5 - チーズ</a></h3> <p><a href="https://atcoder.jp/contests/joi2011yo/tasks/joi2011yo_e">問題</a> <a href="https://atcoder.jp/contests/joi2011yo/submissions/28217300">提出コード</a></p> <h3 id="joi_2012_予選_5_-_イルミネーション"><a href="#joi_2012_予選_5_-_イルミネーション" class=header-anchor >JOI 2012 予選 5 - イルミネーション</a></h3> <p><a href="https://atcoder.jp/contests/joi2012yo/tasks/joi2012yo_e">問題</a> <a href="https://atcoder.jp/contests/joi2012yo/submissions/28218973">提出コード</a></p> <h3 id="aoj_1166_-_迷図と命ず"><a href="#aoj_1166_-_迷図と命ず" class=header-anchor >AOJ 1166 - 迷図と命ず</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/1166">問題</a> <a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/4/1166/judge/6163330/C&#43;&#43;17">提出コード</a></p> <h3 id=atcoder_beginner_contest_088_d_-_grid_repainting ><a href="#atcoder_beginner_contest_088_d_-_grid_repainting" class=header-anchor >AtCoder Beginner Contest 088 D - Grid Repainting</a></h3> <p><a href="https://atcoder.jp/contests/abc088/tasks/abc088_d">問題</a> <a href="https://atcoder.jp/contests/abc088/submissions/28221687">提出コード</a></p> <h2 id="動的計画法ナップザック_dp"><a href="#動的計画法ナップザック_dp" class=header-anchor >動的計画法：ナップザック DP</a></h2> <h3 id="dpl1b_0-1_ナップザック問題"><a href="#dpl1b_0-1_ナップザック問題" class=header-anchor >DPL<em>1</em>B: 0-1 ナップザック問題</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/DPL_1_B">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目までの品物を使って重さの総和が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 以下のときの価値の最大値</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目の品物を使わなかったときと <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i-1][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span> と, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目の品物を使うとき <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mi>w</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i-1][j-w[i]]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]]</span></span></span></span> の大きい方を選ぶ.</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false >(</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo separator=true >,</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mi>w</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >]</mo><mo>+</mo><mi>v</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">dp[i][j] = \max(dp[i-1][j], dp[i-1][j-w[i]] + v[i])</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >max</span><span class=mopen >(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >])</span></span></span></span> <pre><code class="cpp hljs">vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >dp</span>(N+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(W+<span class=hljs-number >1</span>,<span class=hljs-number >0</span>));
<span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,N+<span class=hljs-number >1</span>) {
    <span class=hljs-built_in >rep</span>(j,W+<span class=hljs-number >1</span>) {
        <span class=hljs-keyword >if</span> (j-w[i] &gt;= <span class=hljs-number >0</span>) <span class=hljs-built_in >chmax</span>(dp[i][j], dp[i<span class=hljs-number >-1</span>][j-w[i]] + v[i]);
        <span class=hljs-built_in >chmax</span>(dp[i][j], dp[i<span class=hljs-number >-1</span>][j]);
    }
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/DPL_1_B/judge/6163387/C&#43;&#43;17">提出コード</a></p> <h3 id="dpl1c_ナップザック問題"><a href="#dpl1c_ナップザック問題" class=header-anchor >DPL<em>1</em>C ナップザック問題</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/DPL_1_C">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>w</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[w]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mclose >]</span></span></span></span>: 重さが <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> を以下のときの価値の最大値</p> <pre><code class="cpp hljs"><span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >dp</span><span class=hljs-params >(W+<span class=hljs-number >1</span>,<span class=hljs-number >0</span>)</span></span>;
<span class=hljs-built_in >rep</span>(j,W+<span class=hljs-number >1</span>) {
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,N+<span class=hljs-number >1</span>) {
        <span class=hljs-keyword >if</span> (j + w[i] &lt;= W) <span class=hljs-built_in >chmax</span>(dp[j+w[i]], dp[j]+v[i]);
    }
}
ans = dp[W];</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/DPL_1_C/judge/6163401/C&#43;&#43;14">提出コード</a></p> <h3 id="dpl1a_コイン問題"><a href="#dpl1a_コイン問題" class=header-anchor >DPL<em>1</em>A コイン問題</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/DPL_1_A">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>n</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[n]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">n</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> 円払うときのコインの最小枚数</p> <p>0円払うとき必要なコインは 0 枚だから <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mn>0</mn><mo stretchy=false >]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">dp[0] = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class=mord >0</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>.</p> <pre><code class="cpp hljs"><span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >dp</span><span class=hljs-params >(n+<span class=hljs-number >1</span>, INF)</span></span>;
dp[<span class=hljs-number >0</span>] = <span class=hljs-number >0</span>;
<span class=hljs-built_in >rep</span>(i,n+<span class=hljs-number >1</span>) {
    <span class=hljs-built_in >rep</span>(j,m) {
        <span class=hljs-keyword >if</span> (i+coins[j] &lt;= n) <span class=hljs-built_in >chmin</span>(dp[i+coins[j]], dp[i] + <span class=hljs-number >1</span>);
    }
}
<span class=hljs-comment >// ans = dp[n];</span></code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/DPL_1_A/judge/6163410/C&#43;&#43;17">提出コード</a></p> <h3 id="alds110c_最長共通部分列"><a href="#alds110c_最長共通部分列" class=header-anchor >ALDS1<em>10</em>C 最長共通部分列</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/ALDS1_10_C">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span>: 文字列 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 文字目, 文字列 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 文字目まで見たときの最長共通部分列</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><msub><mi>Y</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">X_i = Y_j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> のとき <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">dp[i][j] = dp[i-1][j-1] + 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span></p> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo mathvariant=normal >≠</mo><msub><mi>Y</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">X_i \neq Y_j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class="mord vbox"><span class=thinbox ><span class=rlap ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class=mord ><span class=mrel ></span></span></span><span class=fix ></span></span></span></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> のとき, 文字列 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> の見ている文字を右に進めるか, 文字列 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> の見ている文字を右に進めるかの2択. よって <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i-1][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span> または <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][j-1]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span></span></span></span> のうちの大きい方 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false >(</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo separator=true >,</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">dp[i][j] = \max(dp[i-1][j], dp[i][j-1])</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >max</span><span class=mopen >(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >])</span></span></span></span>.</p> </ul> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >lcs</span><span class=hljs-params >(string s, string t)</span> </span>{
    <span class=hljs-type >int</span> lens = s.<span class=hljs-built_in >size</span>(), lent = t.<span class=hljs-built_in >size</span>();
    vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >dp</span>(lens+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(lent+<span class=hljs-number >1</span>, <span class=hljs-number >0</span>));
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,lens+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep2</span>(j,<span class=hljs-number >1</span>,lent+<span class=hljs-number >1</span>) {
            <span class=hljs-keyword >if</span> (s[i<span class=hljs-number >-1</span>] == t[j<span class=hljs-number >-1</span>]) dp[i][j] = dp[i<span class=hljs-number >-1</span>][j<span class=hljs-number >-1</span>] + <span class=hljs-number >1</span>;
            <span class=hljs-keyword >else</span> dp[i][j] = <span class=hljs-built_in >max</span>(dp[i<span class=hljs-number >-1</span>][j], dp[i][j<span class=hljs-number >-1</span>]);
        }
    }

    <span class=hljs-keyword >return</span> dp[lens][lent];
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/ALDS1_10_C/judge/6163429/C&#43;&#43;17">提出コード</a></p> <h3 id="joi_2011_予選_4_-_1_年生"><a href="#joi_2011_予選_4_-_1_年生" class=header-anchor >JOI 2011 予選 4 - 1 年生</a></h3> <p><a href="https://atcoder.jp/contests/joi2011yo/tasks/joi2011yo_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][x]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目までの数字を足し引きをして <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> となる場合の数 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 番目の数字を足し引きして <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> 番目の数字と同じになる場合の数が答え</p> <p>一番はじめの数は足す一択だから <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>a</mi><mo stretchy=false >[</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >]</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">dp[1][a[1]] = 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">a</span><span class=mopen >[</span><span class=mord >1</span><span class=mclose >]]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>.</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> が小さい方から決めていく.</p> <p>配る dp の場合</p> <pre><code class="cpp hljs"><span class=hljs-comment >// dp[i][x]: i 番目の数字を足し引きして x となる場合の数</span>
vector&lt;vector&lt;ll&gt;&gt; <span class=hljs-built_in >dp</span>(n+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;ll&gt;(<span class=hljs-number >21</span>,<span class=hljs-number >0</span>));
<span class=hljs-comment >// 1 番目の数は足す一択</span>
dp[<span class=hljs-number >1</span>][a[<span class=hljs-number >1</span>]] = <span class=hljs-number >1</span>;

<span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,n) {
    <span class=hljs-built_in >rep</span>(x,<span class=hljs-number >21</span>) {
        <span class=hljs-comment >// i 番目の数が x+a[i] となるのは dp[i-1] のとき x で i 番目の数字 a[i] を足したとき</span>
        <span class=hljs-keyword >if</span> (x+a[i] &lt;= <span class=hljs-number >20</span>) dp[i][x+a[i]] += dp[i<span class=hljs-number >-1</span>][x];

        <span class=hljs-comment >// i 番目の数が x-a[i] となるのは dp[i-1] のとき x で i 番目の数字 a[i] を引いたとき</span>
        <span class=hljs-keyword >if</span> (x-a[i] &gt;= <span class=hljs-number >0</span>) dp[i][x-a[i]] += dp[i<span class=hljs-number >-1</span>][x];
    }
}

<span class=hljs-comment >// n-1 番目の数を足し引きして, n 番目の数と一致する場合な数</span>
cout &lt;&lt; dp[n<span class=hljs-number >-1</span>][a[n]] &lt;&lt; endl;</code></pre> <p><a href="https://atcoder.jp/contests/joi2011yo/submissions/28253843">提出コード</a></p> <p>集める dp の場合</p> <pre><code class="cpp hljs"><span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,n) {
    <span class=hljs-built_in >rep</span>(x,<span class=hljs-number >21</span>) {
        <span class=hljs-comment >// i 番目の数字が x のなるのは i-1 の数字が x-a[i] で, i番目で a[i] を足したとき</span>
        <span class=hljs-keyword >if</span> (x-a[i] &gt;= <span class=hljs-number >0</span>) dp[i][x] += dp[i<span class=hljs-number >-1</span>][x-a[i]];

        <span class=hljs-comment >// i 番目の数字が x のなるのは i-1 の数字が x+a[i] で, i番目で a[i] を引いたとき</span>
        <span class=hljs-keyword >if</span> (x+a[i] &lt;= <span class=hljs-number >20</span>) dp[i][x] += dp[i<span class=hljs-number >-1</span>][x+a[i]];
    }
}</code></pre> <p><a href="https://atcoder.jp/contests/joi2011yo/submissions/28253965">提出コード</a></p> <h3 id="joi_2012_予選_4_-_パスタ"><a href="#joi_2012_予選_4_-_パスタ" class=header-anchor >JOI 2012 予選 4 - パスタ</a></h3> <p><a href="https://atcoder.jp/contests/joi2012yo/tasks/joi2012yo_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][x][y]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目にソース x を食べ, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> にソース y を食べたときの場合の数.</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 日目にソース x を食べたとき, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">i-2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span></span></span></span> 日目には x 以外のソースを食べる必要があるため <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo>=</mo><munder><mo>∑</mo><mrow><mi>k</mi><mo mathvariant=normal >≠</mo><mi>x</mi></mrow></munder><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>k</mi><mo stretchy=false >]</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[i][x][x] = \sum_{k \neq x} dp[i-1][x][k]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.488226em;vertical-align:-1.438221em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.050005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class=fix ></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.0500049999999996em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.438221em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span></span></span></span></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 日目に食べるソースが違った場合は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">i-2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span></span></span></span> 日目に何を食べてもよいので <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo stretchy=false >]</mo><mo>=</mo><munder><mo>∑</mo><mi>k</mi></munder><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>k</mi><mo stretchy=false >]</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[i][x][y] = \sum_{k} dp[i-1][y][k]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.3521180000000004em;vertical-align:-1.3021129999999999em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000005em;"><span style="top:-1.847887em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021129999999999em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span></span></span></span></p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> N, K;
    cin &gt;&gt; N &gt;&gt; K;
    <span class=hljs-comment >// dp[i][x][y]: i日目にソース x を食べ, i-1 日目にはソース y を食べたときの場合の数</span>
    <span class=hljs-comment >// ソースの種類 1 &lt;= x, y &lt;= 3</span>
    <span class=hljs-comment >// y = 0 のときは食べなかったことを表す</span>
    <span class=hljs-type >int</span> dp[<span class=hljs-number >105</span>][<span class=hljs-number >4</span>][<span class=hljs-number >4</span>];
    <span class=hljs-built_in >rep</span>(i,<span class=hljs-number >105</span>) <span class=hljs-built_in >rep</span>(j,<span class=hljs-number >4</span>) <span class=hljs-built_in >rep</span>(k,<span class=hljs-number >4</span>) dp[i][j][k] = <span class=hljs-number >0</span>;

    map&lt;<span class=hljs-type >int</span>,<span class=hljs-type >int</span>&gt; mp;
    <span class=hljs-built_in >rep</span>(i,K) {
        <span class=hljs-type >int</span> a, b;
        cin &gt;&gt; a &gt;&gt; b;
        mp[a] = b;
    }

    <span class=hljs-type >const</span> <span class=hljs-type >int</span> MOD = <span class=hljs-number >10000</span>;
    <span class=hljs-keyword >if</span> (mp.<span class=hljs-built_in >find</span>(<span class=hljs-number >1</span>) != mp.<span class=hljs-built_in >end</span>()) {
        dp[<span class=hljs-number >1</span>][mp[<span class=hljs-number >1</span>]][<span class=hljs-number >0</span>] = <span class=hljs-number >1</span>;
    } <span class=hljs-keyword >else</span> {
        <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,<span class=hljs-number >4</span>) dp[<span class=hljs-number >1</span>][i][<span class=hljs-number >0</span>] = <span class=hljs-number >1</span>;
    }

    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,N+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep2</span>(x,<span class=hljs-number >1</span>,<span class=hljs-number >4</span>) {
            <span class=hljs-keyword >if</span> (mp.<span class=hljs-built_in >find</span>(i) != mp.<span class=hljs-built_in >end</span>()) {
                <span class=hljs-comment >// i 日目に食べるものが決まっていた場合は, それ以外の候補は除外する</span>
                <span class=hljs-keyword >if</span> (x != mp[i]) <span class=hljs-keyword >continue</span>;
            }
            <span class=hljs-built_in >rep</span>(y,<span class=hljs-number >4</span>) {
                <span class=hljs-keyword >if</span> (x == y) {
                    <span class=hljs-built_in >rep</span>(z,<span class=hljs-number >4</span>) {
                        <span class=hljs-comment >// i, i-1 日目にソース x を食べたとき, i-2 日目には x 以外のソースを食べる必要がある</span>
                        <span class=hljs-keyword >if</span> (z != x) {
                            dp[i][x][x] += dp[i<span class=hljs-number >-1</span>][x][z];
                            dp[i][x][x] %= MOD;
                        }
                    }
                } <span class=hljs-keyword >else</span> {
                    <span class=hljs-built_in >rep</span>(z,<span class=hljs-number >4</span>) {
                        dp[i][x][y] += dp[i<span class=hljs-number >-1</span>][y][z];
                        dp[i][x][y] %= MOD;
                    }
                }
            }
        }
    }


    ll ans = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,<span class=hljs-number >4</span>) <span class=hljs-built_in >rep2</span>(j,<span class=hljs-number >1</span>,<span class=hljs-number >4</span>) {
        ans += dp[N][i][j];
        ans %= MOD;
    }
    cout &lt;&lt; ans &lt;&lt; endl;</code></pre> <p><a href="https://atcoder.jp/contests/joi2012yo/submissions/28232419">提出コード</a></p> <h3 id="joi_2013_予選_4_-_暑い日々"><a href="#joi_2013_予選_4_-_暑い日々" class=header-anchor >JOI 2013 予選 4 - 暑い日々</a></h3> <p><a href="https://atcoder.jp/contests/joi2013yo/tasks/joi2013yo_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目に服 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> を着たときの <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi mathvariant=normal >∣</mi><msub><mi>C</mi><msub><mi>x</mi><mi>k</mi></msub></msub><mo>−</mo><msub><mi>C</mi><msub><mi>x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></msub><mi mathvariant=normal >∣</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \sum_{k=1}^{i-1} |C_{x_k} - C_{x_{k+1}}|</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3.1137820000000005em;vertical-align:-1.302113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8116690000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.302113em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >∣</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139199999999997em;"><span style="top:-2.55em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.25586em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.0475249999999998em;vertical-align:-0.29752499999999993em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139199999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.21074999999999994em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29752499999999993em;"><span></span></span></span></span></span></span><span class=mord >∣</span></span></span></span> の最大値</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目に服 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> を着たときの最大値は, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 日目に服 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1 \leq k \leq N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>&#41;を着たときからの遷移だから</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo>=</mo><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mrow><mo fence=true >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>k</mi><mo stretchy=false >]</mo><mo>+</mo><mi mathvariant=normal >∣</mi><mi>C</mi><mo stretchy=false >[</mo><mi>k</mi><mo stretchy=false >]</mo><mo>−</mo><mi>C</mi><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mi mathvariant=normal >∣</mi><mo fence=true >}</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[i][j] = \max_{k} \left\{ dp[i-1][k] + |C[k] - C[j]| \right\}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.502108em;vertical-align:-0.752108em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.43055999999999994em;"><span style="top:-2.347892em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >max</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.752108em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mord >∣</span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span> <p>ただし, 最高気温に適した服のみ選ぶ.</p> <p>答えは <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> 日目に着ていた服のうち, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>D</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi mathvariant=normal >∣</mi><msub><mi>C</mi><msub><mi>x</mi><mi>i</mi></msub></msub><mo>−</mo><msub><mi>C</mi><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></msub><mi mathvariant=normal >∣</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \sum_{i=1}^{D-1} |C_{x_i} - C_{x_{i+1}}|</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3.1060050000000006em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8283360000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >∣</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139199999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2501em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.041765em;vertical-align:-0.291765em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32808571428571426em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.20252142857142857em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.291765em;"><span></span></span></span></span></span></span><span class=mord >∣</span></span></span></span> が最大となるもの.</p> <pre><code class="cpp hljs">vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >dp</span>(D+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(N+<span class=hljs-number >1</span>, <span class=hljs-number >0</span>));
<span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,D+<span class=hljs-number >1</span>) {
    <span class=hljs-built_in >rep2</span>(j,<span class=hljs-number >1</span>,N+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep2</span>(k,<span class=hljs-number >1</span>,N+<span class=hljs-number >1</span>) {
            <span class=hljs-comment >// i 日目に j を, i-1 日目に k を着る</span>
            <span class=hljs-keyword >if</span> (A[j] &lt;= T[i] &amp;&amp; T[i] &lt;= B[j] &amp;&amp; A[k] &lt;= T[i<span class=hljs-number >-1</span>] &amp;&amp; T[i<span class=hljs-number >-1</span>] &lt;= B[k]) {
                <span class=hljs-built_in >chmax</span>(dp[i][j], dp[i<span class=hljs-number >-1</span>][k]+<span class=hljs-built_in >abs</span>(C[k]-C[j]));
            }
        }
    }
}

<span class=hljs-type >int</span> ans = <span class=hljs-number >0</span>;
<span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,N+<span class=hljs-number >1</span>) <span class=hljs-built_in >chmax</span>(ans, dp[D][i]);</code></pre> <p><a href="https://atcoder.jp/contests/joi2013yo/submissions/28234808">提出コード</a></p> <h3 id="joi_2015_予選_4_-_シルクロード"><a href="#joi_2015_予選_4_-_シルクロード" class=header-anchor >JOI 2015 予選 4 - シルクロード</a></h3> <p><a href="https://atcoder.jp/contests/joi2015yo/tasks/joi2015yo_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目に都市 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> にいるときの最小コスト</p> <p>0 日目に都市 0 にいるコストは 0, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mn>0</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mn>0</mn><mo stretchy=false >]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">dp[0][0] = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class=mord >0</span><span class=mclose >]</span><span class=mopen >[</span><span class=mord >0</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>.</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目に都市 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> にいるときのコストは, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i-k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 日目に都市 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> にいて, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目に都市 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> に移動してきた, または, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 日目には都市 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> にいて, そのまま動かなかった場合のいずれか. そのうちの最小コストが <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span> となる.</p> <ul> <li><p>移動してくる: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mo stretchy=false >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mi>k</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo>+</mo><mi>c</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo>×</mo><mi>d</mi><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \min_k \{dp[i-k][j-1] + c[i] \times d[j]\}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.5021079999999998em;vertical-align:-0.7521079999999999em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.347892em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.7521079999999999em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]}</span></span></span></span></p> <li><p>移動しない: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i-1][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span></p> </ul> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo>=</mo><mi>min</mi><mo>⁡</mo><mrow><mo fence=true >(</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo separator=true >,</mo><mtext> </mtext><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mo stretchy=false >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mi>k</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo>+</mo><mi>c</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo>×</mo><mi>d</mi><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo stretchy=false >}</mo><mo fence=true >)</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[i][j] = \min \left(dp[i-1][j],~ \min_k \{dp[i-k][j-1] + c[i] \times d[j]\} \right)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=mop >min</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mpunct >,</span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.347892em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.7521079999999999em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">c</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">d</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]}</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span> <p>答えは <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>m</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>n</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[m][n]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">m</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">n</span><span class=mclose >]</span></span></span></span>.</p> <pre><code class="cpp hljs">vector&lt;vector&lt;ll&gt;&gt; <span class=hljs-built_in >dp</span>(m+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;ll&gt;(n+<span class=hljs-number >1</span>, INF));

dp[<span class=hljs-number >0</span>][<span class=hljs-number >0</span>] = <span class=hljs-number >0</span>;
<span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,m+<span class=hljs-number >1</span>) {
    <span class=hljs-built_in >rep2</span>(j,<span class=hljs-number >1</span>,n+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep2</span>(k,<span class=hljs-number >1</span>,i+<span class=hljs-number >1</span>) {
            <span class=hljs-built_in >chmin</span>(dp[i][j], dp[i-k][j<span class=hljs-number >-1</span>] + c[i] * d[j]);
            <span class=hljs-built_in >chmin</span>(dp[i][j], dp[i<span class=hljs-number >-1</span>][j]);
        }
    }
}

cout &lt;&lt; dp[m][n] &lt;&lt; endl;</code></pre> <p><a href="https://atcoder.jp/contests/joi2015yo/submissions/28237554">提出コード</a></p> <h3 id="パ研杯2019_d_-_パ研軍旗"><a href="#パ研杯2019_d_-_パ研軍旗" class=header-anchor >パ研杯2019 D - パ研軍旗</a></h3> <p><a href="https://atcoder.jp/contests/pakencamp-2019-day3/tasks/pakencamp_2019_day3_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[j][x]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 列目の色を x で塗ったときの最小コスト</p> <p>2列連続で同じ色は使えないから, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[j][x]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span></span></span></span> は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 列目を色 y &#40;x &#33;&#61; y&#41; で塗ったときのコストと j 列目を x で塗るときのコストの和のうち最小となるもの.</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo>=</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>x</mi><mo mathvariant=normal >≠</mo><mi>y</mi></mrow></munder><mo stretchy=false >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo stretchy=false >]</mo><mo>+</mo><mo stretchy=false >(</mo><mtext># of not x at j th column</mtext><mo stretchy=false >)</mo><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[j][x] = \min_{x \neq y} \{ dp[j-1][y] + (\text{\# of not x at j th column}) \}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.638216em;vertical-align:-0.8882159999999999em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.3478920000000003em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class=fix ></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.8882159999999999em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord text"><span class=mord ># of not x at j th column</span></span><span class=mclose >)}</span></span></span></span> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-type >int</span> nrow = <span class=hljs-number >5</span>;
    vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >flag</span>(nrow, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(n+<span class=hljs-number >1</span>,<span class=hljs-number >0</span>));
    <span class=hljs-built_in >rep</span>(i,nrow) {
        <span class=hljs-built_in >rep</span>(j,n) {
            <span class=hljs-type >char</span> c;
            cin &gt;&gt; c;
            <span class=hljs-keyword >if</span> (c == <span class=hljs-string >&#x27;R&#x27;</span>) flag[i][j+<span class=hljs-number >1</span>] = <span class=hljs-number >0</span>;
            <span class=hljs-keyword >if</span> (c == <span class=hljs-string >&#x27;B&#x27;</span>) flag[i][j+<span class=hljs-number >1</span>] = <span class=hljs-number >1</span>;
            <span class=hljs-keyword >if</span> (c == <span class=hljs-string >&#x27;W&#x27;</span>) flag[i][j+<span class=hljs-number >1</span>] = <span class=hljs-number >2</span>;
            <span class=hljs-keyword >if</span> (c == <span class=hljs-string >&#x27;#&#x27;</span>) flag[i][j+<span class=hljs-number >1</span>] = <span class=hljs-number >3</span>;
        }
    }

    <span class=hljs-comment >// dp[j][x]: j-1 列目までの色は確定しており, j 列目を色 x で塗ったときの最小コスト</span>
    vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >dp</span>(n+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(<span class=hljs-number >3</span>, INF));
    <span class=hljs-built_in >rep</span>(x,<span class=hljs-number >3</span>) dp[<span class=hljs-number >0</span>][x] = <span class=hljs-number >0</span>;

    <span class=hljs-built_in >rep2</span>(j,<span class=hljs-number >1</span>,n+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep</span>(x,<span class=hljs-number >3</span>) {
            <span class=hljs-type >int</span> numnotx = <span class=hljs-number >0</span>;
            <span class=hljs-built_in >rep</span>(i,nrow) {
                numnotx += flag[i][j] != x;
            }

            <span class=hljs-built_in >rep</span>(y,<span class=hljs-number >3</span>) {
                <span class=hljs-keyword >if</span> (x == y) <span class=hljs-keyword >continue</span>;
                <span class=hljs-built_in >chmin</span>(dp[j][x], dp[j<span class=hljs-number >-1</span>][y] + numnotx);
            }
        }
    }

    <span class=hljs-type >int</span> ans = INF;
    <span class=hljs-built_in >rep</span>(x,<span class=hljs-number >3</span>) <span class=hljs-built_in >chmin</span>(ans, dp[n][x]);
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/pakencamp-2019-day3/submissions/28253637">提出コード</a></p> <h3 id="aoj_1167_-_ポロック予想"><a href="#aoj_1167_-_ポロック予想" class=header-anchor >AOJ 1167 - ポロック予想</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/1167">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[x]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span></span></span></span>: x を表すのに必要な正四面体数の個数の最小値</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo>=</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>i</mi></munder><mo stretchy=false >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>x</mi><mo>−</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=false >]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=false >]</mo><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[x] = \min_{i}\{ dp[x-s_i] + dp[s_i] \}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.4776639999999999em;vertical-align:-0.727664em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.372336em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.727664em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >]}</span></span></span></span> ここで <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目の正四面体数.</p> <p>x が小さいところから順に確定させていく</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-comment >// sq[i]: i 番目の正四面体数</span>
    vector&lt;<span class=hljs-type >int</span>&gt; sq;
    <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> n = <span class=hljs-number >1</span>; n*(n+<span class=hljs-number >1</span>)*(n+<span class=hljs-number >2</span>)/<span class=hljs-number >6</span> &lt;= (<span class=hljs-type >int</span>)<span class=hljs-number >1e6</span>; n++) {
        sq.<span class=hljs-built_in >push_back</span>(n*(n+<span class=hljs-number >1</span>)*(n+<span class=hljs-number >2</span>)/<span class=hljs-number >6</span>);
    }

    <span class=hljs-comment >// dp[x]: x を表すのに必要な正四面体数の個数の最小値</span>
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >dp</span><span class=hljs-params >((<span class=hljs-type >int</span>)<span class=hljs-number >1e6</span>+<span class=hljs-number >5</span>, INF)</span></span>;
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >odddp</span><span class=hljs-params >((<span class=hljs-type >int</span>)<span class=hljs-number >1e6</span>+<span class=hljs-number >5</span>, INF)</span></span>;
    <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> x : sq) {
        dp[x] = <span class=hljs-number >1</span>;
        <span class=hljs-keyword >if</span> (x&amp;<span class=hljs-number >1</span>) odddp[x] = <span class=hljs-number >1</span>;
    }

    <span class=hljs-built_in >rep</span>(x,(<span class=hljs-type >int</span>)<span class=hljs-number >1e6</span>+<span class=hljs-number >1</span>) {
        <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> s : sq) {
            <span class=hljs-keyword >if</span> (x - s &gt;= <span class=hljs-number >0</span>) {
                <span class=hljs-built_in >chmin</span>(dp[x], dp[x-s] + dp[s]);
                <span class=hljs-keyword >if</span> (s&amp;<span class=hljs-number >1</span>) <span class=hljs-built_in >chmin</span>(odddp[x], odddp[x-s] + odddp[s]);
            }
        }
    }

    <span class=hljs-keyword >while</span> (<span class=hljs-number >1</span>) {
        <span class=hljs-type >int</span> x;
        cin &gt;&gt; x;
        <span class=hljs-keyword >if</span> (x == <span class=hljs-number >0</span>) <span class=hljs-keyword >return</span>;
        cout &lt;&lt; dp[x] &lt;&lt; <span class=hljs-string >&quot; &quot;</span> &lt;&lt; odddp[x] &lt;&lt; endl;
    }
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/1167/judge/6165707/C&#43;&#43;17">提出コード</a></p> <h3 id="aoj_2199_-_差分パルス符号変調"><a href="#aoj_2199_-_差分パルス符号変調" class=header-anchor >AOJ 2199 - 差分パルス符号変調</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/2199">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][x]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y_i = x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> となるときの考えうる二乗和のうちの最小値</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>C</mi><mo stretchy=false >[</mo><mi>l</mi><mo stretchy=false >]</mo><mo>&gt;</mo><mn>255</mn></mrow><annotation encoding="application/x-tex">y_{i-1} + C[l] &gt; 255</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.791661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >255</span></span></span></span> のとき <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>255</mn></mrow><annotation encoding="application/x-tex">y_i = 255</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >255</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>C</mi><mo stretchy=false >[</mo><mi>l</mi><mo stretchy=false >]</mo><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y_{i-1} + C[l] &lt; 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.791661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> のとき <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y_i = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> になるので配る dp で書くと楽そう</p> <p>答えは <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mo stretchy=false >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>n</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>k</mi><mo stretchy=false >]</mo><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \min_k \{ dp[n][k] \}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.5021079999999998em;vertical-align:-0.7521079999999999em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.347892em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.7521079999999999em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">n</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]}</span></span></span></span>.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >(<span class=hljs-type >int</span> n, <span class=hljs-type >int</span> m)</span> </span>{
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >C</span><span class=hljs-params >(m+<span class=hljs-number >1</span>)</span>, <span class=hljs-title >x</span><span class=hljs-params >(n+<span class=hljs-number >1</span>)</span></span>;
    <span class=hljs-built_in >rep</span>(i,m) cin &gt;&gt; C[i+<span class=hljs-number >1</span>];
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; x[i+<span class=hljs-number >1</span>];

    <span class=hljs-comment >// dp[i][x]: y_i が x だったときの二乗和の最小値</span>
    vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >dp</span>(n+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(<span class=hljs-number >256</span>,INF));
    dp[<span class=hljs-number >0</span>][<span class=hljs-number >128</span>] = <span class=hljs-number >0</span>;

    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,n+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep</span>(k,<span class=hljs-number >256</span>) {
            <span class=hljs-built_in >rep2</span>(j,<span class=hljs-number >1</span>,m+<span class=hljs-number >1</span>) {
                <span class=hljs-type >int</span> s = k + C[j];
                <span class=hljs-keyword >if</span> (s &gt; <span class=hljs-number >255</span>) s = <span class=hljs-number >255</span>;
                <span class=hljs-keyword >if</span> (s &lt; <span class=hljs-number >0</span>) s = <span class=hljs-number >0</span>;
                <span class=hljs-built_in >chmin</span>(dp[i][s], dp[i<span class=hljs-number >-1</span>][k] + (s-x[i])*(s-x[i]));
            }
        }
    }

    <span class=hljs-type >int</span> ans = INF;
    <span class=hljs-built_in >rep</span>(i,<span class=hljs-number >256</span>) <span class=hljs-built_in >chmin</span>(ans, dp[n][i]);
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/2199/judge/6166950/C&#43;&#43;17">提出コード</a></p> <h2 id="動的計画法区間_dp"><a href="#動的計画法区間_dp" class=header-anchor >動的計画法：区間 DP</a></h2> <h3 id="alds10b_-_連鎖行列積"><a href="#alds10b_-_連鎖行列積" class=header-anchor >ALDS<em>10</em>B - 連鎖行列積</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/ALDS1_10_B">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(l,r)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span></span></span></span> を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>l</mi></msub><msub><mi>M</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>⋯</mo><msub><mi>M</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">M_l M_{l+1} \cdots M_r</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.891661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> のスカラー乗算の回数が最小値とする.</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>f</mi><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo><mo>=</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>k</mi><mo>∈</mo><mo stretchy=false >[</mo><mn>0</mn><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo><mo separator=true >,</mo><mi>k</mi><mo>∈</mo><mi mathvariant=double-struck >Z</mi></mrow></munder><mo stretchy=false >{</mo><mi>f</mi><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>k</mi><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo><mo>+</mo><mo stretchy=false >(</mo><mtext># of row of </mtext><msub><mi>M</mi><mi>l</mi></msub><mo stretchy=false >)</mo><mo>×</mo><mo stretchy=false >(</mo><mtext># of column of </mtext><msub><mi>M</mi><mi>k</mi></msub><mo stretchy=false >)</mo><mo>×</mo><mo stretchy=false >(</mo><mtext># of column of </mtext><msub><mi>M</mi><mi>r</mi></msub><mo stretchy=false >)</mo><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle f(l, r) = \min_{k \in [0, r), k \in \mathbb Z} \{ f(l,k) + f(k+1, r) + (\text{\# of row of } M_l) \times (\text{\# of column of } M_k) \times (\text{\# of column of } M_r) \}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.716em;vertical-align:-0.966em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.3089999999999997em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">∈</span><span class="mopen mtight">[</span><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mclose mtight">)</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">∈</span><span class="mord mathbb mtight">Z</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.966em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord text"><span class=mord ># of row of </span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord text"><span class=mord ># of column of </span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord text"><span class=mord ># of column of </span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)}</span></span></span></span> となる.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >dfs</span><span class=hljs-params >(<span class=hljs-type >int</span> l, <span class=hljs-type >int</span> r)</span> </span>{
    <span class=hljs-keyword >if</span> (l &lt; <span class=hljs-number >0</span> || r &gt;= n) <span class=hljs-keyword >return</span> INF;
    <span class=hljs-keyword >if</span> (visited[l][r]) <span class=hljs-keyword >return</span> dp[l][r];
    visited[l][r] = <span class=hljs-number >1</span>;

    <span class=hljs-built_in >rep2</span>(k,l,r) {
        <span class=hljs-built_in >chmin</span>(dp[l][r], <span class=hljs-built_in >dfs</span>(l,k) + <span class=hljs-built_in >dfs</span>(k+<span class=hljs-number >1</span>,r) + mats[l].first * mats[k].second * mats[r].second);
    }

    <span class=hljs-keyword >return</span> dp[l][r];
}


<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    cin &gt;&gt; n;
    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-type >int</span> a, b;
        cin &gt;&gt; a &gt;&gt; b;
        mats.<span class=hljs-built_in >push_back</span>({a,b});
    }

    <span class=hljs-comment >// dp[l][r]: [l, r] の範囲の連鎖行列のスカラー乗算回数の最小値</span>
    dp.<span class=hljs-built_in >resize</span>(n, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(n, INF));
    visited.<span class=hljs-built_in >resize</span>(n, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(n, <span class=hljs-number >0</span>));
    <span class=hljs-built_in >rep</span>(i,n) {
        dp[i][i] = <span class=hljs-number >0</span>;
        visited[i][i] = <span class=hljs-number >1</span>;
    }

    cout &lt;&lt; <span class=hljs-built_in >dfs</span>(<span class=hljs-number >0</span>, n<span class=hljs-number >-1</span>) &lt;&lt; endl;
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/ALDS1_10_B/judge/6167331/C&#43;&#43;17">提出コード</a></p> <h3 id="joi_2015_本選_2_-_ケーキの切り分け_2"><a href="#joi_2015_本選_2_-_ケーキの切り分け_2" class=header-anchor >JOI 2015 本選 2 - ケーキの切り分け 2</a></h3> <p><a href="https://atcoder.jp/contests/joi2015ho/tasks/joi2015ho_b">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo separator=true >,</mo><mi>f</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">calc(s, f)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mclose >)</span></span></span></span>: JOI の番が終わった状態で, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">A_s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">A_f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> が端として残っているときから操作をすることで JOI が獲得できるスコアの最大値とする. &#40;すでに食べられた部分のことは考えない&#41;</p> <p>次のターンで IOI は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">A_s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> と <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">A_f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> のうち大きい方を食べる.</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub><mo>&gt;</mo><msub><mi>A</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">A_s &gt; A_f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> のとき</p> </ul> <p>IOI が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">A_s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> を食べ, 次のターンに JOI は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">A_{s-1}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.891661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> または <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">A_f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> を食べる. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">A_{s-1}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.891661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> を食べたときの得点は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo>−</mo><mn>2</mn><mo separator=true >,</mo><mi>f</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">A_{s-1} + calc(s-2, f)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.891661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mclose >)</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">A_f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> を食べたときの得点は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>f</mi></msub><mo>+</mo><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo separator=true >,</mo><mi>f</mi><mo>+</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">A_f + calc(s-1, f+1)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span></span>. この2通りのうち大きいほうが <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo separator=true >,</mo><mi>f</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">calc(s, f)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mclose >)</span></span></span></span> となるので</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo separator=true >,</mo><mi>f</mi><mo stretchy=false >)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false >(</mo><msub><mi>A</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo>−</mo><mn>2</mn><mo separator=true >,</mo><mi>f</mi><mo stretchy=false >)</mo><mo separator=true >,</mo><msub><mi>A</mi><mi>f</mi></msub><mo>+</mo><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo separator=true >,</mo><mi>f</mi><mo>+</mo><mn>1</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">calc(s, f) = \max(A_{s-1} + calc(s-2, f), A_f + calc(s-1, f+1))</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >max</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mclose >)</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >))</span></span></span></span>.</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub><mo>&lt;</mo><msub><mi>A</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">A_s &lt; A_f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> のとき</p> </ul> <p>同様にして</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo separator=true >,</mo><mi>f</mi><mo stretchy=false >)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false >(</mo><msub><mi>A</mi><mi>s</mi></msub><mo>+</mo><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo separator=true >,</mo><mi>f</mi><mo>+</mo><mn>1</mn><mo stretchy=false >)</mo><mo separator=true >,</mo><msub><mi>A</mi><mrow><mi>f</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo separator=true >,</mo><mi>f</mi><mo>+</mo><mn>2</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">calc(s, f) = \max(A_s + calc(s-1, f+1), A_{f+1} + calc(s, f+2))</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >max</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >2</span><span class=mclose >))</span></span></span></span>.</p> <p>あとは JOI がピースのどの部分から食べるかを全探索することで答えを得られる.</p> <pre><code class="cpp hljs"><span class=hljs-type >int</span> n;
vector&lt;vector&lt;ll&gt;&gt; dp, visited;
vector&lt;ll&gt; A;

<span class=hljs-comment >// calc(s, f): JOI の番が終わった段階で A_s と A_f が端として残っているとき,</span>
<span class=hljs-comment >//             JOI が獲得できる最大のスコア</span>
<span class=hljs-comment >// s+1, ..., f-1 (mod n) の範囲がすでに食べられている</span>
<span class=hljs-function >ll <span class=hljs-title >calc</span><span class=hljs-params >(<span class=hljs-type >int</span> s, <span class=hljs-type >int</span> f)</span> </span>{
    <span class=hljs-keyword >if</span> (s == f) <span class=hljs-keyword >return</span> <span class=hljs-number >0</span>; <span class=hljs-comment >// 残りが1つのときは JOI に得点は入らない</span>
    <span class=hljs-keyword >if</span> (s == (f+<span class=hljs-number >1</span>)%n) <span class=hljs-keyword >return</span> <span class=hljs-built_in >min</span>(A[s], A[f]); <span class=hljs-comment >// 残り2つのとき小さいほうが JOI の得点</span>
    <span class=hljs-keyword >if</span> (visited[s][f]) <span class=hljs-keyword >return</span> dp[s][f];
    visited[s][f] = <span class=hljs-number >1</span>;

    <span class=hljs-comment >// JOI の番が終わった状態で A[s], A[f] が残っているとき, IOI は A[s] または A[f] の</span>
    <span class=hljs-comment >// 大きい方を食べる</span>
    <span class=hljs-keyword >if</span> (A[s] &gt; A[f]) {
        <span class=hljs-comment >// IOI が A[s] をたべる</span>
        <span class=hljs-comment >// IOI のあとに JOI は A[s-1] または A[f] を食べる.</span>
        <span class=hljs-keyword >return</span> dp[s][f] = <span class=hljs-built_in >max</span>(
            <span class=hljs-built_in >calc</span>((s<span class=hljs-number >-2</span>+n)%n, f) + A[(s<span class=hljs-number >-1</span>+n)%n], <span class=hljs-comment >// JOI が A[s-1] を食べる</span>
            <span class=hljs-built_in >calc</span>((s<span class=hljs-number >-1</span>+n)%n, (f+<span class=hljs-number >1</span>)%n) + A[f]    <span class=hljs-comment >// JOI が A[f] を食べる</span>
        );
    }
    <span class=hljs-keyword >return</span> dp[s][f] = <span class=hljs-built_in >max</span>(
        <span class=hljs-built_in >calc</span>((s<span class=hljs-number >-1</span>+n)%n, (f+<span class=hljs-number >1</span>)%n) + A[s], <span class=hljs-comment >// JOI が A[s] を食べる</span>
        <span class=hljs-built_in >calc</span>(s, (f+<span class=hljs-number >2</span>)%n) + A[(f+<span class=hljs-number >1</span>)%n]    <span class=hljs-comment >// JOI が A[f+1] を食べる</span>
    );
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    cin &gt;&gt; n;
    dp.<span class=hljs-built_in >resize</span>(n, <span class=hljs-built_in >vector</span>&lt;ll&gt;(n, <span class=hljs-number >0</span>));
    visited.<span class=hljs-built_in >resize</span>(n, <span class=hljs-built_in >vector</span>&lt;ll&gt;(n, <span class=hljs-number >0</span>));
    A.<span class=hljs-built_in >resize</span>(n);
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; A[i];

    ll ans = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-type >int</span> s = (i - <span class=hljs-number >1</span> + n) % n;
        <span class=hljs-type >int</span> f = (i + <span class=hljs-number >1</span>) % n;
        <span class=hljs-built_in >chmax</span>(ans, A[i] + <span class=hljs-built_in >calc</span>(s,f));
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/joi2015ho/submissions/28264730">提出コード</a></p> <h3 id="aoj_1611_ダルマ落とし"><a href="#aoj_1611_ダルマ落とし" class=header-anchor >AOJ 1611 ダルマ落とし</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/1611">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\mathrm{dfs}(l, r)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >]</span></span></span></span> の区間のブロックを落とせる最大値とする</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo>=</mo><mi>l</mi><mo>−</mo><mi>r</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mathrm{dfs}(l+1, r-1) = l-r-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> のとき</p> </ul> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[l+1, r-1]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span></span></span></span> の範囲のブロックをすべて落とせるということだから</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo><mo>=</mo><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo>+</mo><mo stretchy=false >(</mo><mi mathvariant=normal >∣</mi><msub><mi>w</mi><mi>l</mi></msub><mo>−</mo><msub><mi>w</mi><mi>r</mi></msub><mi mathvariant=normal >∣</mi><mo>≤</mo><mn>1</mn><mo stretchy=false >)</mo><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\mathrm{dfs}(l, r) = \mathrm{dfs}(l+1, r-1) + (|w_l - w_r| \leq 1) \times 2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >∣</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >∣</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span></span></span></span> <ul> <li><p>適当な <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>∈</mo><mo stretchy=false >[</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">k \in [l, r]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >]</span></span></span></span> で上下を分離して考えたとき</p> </ul> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo><mo>=</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>k</mi><mo>∈</mo><mo stretchy=false >[</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo></mrow></munder><mo stretchy=false >{</mo><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>k</mi><mo stretchy=false >)</mo><mo>+</mo><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \mathrm{dfs}(l, r) = \min_{k \in [l,r-1]} \{ \mathrm{dfs}(l, k) + \mathrm{dfs}(k+1, r) \}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.716em;vertical-align:-0.966em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.3089999999999997em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">∈</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.966em;"><span></span></span></span></span></span><span class=mopen >{</span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)}</span></span></span></span> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 番目のブロックが <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∣</mi><msub><mi>w</mi><mi>k</mi></msub><mo>−</mo><msub><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant=normal >∣</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|w_k - w_{k+1}| \leq 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >∣</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mord >∣</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> を満たしていてもそれをここで考慮する必要はない. なぜなら, そのようなケースの場合は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo>=</mo><mi>l</mi><mo>−</mo><mi>r</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mathrm{dfs}(l+1, r-1) = l-r-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> のときの条件ですでに考慮されているため.</p> <pre><code class="cpp hljs"><span class=hljs-type >int</span> n;
<span class=hljs-type >const</span> <span class=hljs-type >int</span> MAX = <span class=hljs-number >305</span>;
<span class=hljs-type >int</span> w[MAX], dp[MAX][MAX], visited[MAX][MAX];

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >init</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; w[i];
    <span class=hljs-built_in >rep</span>(i,MAX) <span class=hljs-built_in >rep</span>(j,MAX) dp[i][j] = visited[i][j] = <span class=hljs-number >0</span>;
}

<span class=hljs-comment >// dfs(l, r): [l, r] の範囲で落とせる最大の数</span>
<span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >dfs</span><span class=hljs-params >(<span class=hljs-type >int</span> l, <span class=hljs-type >int</span> r)</span> </span>{
    <span class=hljs-keyword >if</span> (l &gt;= r) <span class=hljs-keyword >return</span> <span class=hljs-number >0</span>;
    <span class=hljs-keyword >if</span> (visited[l][r]) <span class=hljs-keyword >return</span> dp[l][r];
    visited[l][r] = <span class=hljs-number >1</span>;

    <span class=hljs-keyword >if</span> (<span class=hljs-built_in >dfs</span>(l+<span class=hljs-number >1</span>, r<span class=hljs-number >-1</span>) == r-l<span class=hljs-number >-1</span>) {
        <span class=hljs-built_in >chmax</span>(dp[l][r], <span class=hljs-built_in >dfs</span>(l+<span class=hljs-number >1</span>, r<span class=hljs-number >-1</span>) + (<span class=hljs-built_in >abs</span>(w[l] - w[r]) &lt;= <span class=hljs-number >1</span>) * <span class=hljs-number >2</span>);
    }
    <span class=hljs-built_in >rep2</span>(k,l,r) {
        <span class=hljs-built_in >chmax</span>(dp[l][r], <span class=hljs-built_in >dfs</span>(l, k) + <span class=hljs-built_in >dfs</span>(k+<span class=hljs-number >1</span>, r));
    }

    <span class=hljs-keyword >return</span> dp[l][r];
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-built_in >init</span>();
    cout &lt;&lt; <span class=hljs-built_in >dfs</span>(<span class=hljs-number >0</span>, n<span class=hljs-number >-1</span>) &lt;&lt; endl;
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/1611/judge/6167977/C&#43;&#43;17">提出コード</a></p> <h2 id="動的計画法bit_dp"><a href="#動的計画法bit_dp" class=header-anchor >動的計画法：bit DP</a></h2> <h3 id="dpl2a_-_巡回セールスマン問題"><a href="#dpl2a_-_巡回セールスマン問題" class=header-anchor >DPL<em>2</em>A - 巡回セールスマン問題</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/DPL_2_A">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>S</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[S][x]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> をすでに訪れた node の集合, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> を最後に訪れた node としたときのコストの最小値 サイクルがあるならどこからスタートしても問題ないので node 0 から始めたとする. まだどこも訪れていない状態で node 0 にいるコストは 0 なので <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mrow></mrow><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mn>0</mn><mo stretchy=false >]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">dp[{}][0] = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class=mord ></span><span class=mclose >]</span><span class=mopen >[</span><span class=mord >0</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>. 答えはすべてを訪れた状態で最後に訪れたのが 0 のときだから <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>V</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mn>0</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[V][0]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class=mclose >]</span><span class=mopen >[</span><span class=mord >0</span><span class=mclose >]</span></span></span></span>.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >bool</span> <span class=hljs-title >hasBit</span><span class=hljs-params >(<span class=hljs-type >int</span> x, <span class=hljs-type >int</span> i)</span> </span>{
    <span class=hljs-keyword >return</span> (x&gt;&gt;i)&amp;<span class=hljs-number >1</span>;
}

<span class=hljs-keyword >struct</span> <span class="hljs-title class_">Edge</span> {
    <span class=hljs-type >int</span> from, weight;
};

<span class=hljs-type >int</span> v, e;
vector&lt;vector&lt;Edge&gt;&gt; graph;

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    cin &gt;&gt; v &gt;&gt; e;
    graph.<span class=hljs-built_in >resize</span>(v);
    <span class=hljs-built_in >rep</span>(i,e) {
        <span class=hljs-type >int</span> s, t, d;
        cin &gt;&gt; s &gt;&gt; t &gt;&gt; d;
        graph[t].<span class=hljs-built_in >push_back</span>({s, d});
    }

    <span class=hljs-comment >// dp[S][x]: S を訪れた集合, x を最後に訪れた node としたときのコストの最小値</span>
    <span class=hljs-comment >// サイクルがあるならどこからスタートでも問題ないので node 0 からスタートすると考える</span>
    vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >dp</span>(<span class=hljs-number >1</span>&lt;&lt;v, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(v, INF));
    dp[<span class=hljs-number >0</span>][<span class=hljs-number >0</span>] = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep</span>(S, <span class=hljs-number >1</span>&lt;&lt;v) {
        <span class=hljs-built_in >rep</span>(x,v) {
            <span class=hljs-keyword >if</span> (!<span class=hljs-built_in >hasBit</span>(S, x)) {
                <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> edge : graph[x]) {
                    <span class=hljs-type >int</span> from = edge.from;
                    <span class=hljs-type >int</span> weight = edge.weight;
                    <span class=hljs-built_in >chmin</span>(dp[S|(<span class=hljs-number >1</span>&lt;&lt;x)][x], dp[S][from] + weight);
                }
            }
        }
    }

    <span class=hljs-type >int</span> ans = dp[(<span class=hljs-number >1</span>&lt;&lt;v)<span class=hljs-number >-1</span>][<span class=hljs-number >0</span>];
    cout &lt;&lt; (ans == INF ? <span class=hljs-number >-1</span> : ans) &lt;&lt; endl;
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/DPL_2_A/judge/6168190/C&#43;&#43;17">提出コード</a></p> <h3 id=square869120contest_1_g_-_revenge_of_traveling_salesman_problem ><a href="#square869120contest_1_g_-_revenge_of_traveling_salesman_problem" class=header-anchor >Square869120Contest #1 G - Revenge of Traveling Salesman Problem</a></h3> <p><a href="https://atcoder.jp/contests/s8pc-1/tasks/s8pc_1_g">問題</a></p> <p>上記の巡回セールマン問題とほぼ同じだが, 遷移を考えるときに時間を見て, 所定の時間を超えていた場合は緩和処理を飛ばすようにする.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >bool</span> <span class=hljs-title >hasBit</span><span class=hljs-params >(<span class=hljs-type >int</span> x, <span class=hljs-type >int</span> i)</span> </span>{
    <span class=hljs-keyword >return</span> (x&gt;&gt;i)&amp;<span class=hljs-number >1</span>;
}

<span class=hljs-keyword >struct</span> <span class="hljs-title class_">Edge</span> {
    <span class=hljs-type >int</span> from;
    ll weight, time;
};

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n, m;
    cin &gt;&gt; n &gt;&gt; m;
    vector&lt;vector&lt;Edge&gt;&gt; <span class=hljs-built_in >graph</span>(n);
    <span class=hljs-built_in >rep</span>(i,m) {
        <span class=hljs-type >int</span> s, t;
        ll d, time;
        cin &gt;&gt; s &gt;&gt; t &gt;&gt; d &gt;&gt; time;
        s--, t--;
        graph[s].<span class=hljs-built_in >push_back</span>({t, d, time});
        graph[t].<span class=hljs-built_in >push_back</span>({s, d, time});
    }

    <span class=hljs-comment >// dp[S][x]: S 訪れた建物の集合, x 最後に訪れた建物としたときの最短時間とそれを達成する方法の総数</span>
    <span class=hljs-comment >// pair = (time, count)</span>
    vector&lt;vector&lt;pair&lt;ll,ll&gt;&gt;&gt; <span class=hljs-built_in >dp</span>(<span class=hljs-number >1</span>&lt;&lt;n, vector&lt;pair&lt;ll,ll&gt;&gt;(n, {INF, <span class=hljs-number >0</span>}));
    dp[<span class=hljs-number >0</span>][<span class=hljs-number >0</span>] = {<span class=hljs-number >0</span>, <span class=hljs-number >1</span>};
    <span class=hljs-built_in >rep</span>(S, <span class=hljs-number >1</span>&lt;&lt;n) {
        <span class=hljs-built_in >rep</span>(x,n) {
            <span class=hljs-keyword >if</span> (!<span class=hljs-built_in >hasBit</span>(S, x)) {
                <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> edge : graph[x]) {
                    <span class=hljs-type >int</span> from = edge.from;
                    ll weight = edge.weight;
                    ll time = edge.time;
                    ll cost = dp[S][from].first + weight;
                    <span class=hljs-keyword >if</span> (cost &gt; time) <span class=hljs-keyword >continue</span>;
                    <span class=hljs-keyword >if</span> (dp[S|(<span class=hljs-number >1</span>&lt;&lt;x)][x].first &gt; cost) {
                        dp[S|(<span class=hljs-number >1</span>&lt;&lt;x)][x] = {cost, dp[S][from].second};
                    } <span class=hljs-keyword >else</span> <span class=hljs-keyword >if</span> (dp[S|(<span class=hljs-number >1</span>&lt;&lt;x)][x].first == cost) {
                        dp[S|(<span class=hljs-number >1</span>&lt;&lt;x)][x].second += dp[S][from].second;
                    }
                }
            }
        }
    }

    ll ans_time = dp[(<span class=hljs-number >1</span>&lt;&lt;n)<span class=hljs-number >-1</span>][<span class=hljs-number >0</span>].first;
    ll ans_cnt = dp[(<span class=hljs-number >1</span>&lt;&lt;n)<span class=hljs-number >-1</span>][<span class=hljs-number >0</span>].second;
    <span class=hljs-keyword >if</span> (ans_time == INF) cout &lt;&lt; <span class=hljs-string >&quot;IMPOSSIBLE&quot;</span> &lt;&lt; endl;
    <span class=hljs-keyword >else</span> cout &lt;&lt; ans_time &lt;&lt; <span class=hljs-string >&quot; &quot;</span> &lt;&lt; ans_cnt &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/s8pc-1/submissions/28272213">提出コード</a></p> <h3 id="joi_2014_予選_4_-_部活のスケジュール表"><a href="#joi_2014_予選_4_-_部活のスケジュール表" class=header-anchor >JOI 2014 予選 4 - 部活のスケジュール表</a></h3> <p><a href="https://atcoder.jp/contests/joi2014yo/tasks/joi2014yo_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>S</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][S]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目に出席する人の集合が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> のなる場合の数とする. 最初鍵を持っている J は0日目に出席したと考えて <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mn>0</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mo stretchy=false >{</mo><mtext>J</mtext><mo stretchy=false >}</mo><mo stretchy=false >]</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">dp[0][\{\text{J}\}] = 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class=mord >0</span><span class=mclose >]</span><span class=mopen >[{</span><span class="mord text"><span class=mord >J</span></span><span class=mclose >}]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>.</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目には責任者と <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 日目に鍵を持ち帰った人が出席する必要があるから, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目の責任者を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目の出席者の集合を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> とすると <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><msub><mi>S</mi><mi>i</mi></msub><mo>∧</mo><msub><mi>S</mi><mi>i</mi></msub><mo>∩</mo><msub><mi>S</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo mathvariant=normal >≠</mo><mi mathvariant=normal >∅</mi></mrow><annotation encoding="application/x-tex">x \in S_i \wedge S_i \cap S_{i-1} \neq \empty</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∧</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∩</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.902771em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class="mord vbox"><span class=thinbox ><span class=rlap ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class=mord ><span class=mrel ></span></span></span><span class=fix ></span></span></span></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.80556em;vertical-align:-0.05556em;"></span><span class=mord >∅</span></span></span></span> が成り立つ. 鍵は出席者のうちの誰かが持ち帰ればいいので, 誰が持ち帰ったかということは気にする必要はない.</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.2500em  columnalign=right  columnspacing=""><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>S</mi><mo stretchy=false >]</mo><mo>=</mo><mrow><mo fence=true >{</mo><mtable rowspacing=0.2500em  columnalign="right left" columnspacing=0em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mn>0</mn><mtext> </mtext><mo stretchy=false >(</mo><mi>S</mi><mtext>に責任者が含まれない場合)</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><munder><mo>∑</mo><msup><mi>S</mi><mo mathvariant=normal >′</mo></msup></munder><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><msup><mi>S</mi><mo mathvariant=normal >′</mo></msup><mo stretchy=false >]</mo><mtext> </mtext><mo stretchy=false >(</mo><mi>S</mi><mo>∩</mo><msup><mi>S</mi><mo mathvariant=normal >′</mo></msup><mo mathvariant=normal >≠</mo><mi mathvariant=normal >∅</mi><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} dp[i][S] = \left\{ \begin{aligned} &amp; 0 ~~(S \text{に責任者が含まれない場合)} \\ &amp; \sum_{S^\prime} dp[i-1][S^\prime] ~~ (S \cap S^\prime \neq \empty) \end{aligned} \right. \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:4.500039999999999em;vertical-align:-2.0000199999999997em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.5000199999999997em;"><span style="top:-4.500019999999999em;"><span class=pstrut  style="height:4.35002em;"></span><span class=mord ><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=minner ><span class=mopen ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.3500199999999998em;"><span style="top:-2.19999em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.19199em;"><span class=pstrut  style="height:3.15em;"></span><span style="height:0.31599999999999984em;width:0.889em;"><svg width='0.889em' height='0.31599999999999984em' style='width:0.889em' viewBox='0 0 889 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-3.15001em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292009999999999em;"><span class=pstrut  style="height:3.15em;"></span><span style="height:0.31599999999999984em;width:0.889em;"><svg width='0.889em' height='0.31599999999999984em' style='width:0.889em' viewBox='0 0 889 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style="top:-4.600019999999999em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.8500199999999998em;"><span></span></span></span></span></span></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.3221705000000004em;"><span style="top:-4.532175500000001em;"><span class=pstrut  style="height:3.0500050000000005em;"></span><span class=mord ></span></span><span style="top:-2.8221705000000004em;"><span class=pstrut  style="height:3.0500050000000005em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.8221705000000004em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.3221705000000004em;"><span style="top:-4.532175500000001em;"><span class=pstrut  style="height:3.0500050000000005em;"></span><span class=mord ><span class=mord ></span><span class=mord >0</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord text"><span class="mord cjk_fallback">に責任者が含まれない場合</span><span class=mord >)</span></span></span></span><span style="top:-2.8221705000000004em;"><span class=pstrut  style="height:3.0500050000000005em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.294336em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mclose >]</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∩</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class="mord vbox"><span class=thinbox ><span class=rlap ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class=mord ><span class=mrel ></span></span></span><span class=fix ></span></span></span></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >∅</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.8221705000000004em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:2.0000199999999997em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>となる. 入力例1 と照らし合わせると二日目に J, O, I となるのは1日目が J, O 由来のものと, J, O, I 由来がある.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >bool</span> <span class=hljs-title >hasBit</span><span class=hljs-params >(<span class=hljs-type >int</span> x, <span class=hljs-type >int</span> n)</span> </span>{
    <span class=hljs-keyword >return</span> (x&gt;&gt;n)&amp;<span class=hljs-number >1</span>;
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    string s;
    cin &gt;&gt; s;
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >admin</span><span class=hljs-params >(n+<span class=hljs-number >1</span>)</span></span>;
    <span class=hljs-built_in >rep</span>(i,n) admin[i+<span class=hljs-number >1</span>] = (s[i] == <span class=hljs-string >&#x27;J&#x27;</span> ? <span class=hljs-number >0</span> : s[i] == <span class=hljs-string >&#x27;O&#x27;</span> ? <span class=hljs-number >1</span> : <span class=hljs-number >2</span>);

    <span class=hljs-type >const</span> <span class=hljs-type >int</span> mod = <span class=hljs-number >10007</span>;

    <span class=hljs-comment >// dp[i][S]: i 日目に出席する人の集合が S となる場合の数</span>
    vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >dp</span>(n+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(<span class=hljs-number >1</span>&lt;&lt;<span class=hljs-number >3</span>, <span class=hljs-number >0</span>));
    dp[<span class=hljs-number >0</span>][<span class=hljs-number >1</span>] = <span class=hljs-number >1</span>;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,n+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep</span>(S, <span class=hljs-number >1</span>&lt;&lt;<span class=hljs-number >3</span>) {
            <span class=hljs-built_in >rep</span>(Sp, <span class=hljs-number >1</span>&lt;&lt;<span class=hljs-number >3</span>) {
                <span class=hljs-keyword >if</span> (<span class=hljs-built_in >hasBit</span>(S, admin[i]) &amp;&amp; (S &amp; Sp) &gt; <span class=hljs-number >0</span>) {
                    dp[i][S] += dp[i<span class=hljs-number >-1</span>][Sp];
                    dp[i][S] %= mod;
                }
            }
        }
    }

    <span class=hljs-type >int</span> ans = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep</span>(S, <span class=hljs-number >1</span>&lt;&lt;<span class=hljs-number >3</span>) {
        ans += dp[n][S];
        ans %= mod;
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/joi2014yo/submissions/28287737">提出コード</a></p> <h3 id="joi_2017_予選_4_-_ぬいぐるみの整理"><a href="#joi_2017_予選_4_-_ぬいぐるみの整理" class=header-anchor >JOI 2017 予選 4 - ぬいぐるみの整理</a></h3> <p><a href="https://atcoder.jp/contests/joi2017yo/tasks/joi2017yo_d">問題</a></p> <p>愚直にぬいぐるみの並び順を考えると <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo stretchy=false >!</mo></mrow><annotation encoding="application/x-tex">M!</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mclose >!</span></span></span></span> 通りあるので <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>M</mi><mo>≤</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">1 \leq M \leq 20</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >20</span></span></span></span> の制約では全探索は現実的ではない. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> の制約が小さいので順列全探索を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy=false >(</mo><mi>M</mi><msup><mn>2</mn><mi>M</mi></msup><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">O(M 2^M)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> の DP で解く問題なのだろうという推測がつく. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>20</mn></msup><mo>=</mo><mn>1048576</mn></mrow><annotation encoding="application/x-tex">2^{20} = 1048576</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">20</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1048576</span></span></span></span> なのでこれならば実行時間制限に十分間に合う.</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>S</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[S]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=mclose >]</span></span></span></span> をすでに並べたぬいぐるみの集合を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> としたときの最小コストとする. すでに並べたぬいぐるみが決まっているとき, それまででどこにどのぬいぐるみを置いたかを考慮する必要はない. よって <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>S</mi><mo stretchy=false >]</mo><mo>=</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mo stretchy=false >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>S</mi><mi mathvariant=normal >\</mi><mo stretchy=false >{</mo><mi>k</mi><mo stretchy=false >}</mo><mo stretchy=false >]</mo><mo>+</mo><mo stretchy=false >(</mo><mi>k</mi><mtext>を置くためにどかす必要のあるぬいぐるみの数)</mtext><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[S] = \min_{k} \{ dp[S \backslash \{k\}] + (k \text{を置くためにどかす必要のあるぬいぐるみの数)} \}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.5021079999999998em;vertical-align:-0.7521079999999999em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.347892em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.7521079999999999em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class=mord >\</span><span class=mopen >{</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >}]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord text"><span class="mord cjk_fallback">を置くためにどかす必要のあるぬいぐるみの数</span><span class=mord >)</span></span><span class=mclose >}</span></span></span></span></p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n, m;
    cin &gt;&gt; n &gt;&gt; m;
    <span class=hljs-comment >// numfig[i][j]: ぬいぐるみ i が j 列目までに何個含まれているか</span>
    vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >numfig</span>(m, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(n+<span class=hljs-number >1</span>, <span class=hljs-number >0</span>));
    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-type >int</span> c;
        cin &gt;&gt; c;
        c--;
        numfig[c][i+<span class=hljs-number >1</span>]++;
    }
    <span class=hljs-built_in >rep</span>(i,m) <span class=hljs-built_in >rep</span>(j,n) numfig[i][j+<span class=hljs-number >1</span>] += numfig[i][j];

    <span class=hljs-comment >// dp[S]: すでに並べたぬいぐるみの集合を S としたときの最小コスト</span>
    <span class=hljs-comment >// 0 種類のぬいぐるみを置くとき, 入れ替えが必要な種類は 0.</span>
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >dp</span><span class=hljs-params >(<span class=hljs-number >1</span>&lt;&lt;m, INF)</span></span>;
    dp[<span class=hljs-number >0</span>] = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep2</span>(S, <span class=hljs-number >1</span>,<span class=hljs-number >1</span>&lt;&lt;m) {
        <span class=hljs-type >int</span> num_occupied = <span class=hljs-number >0</span>; <span class=hljs-comment >// S のぬいぐるみが置かれているとき, すでに何個決まっているか</span>
        <span class=hljs-built_in >rep</span>(j,m) <span class=hljs-keyword >if</span> (S &amp; (<span class=hljs-number >1</span>&lt;&lt;j)) num_occupied += numfig[j][n];
        <span class=hljs-built_in >rep</span>(i,m) {
            <span class=hljs-keyword >if</span> (!<span class=hljs-built_in >hasBit</span>(S, i)) <span class=hljs-keyword >continue</span>;
            <span class=hljs-type >int</span> numi = numfig[i][n]; <span class=hljs-comment >// ぬいぐるみ i が全部で何個あるか</span>
            <span class=hljs-type >int</span> must_remove = numi - (numfig[i][num_occupied] - numfig[i][num_occupied - numi]);
            <span class=hljs-built_in >chmin</span>(dp[S], dp[S^(<span class=hljs-number >1</span>&lt;&lt;i)]+must_remove);
        }
    }
    cout &lt;&lt; dp[(<span class=hljs-number >1</span>&lt;&lt;m)<span class=hljs-number >-1</span>] &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/joi2017yo/submissions/28292131">提出コード</a></p> <h2 id="動的計画法その他"><a href="#動的計画法その他" class=header-anchor >動的計画法：その他</a></h2> <h3 id="dpl1d_-_最長増加部分列_lis_longest_increasing_subsequence"><a href="#dpl1d_-_最長増加部分列_lis_longest_increasing_subsequence" class=header-anchor >DPL<em>1</em>D - 最長増加部分列 &#40;LIS, Longest Increasing Subsequence&#41;</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/DPL_1_D">問題</a></p> <p>参考記事: <a href="https://qiita.com/python_walker/items/d1e2be789f6e7a0851e5">最長増加部分列&#40;LIS&#41;の長さを求める</a></p> <p>無駄な更新をしないようにすると <code>upper_bound</code> 使って以下のような感じになる.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >a</span><span class=hljs-params >(n)</span>, <span class=hljs-title >lis</span><span class=hljs-params >(n, INF)</span></span>;
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; a[i];

    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-keyword >auto</span> it = <span class=hljs-built_in >upper_bound</span>(<span class=hljs-built_in >all</span>(lis), a[i]);
        <span class=hljs-keyword >if</span> (it == lis.<span class=hljs-built_in >begin</span>()) {
            *it = a[i];
        } <span class=hljs-keyword >else</span> <span class=hljs-keyword >if</span> (*(it<span class=hljs-number >-1</span>) &lt; a[i]) {
            *it = a[i];
        }
    }

    <span class=hljs-keyword >auto</span> it = <span class=hljs-built_in >lower_bound</span>(<span class=hljs-built_in >all</span>(lis), INF);
    cout &lt;&lt; it - lis.<span class=hljs-built_in >begin</span>() &lt;&lt; endl;
}</code></pre> <p>同じところを同じ数字に置き換えても問題ないので, <code>lower_bound</code> を使うほうがよりシンプルに書ける.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >a</span><span class=hljs-params >(n)</span>, <span class=hljs-title >lis</span><span class=hljs-params >(n, INF)</span></span>;
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; a[i];

    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-keyword >auto</span> it = <span class=hljs-built_in >lower_bound</span>(<span class=hljs-built_in >all</span>(lis), a[i]);
        *it = a[i];
    }

    <span class=hljs-keyword >auto</span> it = <span class=hljs-built_in >lower_bound</span>(<span class=hljs-built_in >all</span>(lis), INF);
    cout &lt;&lt; it - lis.<span class=hljs-built_in >begin</span>() &lt;&lt; endl;
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/DPL_1_D/judge/6170671/C&#43;&#43;17">提出コード</a></p> <h3 id="atcoder_beginner_contest_006_d_-_トランプ挿入ソート"><a href="#atcoder_beginner_contest_006_d_-_トランプ挿入ソート" class=header-anchor >AtCoder Beginner Contest 006 D - トランプ挿入ソート</a></h3> <p><a href="https://atcoder.jp/contests/abc006/tasks/abc006_4">問題</a></p> <p>LIS 分はトランプを動かす必要ないが, それ以外はソートのために動かさないといけないので <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>−</mo><mi>L</mi><mi>I</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">N - LIS</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> が答え.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >c</span><span class=hljs-params >(n)</span>, <span class=hljs-title >lis</span><span class=hljs-params >(n, INF)</span></span>;
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; c[i];

    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-keyword >auto</span> it = <span class=hljs-built_in >lower_bound</span>(<span class=hljs-built_in >all</span>(lis), c[i]);
        *it = c[i];
    }

    cout &lt;&lt; n - (<span class=hljs-built_in >lower_bound</span>(<span class=hljs-built_in >all</span>(lis), INF) - lis.<span class=hljs-built_in >begin</span>()) &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/abc006/submissions/28292614">提出コード</a></p> <h3 id=atcoder_beginner_contest_134_e_-_sequence_decomposing ><a href="#atcoder_beginner_contest_134_e_-_sequence_decomposing" class=header-anchor >AtCoder Beginner Contest 134 E - Sequence Decomposing</a></h3> <p><a href="https://atcoder.jp/contests/abc134/tasks/abc134_e">問題</a></p> <p>けんちょん さんの<a href="https://drken1215.hatenablog.com/entry/2020/12/25/184700">解説記事</a>がとてもわかり易かった.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >A</span><span class=hljs-params >(n)</span>, <span class=hljs-title >B</span><span class=hljs-params >(n)</span></span>;
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; A[i];
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >lis</span><span class=hljs-params >(n, INF)</span></span>;
    <span class=hljs-built_in >reverse</span>(<span class=hljs-built_in >all</span>(A));

    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-keyword >auto</span> it = <span class=hljs-built_in >upper_bound</span>(<span class=hljs-built_in >all</span>(lis), A[i]);
        *it = A[i];
    }

    cout &lt;&lt; <span class=hljs-built_in >lower_bound</span>(<span class=hljs-built_in >all</span>(lis), INF) - lis.<span class=hljs-built_in >begin</span>() &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/abc134/submissions/28293382">提出コード</a></p> <h2 id="最短経路問題ダイクストラ法"><a href="#最短経路問題ダイクストラ法" class=header-anchor >最短経路問題：ダイクストラ法</a></h2> <h3 id="grl1a_-_単一始点最短経路"><a href="#grl1a_-_単一始点最短経路" class=header-anchor >GRL<em>1</em>A - 単一始点最短経路</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/GRL_1_A">問題</a></p> <p>素直にダイクストラを実装する</p> <pre><code class="cpp hljs"><span class=hljs-keyword >struct</span> <span class="hljs-title class_">Edge</span> {
    <span class=hljs-type >int</span> to, cost;
};

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n, m, r;
    cin &gt;&gt; n &gt;&gt; m &gt;&gt; r;
    vector&lt;vector&lt;Edge&gt;&gt; <span class=hljs-built_in >graph</span>(n);
    <span class=hljs-built_in >rep</span>(i,m) {
        <span class=hljs-type >int</span> s, t, cost;
        cin &gt;&gt; s &gt;&gt; t &gt;&gt; cost;
        graph[s].<span class=hljs-built_in >push_back</span>({t, cost});
    }

    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >dist</span><span class=hljs-params >(n, INF)</span></span>;
    dist[r] = <span class=hljs-number >0</span>;

    priority_queue&lt;P, vector&lt;P&gt;, greater&lt;P&gt;&gt; pq;
    pq.<span class=hljs-built_in >push</span>({<span class=hljs-number >0</span>, r});
    <span class=hljs-keyword >while</span> (!pq.<span class=hljs-built_in >empty</span>()) {
        <span class=hljs-type >int</span> cost, node;
        <span class=hljs-built_in >tie</span>(cost, node) = pq.<span class=hljs-built_in >top</span>();
        pq.<span class=hljs-built_in >pop</span>();

        <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> e : graph[node]) {
            <span class=hljs-keyword >if</span> (dist[e.to] &gt; dist[node] + e.cost) {
                pq.<span class=hljs-built_in >push</span>({dist[node]+e.cost, e.to});
                dist[e.to] = dist[node] + e.cost;
            }
        }
    }

    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-keyword >if</span> (dist[i] == INF) cout &lt;&lt; <span class=hljs-string >&quot;INF&quot;</span> &lt;&lt; endl;
        <span class=hljs-keyword >else</span> cout &lt;&lt; dist[i] &lt;&lt; endl;
    }
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/GRL_1_A/judge/6171021/C&#43;&#43;17">提出コード</a></p> <h3 id="joi_2008_予選_6_-_船旅"><a href="#joi_2008_予選_6_-_船旅" class=header-anchor >JOI 2008 予選 6 - 船旅</a></h3> <p><a href="https://atcoder.jp/contests/joi2008yo/tasks/joi2008yo_f">問題</a></p> <p>注文表のときは最短距離を計算して, 新たな航路ができたときはグラフを更新する.</p> <p><a href="https://atcoder.jp/contests/joi2008yo/submissions/28295773">提出コード</a></p> <h3 id="joi_2016_予選_5_-_ゾンビ島"><a href="#joi_2016_予選_5_-_ゾンビ島" class=header-anchor >JOI 2016 予選 5 - ゾンビ島</a></h3> <p><a href="https://atcoder.jp/contests/joi2016yo/tasks/joi2016yo_e">問題</a></p> <p>公式解説のように危険な町の探索の仕方を工夫する.</p> <pre><code class="cpp hljs"><span class=hljs-keyword >using</span> Graph = vector&lt;vector&lt;Edge&gt;&gt;;

<span class=hljs-comment >// 危険な町か否かの情報を持つ vector を返す</span>
<span class=hljs-comment >// 0 -&gt; 安全</span>
<span class=hljs-comment >// 1 -&gt; 危険</span>
<span class=hljs-comment >// -1 -&gt; ゾンビがいる町 を表す</span>
<span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >danger_zone</span><span class=hljs-params >(Graph graph, vector&lt;<span class=hljs-type >int</span>&gt; &amp;zonbi, <span class=hljs-type >int</span> s)</span> </span>{
    <span class=hljs-comment >// ゾンビがいる町と直接つながる仮想的な町を追加する.</span>
    <span class=hljs-comment >// その町から距離 s+1 以内にある町が危険な町</span>
    graph.<span class=hljs-built_in >push_back</span>(<span class=hljs-built_in >vector</span>&lt;Edge&gt;());
    <span class=hljs-type >int</span> n = graph.<span class=hljs-built_in >size</span>();
    <span class=hljs-type >int</span> k = zonbi.<span class=hljs-built_in >size</span>();
    <span class=hljs-built_in >rep</span>(i,k) graph[n<span class=hljs-number >-1</span>].<span class=hljs-built_in >push_back</span>({zonbi[i], <span class=hljs-number >0</span>});

    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >isdanger</span><span class=hljs-params >(n, <span class=hljs-number >0</span>)</span></span>;

    <span class=hljs-comment >// P: island id, distance</span>
    queue&lt;P&gt; que;
    que.<span class=hljs-built_in >push</span>({n<span class=hljs-number >-1</span>, <span class=hljs-number >-1</span>}); <span class=hljs-comment >// ゾンビがいる町にいるときにコスト 0 になるように距離を -1 にしておく.</span>
    <span class=hljs-keyword >while</span> (!que.<span class=hljs-built_in >empty</span>()) {
        <span class=hljs-keyword >auto</span> p = que.<span class=hljs-built_in >front</span>();
        <span class=hljs-type >int</span> id = p.first;
        <span class=hljs-type >int</span> dis = p.second;
        que.<span class=hljs-built_in >pop</span>();

        isdanger[id] = <span class=hljs-number >1</span>;
        <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> e : graph[id]) {
            <span class=hljs-keyword >if</span> (isdanger[e.to]) <span class=hljs-keyword >continue</span>;
            <span class=hljs-keyword >if</span> (dis+<span class=hljs-number >1</span> &lt;= s) {
                que.<span class=hljs-built_in >push</span>({e.to, dis+<span class=hljs-number >1</span>});
            }
        }
    }

    <span class=hljs-built_in >rep</span>(i,k) isdanger[zonbi[i]] = <span class=hljs-number >-1</span>;

    <span class=hljs-keyword >return</span> isdanger;
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n, m, k, s;
    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k &gt;&gt; s;
    ll p, q;
    cin &gt;&gt; p &gt;&gt; q;

    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >C</span><span class=hljs-params >(k)</span></span>;
    <span class=hljs-built_in >rep</span>(i,k) cin &gt;&gt; C[i], C[i]--;

    <span class=hljs-function >Graph <span class=hljs-title >graph</span><span class=hljs-params >(n)</span></span>;
    <span class=hljs-built_in >rep</span>(i,m) {
        <span class=hljs-type >int</span> a, b;
        cin &gt;&gt; a &gt;&gt; b;
        a--, b--;
        graph[a].<span class=hljs-built_in >push_back</span>({b, INF});
        graph[b].<span class=hljs-built_in >push_back</span>({a, INF});
    }

    vector&lt;<span class=hljs-type >int</span>&gt; is_danger = <span class=hljs-built_in >danger_zone</span>(graph, C, s);
    <span class=hljs-comment >// 危険な町の情報をもとに移動コストをつけ直す</span>
    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> &amp;e : graph[i]) {
            <span class=hljs-keyword >if</span> (e.to == n<span class=hljs-number >-1</span>) e.cost = <span class=hljs-number >0</span>; <span class=hljs-comment >// 町 n-1 では宿泊しないのでコスト 0</span>
            <span class=hljs-keyword >else</span> <span class=hljs-keyword >if</span> (is_danger[e.to] == <span class=hljs-number >-1</span>) e.cost = INF;
            <span class=hljs-keyword >else</span> <span class=hljs-keyword >if</span> (is_danger[e.to] == <span class=hljs-number >1</span>) e.cost = q;
            <span class=hljs-keyword >else</span> e.cost = p;
        }
    }

    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >dist</span><span class=hljs-params >(n, INF)</span></span>;
    dist[<span class=hljs-number >0</span>] = <span class=hljs-number >0</span>;

    <span class=hljs-comment >// P: cost, node id</span>
    priority_queue&lt;P, vector&lt;P&gt;, greater&lt;P&gt;&gt; pq;
    pq.<span class=hljs-built_in >push</span>({<span class=hljs-number >0</span>, <span class=hljs-number >0</span>});
    <span class=hljs-keyword >while</span> (!pq.<span class=hljs-built_in >empty</span>()) {
        <span class=hljs-keyword >auto</span> node = pq.<span class=hljs-built_in >top</span>();
        <span class=hljs-type >int</span> id = node.second;
        pq.<span class=hljs-built_in >pop</span>();
        <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> e : graph[id]) {
            <span class=hljs-keyword >if</span> (dist[e.to] &gt; dist[id] + e.cost) {
                dist[e.to] = dist[id] + e.cost;
                pq.<span class=hljs-built_in >push</span>({dist[e.to], e.to});
            }
        }
    }

    cout &lt;&lt; dist[n<span class=hljs-number >-1</span>] &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/joi2016yo/submissions/28297302">提出コード</a></p> <h3 id="joi_2014_予選_5_-_タクシー"><a href="#joi_2014_予選_5_-_タクシー" class=header-anchor >JOI 2014 予選 5 - タクシー</a></h3> <p><a href="https://atcoder.jp/contests/joi2014yo/tasks/joi2014yo_e">問題</a></p> <p>町 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> とタクシー <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> で到達できる町を直接つなぐグラフを作り, そのグラフに対して最短経路問題を解く. 辺の数がすごいことになりそうだが大丈夫らしい. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> が最大でも 10000 というところが結構効いているっぽい. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>5000</mn></mrow><annotation encoding="application/x-tex">N = 5000</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >5000</span></span></span></span> のときの完全グラフの辺の数は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mfrac><mrow><mn>5000</mn><mo>×</mo><mn>4999</mn></mrow><mn>2</mn></mfrac><mo>=</mo><mn>12497500</mn></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \frac{5000 \times 4999}{2} = 12497500</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >5000</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >4999</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >12497500</span></span></span></span> なので, それと比べると確かに辺の数が少ないスカスカなグラフということがわかる.</p> <pre><code class="cpp hljs"><span class=hljs-keyword >struct</span> <span class="hljs-title class_">Edge</span> {
    <span class=hljs-type >int</span> to;
    ll cost;
};

<span class=hljs-keyword >using</span> Root = vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt;;
<span class=hljs-keyword >using</span> Graph = vector&lt;vector&lt;Edge&gt;&gt;;

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n, k;
    cin &gt;&gt; n &gt;&gt; k;
    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >cost</span><span class=hljs-params >(n)</span>, <span class=hljs-title >R</span><span class=hljs-params >(n)</span></span>;
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; cost[i] &gt;&gt; R[i];

    <span class=hljs-function >Root <span class=hljs-title >root</span><span class=hljs-params >(n)</span></span>; <span class=hljs-comment >// 道のつながりを表す</span>
    <span class=hljs-built_in >rep</span>(i,k) {
        <span class=hljs-type >int</span> a, b;
        cin &gt;&gt; a &gt;&gt; b;
        a--, b--;
        root[a].<span class=hljs-built_in >push_back</span>(b);
        root[b].<span class=hljs-built_in >push_back</span>(a);
    }

    <span class=hljs-comment >// taxi で同じ値段で行けるところを直接つなぐグラフを構築する</span>
    <span class=hljs-function >Graph <span class=hljs-title >graph</span><span class=hljs-params >(n)</span></span>;
    <span class=hljs-comment >// P: id, dist</span>
    queue&lt;P&gt; que;
    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-comment >// taxi i を使って到達できる町を調べる</span>
        <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >visited</span><span class=hljs-params >(n, <span class=hljs-number >0</span>)</span></span>;
        que.<span class=hljs-built_in >push</span>({i,<span class=hljs-number >0</span>});
        visited[i] = <span class=hljs-number >1</span>;
        <span class=hljs-keyword >while</span> (!que.<span class=hljs-built_in >empty</span>()) {
            <span class=hljs-keyword >auto</span> q = que.<span class=hljs-built_in >front</span>();
            que.<span class=hljs-built_in >pop</span>();
            visited[q.first] = <span class=hljs-number >1</span>;
            <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> to : root[q.first]) {
                <span class=hljs-keyword >if</span> (visited[to]) <span class=hljs-keyword >continue</span>;
                <span class=hljs-type >int</span> next_step = q.second + <span class=hljs-number >1</span>;
                <span class=hljs-keyword >if</span> (next_step &lt;= R[i]) {
                    que.<span class=hljs-built_in >push</span>({to, next_step});
                }
            }
        }

        <span class=hljs-comment >// 町 i と taxi i からいける町を直接つなぐ graph をつくる</span>
        <span class=hljs-built_in >rep</span>(k,n) <span class=hljs-keyword >if</span> (i != k &amp;&amp; visited[k]) graph[i].<span class=hljs-built_in >push_back</span>({k, cost[i]});
    }

    <span class=hljs-comment >// dijkstra</span>
    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >dist</span><span class=hljs-params >(n, INF)</span></span>;
    dist[<span class=hljs-number >0</span>] = <span class=hljs-number >0</span>;
    <span class=hljs-comment >// P: cost, node id</span>
    priority_queue&lt;P, vector&lt;P&gt;, greater&lt;P&gt;&gt; pq;
    pq.<span class=hljs-built_in >push</span>({<span class=hljs-number >0</span>, <span class=hljs-number >0</span>});
    <span class=hljs-keyword >while</span> (!pq.<span class=hljs-built_in >empty</span>()) {
        <span class=hljs-keyword >auto</span> node = pq.<span class=hljs-built_in >top</span>();
        pq.<span class=hljs-built_in >pop</span>();

        <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> e : graph[node.second]) {
            <span class=hljs-keyword >if</span> (dist[e.to] &gt; dist[node.second] + e.cost) {
                dist[e.to] = dist[node.second] + e.cost;
                pq.<span class=hljs-built_in >push</span>({dist[e.to], e.to});
            }
        }
    }

    cout &lt;&lt; dist[n<span class=hljs-number >-1</span>] &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/joi2014yo/submissions/28298613">提出コード</a></p> <h2 id="最短経路問題ワーシャルフロイド法"><a href="#最短経路問題ワーシャルフロイド法" class=header-anchor >最短経路問題：ワーシャルフロイド法</a></h2> <h3 id="grl1c_-_全点対間最短経路"><a href="#grl1c_-_全点対間最短経路" class=header-anchor >GRL<em>1</em>C - 全点対間最短経路</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/GRL_1_C">問題</a> <a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/GRL_1_C/judge/6171465/C&#43;&#43;17">提出コード</a></p> <h3 id="atcoder_beginner_contest_012_d_-_バスと避けられない運命"><a href="#atcoder_beginner_contest_012_d_-_バスと避けられない運命" class=header-anchor >AtCoder Beginner Contest 012 D - バスと避けられない運命</a></h3> <p><a href="https://atcoder.jp/contests/abc012/tasks/abc012_4">問題</a> <a href="https://atcoder.jp/contests/abc012/submissions/28299292">提出コード</a></p> <h3 id=atcoder_beginner_contest_079_d_-_wall ><a href="#atcoder_beginner_contest_079_d_-_wall" class=header-anchor >AtCoder Beginner Contest 079 D - Wall</a></h3> <p><a href="https://atcoder.jp/contests/abc079/tasks/abc079_d">問題</a> <a href="https://atcoder.jp/contests/abc079/submissions/28299377">提出コード</a></p> <h3 id=atcoder_beginner_contest_074_d_-_restoring_road_network ><a href="#atcoder_beginner_contest_074_d_-_restoring_road_network" class=header-anchor >AtCoder Beginner Contest 074 D - Restoring Road Network</a></h3> <p><a href="https://atcoder.jp/contests/abc074/tasks/arc083_b">問題</a></p> <p>与えられた隣接行列に対してワーシャルフロイドをして, 距離が変われば元々の隣接行列の値は最短距離を表していなかったということなのでそのような経路は存在しない.</p> <p>経路が存在していた場合, どこかを経由した場合と, 直接行く場合の距離が同じ場合, すなわち <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=false >(</mo><mi>i</mi><mo separator=true >,</mo><mi>j</mi><mo stretchy=false >)</mo><mo>=</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=false >(</mo><mi>i</mi><mo separator=true >,</mo><mi>k</mi><mo stretchy=false >)</mo><mo>+</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >,</mo><mi>j</mi><mo stretchy=false >)</mo><mtext> </mtext><mo stretchy=false >(</mo><mi>i</mi><mo mathvariant=normal >≠</mo><mi>k</mi><mo>∧</mo><mi>k</mi><mo mathvariant=normal >≠</mo><mi>j</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">dist(i, j) = dist(i, k) + dist(k, j)~~ (i \neq k \wedge k \neq j)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >)</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class="mord vbox"><span class=thinbox ><span class=rlap ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class=mord ><span class=mrel ></span></span></span><span class=fix ></span></span></span></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∧</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class="mord vbox"><span class=thinbox ><span class=rlap ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class=mord ><span class=mrel ></span></span></span><span class=fix ></span></span></span></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >)</span></span></span></span> のとき 直接の経路はなくても最短距離に影響を及ぼさないので消しても問題ない.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-function >Graph <span class=hljs-title >A</span><span class=hljs-params >(n, vector&lt;ll&gt;(n, <span class=hljs-number >0</span>))</span></span>;
    <span class=hljs-built_in >rep</span>(i,n) <span class=hljs-built_in >rep</span>(j,n) cin &gt;&gt; A[i][j];

    <span class=hljs-comment >// Floyd–Warshall</span>
    <span class=hljs-comment >// 最短距離を求めて, 元の matrix と異なった場合は, 元々の隣接行列は最短距離ではなかったということ</span>
    Graph B = A;
    <span class=hljs-built_in >rep</span>(k,n) <span class=hljs-built_in >rep</span>(i,n) <span class=hljs-built_in >rep</span>(j,n) <span class=hljs-built_in >chmin</span>(A[i][j], A[i][k] + A[k][j]);
    <span class=hljs-built_in >rep</span>(i,n) <span class=hljs-built_in >rep</span>(j,n) {
        <span class=hljs-keyword >if</span> (A[i][j] != B[i][j]) {
            cout &lt;&lt; <span class=hljs-number >-1</span> &lt;&lt; endl;
            <span class=hljs-keyword >return</span>;
        }
    }

    <span class=hljs-comment >// 直接つないでいる距離が他を経由しても同じ場合は, 直接の経路はなくしても</span>
    <span class=hljs-comment >// 全体の最短距離には影響を与えない</span>
    <span class=hljs-function >Graph <span class=hljs-title >removable</span><span class=hljs-params >(n, vector&lt;ll&gt;(n, <span class=hljs-number >0</span>))</span></span>;
    <span class=hljs-built_in >rep</span>(k,n) <span class=hljs-built_in >rep</span>(i,n) <span class=hljs-built_in >rep</span>(j,n) {
        <span class=hljs-keyword >if</span> (j != k &amp;&amp; i != k &amp;&amp; A[i][j] == A[i][k] + A[k][j]) removable[i][j] = <span class=hljs-number >1</span>;
    }
    <span class=hljs-built_in >rep</span>(i,n) <span class=hljs-built_in >rep</span>(j,n) <span class=hljs-keyword >if</span> (removable[i][j]) A[i][j] = <span class=hljs-number >0</span>;

    <span class=hljs-comment >// 無向グラフなので上三角部分を足すと経路の和になる</span>
    ll ans = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep</span>(i,n) <span class=hljs-built_in >rep2</span>(j,i+<span class=hljs-number >1</span>, n) ans += A[i][j];
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/abc074/submissions/28302075">提出コード</a></p> <h2 id="最小全域木問題"><a href="#最小全域木問題" class=header-anchor >最小全域木問題</a></h2> <h3 id="grl2a_-_最小全域木"><a href="#grl2a_-_最小全域木" class=header-anchor >GRL<em>2</em>A - 最小全域木</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/GRL_2_A">問題</a></p> <p>適当に root を決めて, 辺のコストが小さい順に採用していく. &#40;プリム法&#41;</p> <pre><code class="cpp hljs"><span class=hljs-keyword >struct</span> <span class="hljs-title class_">Edge</span> {
    <span class=hljs-type >int</span> to;
    ll cost;
};

<span class=hljs-type >bool</span> <span class=hljs-keyword >operator</span>&gt; (<span class=hljs-type >const</span> Edge &amp;a, <span class=hljs-type >const</span> Edge &amp;b) {
    <span class=hljs-keyword >return</span> a.cost &gt; b.cost;
}

<span class=hljs-keyword >using</span> Graph = vector&lt;vector&lt;Edge&gt;&gt;;

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> v, e;
    cin &gt;&gt; v &gt;&gt; e;
    <span class=hljs-function >Graph <span class=hljs-title >graph</span><span class=hljs-params >(v)</span></span>;
    <span class=hljs-built_in >rep</span>(i,e) {
        <span class=hljs-type >int</span> s, t;
        ll w;
        cin &gt;&gt; s &gt;&gt; t &gt;&gt; w;
        graph[s].<span class=hljs-built_in >push_back</span>({t, w});
        graph[t].<span class=hljs-built_in >push_back</span>({s, w});
    }

    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >used</span><span class=hljs-params >(v, <span class=hljs-number >0</span>)</span></span>;
    used[<span class=hljs-number >0</span>] = <span class=hljs-number >1</span>;
    priority_queue&lt;Edge, vector&lt;Edge&gt;, greater&lt;Edge&gt;&gt; pq;
    <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> e : graph[<span class=hljs-number >0</span>]) pq.<span class=hljs-built_in >push</span>(e);
    ll ans = <span class=hljs-number >0</span>;
    <span class=hljs-keyword >while</span> (!pq.<span class=hljs-built_in >empty</span>()) {
        <span class=hljs-keyword >auto</span> e = pq.<span class=hljs-built_in >top</span>();
        pq.<span class=hljs-built_in >pop</span>();
        <span class=hljs-keyword >if</span> (used[e.to]) <span class=hljs-keyword >continue</span>;
        used[e.to] = <span class=hljs-number >1</span>;
        ans += e.cost;
        <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> edge : graph[e.to]) {
            <span class=hljs-keyword >if</span> (used[edge.to]) <span class=hljs-keyword >continue</span>;
            pq.<span class=hljs-built_in >push</span>(edge);
        }
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/GRL_2_A/judge/6171650/C&#43;&#43;17">提出コード</a></p> <h3 id="joi_2010_春合宿_-_finals"><a href="#joi_2010_春合宿_-_finals" class=header-anchor >JOI 2010 春合宿 - Finals</a></h3> <p><a href="https://atcoder.jp/contests/joisc2010/tasks/joisc2010_finals">問題</a></p> <p>最小全域木を作ったあと, コストが高い辺 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 本を抜いたときの残りの辺のコストを合計が答え.</p> <p><a href="https://atcoder.jp/contests/joisc2010/submissions/28302422">提出コード</a></p> <h3 id=aoj_1127_-_building_a_space_station ><a href="#aoj_1127_-_building_a_space_station" class=header-anchor >AOJ 1127 - Building a Space Station</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/1127">問題</a></p> <p>球体 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 間の距離を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=false >(</mo><mi>i</mi><mo separator=true >,</mo><mi>j</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">dist(i,j)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >)</span></span></span></span> とする. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=false >(</mo><mi>i</mi><mo separator=true >,</mo><mi>j</mi><mo stretchy=false >)</mo><mo>&gt;</mo><msub><mi>r</mi><mi>i</mi></msub><mo>+</mo><msub><mi>r</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">dist(i,j) &gt; r_i + r_j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.73333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.716668em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> ならば corridor を作る必要があるし, そうでないならば球体同士は接するまたはオーバーラップしているので corridor を作る必要はない. 作る必要のある corridor の長さを辺とする graph をつくり, 最小全域木のコストを出力する. ただしcorridor を作る必要がないときの辺の長さ 0 とする.</p> <pre><code class="cpp hljs"><span class=hljs-keyword >using</span> Graph = vector&lt;vector&lt;<span class=hljs-type >double</span>&gt;&gt;;

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >(<span class=hljs-type >int</span> n)</span> </span>{
    <span class=hljs-function >vector&lt;<span class=hljs-type >double</span>&gt; <span class=hljs-title >x</span><span class=hljs-params >(n)</span>, <span class=hljs-title >y</span><span class=hljs-params >(n)</span>, <span class=hljs-title >z</span><span class=hljs-params >(n)</span>, <span class=hljs-title >r</span><span class=hljs-params >(n)</span></span>;
    <span class=hljs-built_in >rep</span>(i,n) {
        cin &gt;&gt; x[i] &gt;&gt; y[i] &gt;&gt; z[i] &gt;&gt; r[i];
    }

    <span class=hljs-function >Graph <span class=hljs-title >dist</span><span class=hljs-params >(n, vector&lt;<span class=hljs-type >double</span>&gt;(n, <span class=hljs-number >0.0</span>))</span></span>;
    <span class=hljs-built_in >rep</span>(i,n) <span class=hljs-built_in >rep2</span>(j,i+<span class=hljs-number >1</span>,n) {
        <span class=hljs-type >double</span> dx = x[i] - x[j];
        <span class=hljs-type >double</span> dy = y[i] - y[j];
        <span class=hljs-type >double</span> dz = z[i] - z[j];
        <span class=hljs-keyword >if</span> (<span class=hljs-built_in >sqrt</span>(dx*dx + dy*dy + dz*dz) &gt; r[i] + r[j]) {
            dist[i][j] = dist[j][i] = <span class=hljs-built_in >sqrt</span>(dx*dx + dy*dy + dz*dz) - (r[i] + r[j]);
        }
    }

    <span class=hljs-comment >// PDI: cost, node id</span>
    <span class=hljs-keyword >using</span> PDI = pair&lt;<span class=hljs-type >double</span>,<span class=hljs-type >int</span>&gt;;
    priority_queue&lt;PDI, vector&lt;PDI&gt;, greater&lt;PDI&gt;&gt; pq;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,n) pq.<span class=hljs-built_in >push</span>({dist[<span class=hljs-number >0</span>][i], i});
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >used</span><span class=hljs-params >(n, <span class=hljs-number >0</span>)</span></span>;
    used[<span class=hljs-number >0</span>] = <span class=hljs-number >1</span>;
    <span class=hljs-type >double</span> ans = <span class=hljs-number >0</span>;
    <span class=hljs-keyword >while</span> (!pq.<span class=hljs-built_in >empty</span>()) {
        <span class=hljs-keyword >auto</span> t = pq.<span class=hljs-built_in >top</span>();
        pq.<span class=hljs-built_in >pop</span>();
        <span class=hljs-keyword >if</span> (used[t.second]) <span class=hljs-keyword >continue</span>;
        used[t.second] = <span class=hljs-number >1</span>;
        ans += t.first;
        <span class=hljs-built_in >rep</span>(i,n) {
            <span class=hljs-keyword >if</span> (used[i]) <span class=hljs-keyword >continue</span>;
            pq.<span class=hljs-built_in >push</span>({dist[t.second][i], i});
        }
    }
    <span class=hljs-built_in >printf</span>(<span class=hljs-string >&quot;%.3lf\n&quot;</span>, ans);
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/1127/judge/6171699/C&#43;&#43;17">提出コード</a></p> <h3 id=atcoder_beginner_contest_065_d_-_built ><a href="#atcoder_beginner_contest_065_d_-_built" class=header-anchor >AtCoder Beginner Contest 065 D - Built?</a></h3> <p><a href="https://atcoder.jp/contests/abc065/tasks/arc076_b">問題</a></p> <p>プリム法からわかるように最小全域木を構築する過程では最もコストの小さい辺から採用していくので, この問題の場合, 最も <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> 軸方向に最も近い node をつなぐ辺か, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 軸方向に最も近い node をつなぐ辺の2通り以外の辺を 考える必要はない. よって, 座標を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> それぞれでソートして隣接する node 間に辺を張ったグラフを作り最小全域木を作ればよい. 辺の数が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo stretchy=false >(</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">2(N-1)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >2</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span></span> 本になるので計算量は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy=false >(</mo><mi>N</mi><mi>log</mi><mo>⁡</mo><mi>N</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">O(N \log N)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop >lo<span style="margin-right:0.01389em;">g</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >)</span></span></span></span> になる.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-function >vector&lt;P&gt; <span class=hljs-title >x</span><span class=hljs-params >(n)</span>, <span class=hljs-title >y</span><span class=hljs-params >(n)</span></span>;
    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-type >int</span> a, b;
        cin &gt;&gt; a &gt;&gt; b;
        x[i] = {a, i};
        y[i] = {b, i};
    }

    <span class=hljs-built_in >sort</span>(<span class=hljs-built_in >all</span>(x));
    <span class=hljs-built_in >sort</span>(<span class=hljs-built_in >all</span>(y));

    <span class=hljs-keyword >using</span> Graph = vector&lt;vector&lt;P&gt;&gt;;
    <span class=hljs-function >Graph <span class=hljs-title >graph</span><span class=hljs-params >(n)</span></span>;
    <span class=hljs-built_in >rep</span>(i,n<span class=hljs-number >-1</span>) {
        <span class=hljs-type >int</span> a = x[i].second;
        <span class=hljs-type >int</span> costa = x[i].first;
        <span class=hljs-type >int</span> b = x[i+<span class=hljs-number >1</span>].second;
        <span class=hljs-type >int</span> costb = x[i+<span class=hljs-number >1</span>].first;
        graph[a].<span class=hljs-built_in >push_back</span>({<span class=hljs-built_in >abs</span>(costa - costb), b});
        graph[b].<span class=hljs-built_in >push_back</span>({<span class=hljs-built_in >abs</span>(costa - costb), a});
    }
    <span class=hljs-built_in >rep</span>(i,n<span class=hljs-number >-1</span>) {
        <span class=hljs-type >int</span> a = y[i].second;
        <span class=hljs-type >int</span> costa = y[i].first;
        <span class=hljs-type >int</span> b = y[i+<span class=hljs-number >1</span>].second;
        <span class=hljs-type >int</span> costb = y[i+<span class=hljs-number >1</span>].first;
        graph[a].<span class=hljs-built_in >push_back</span>({<span class=hljs-built_in >abs</span>(costa - costb), b});
        graph[b].<span class=hljs-built_in >push_back</span>({<span class=hljs-built_in >abs</span>(costa - costb), a});
    }

    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >used</span><span class=hljs-params >(n, <span class=hljs-number >0</span>)</span></span>;
    used[<span class=hljs-number >0</span>] = <span class=hljs-number >1</span>;
    priority_queue&lt;P, vector&lt;P&gt;, greater&lt;P&gt;&gt; pq;
    <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> e : graph[<span class=hljs-number >0</span>]) pq.<span class=hljs-built_in >push</span>(e);
    ll ans = <span class=hljs-number >0</span>;
    <span class=hljs-keyword >while</span> (!pq.<span class=hljs-built_in >empty</span>()) {
        <span class=hljs-keyword >auto</span> p = pq.<span class=hljs-built_in >top</span>();
        pq.<span class=hljs-built_in >pop</span>();
        <span class=hljs-keyword >if</span> (used[p.second]) <span class=hljs-keyword >continue</span>;
        used[p.second] = <span class=hljs-number >1</span>;
        ans += p.first;
        <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> e : graph[p.second]) {
            <span class=hljs-keyword >if</span> (used[e.second]) <span class=hljs-keyword >continue</span>;
            pq.<span class=hljs-built_in >push</span>(e);
        }
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/abc065/submissions/28302812">提出コード</a></p> <h2 id="高速な素数判定法"><a href="#高速な素数判定法" class=header-anchor >高速な素数判定法</a></h2> <h3 id="ntl1a_-_素因数分解"><a href="#ntl1a_-_素因数分解" class=header-anchor >NTL<em>1</em>A - 素因数分解</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/NTL_1_A">問題</a></p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    cout &lt;&lt; n &lt;&lt; <span class=hljs-string >&quot;:&quot;</span>;
    <span class=hljs-type >int</span> t = n;
    <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> i = <span class=hljs-number >2</span>; i*i &lt;= n; i++) {
        <span class=hljs-keyword >while</span> (t % i == <span class=hljs-number >0</span>) {
            cout &lt;&lt; <span class=hljs-string >&quot; &quot;</span> &lt;&lt; i;
            t /= i;
        }
    }
    <span class=hljs-keyword >if</span> (t &gt; <span class=hljs-number >1</span>) cout &lt;&lt; <span class=hljs-string >&quot; &quot;</span> &lt;&lt; t;
    cout &lt;&lt; endl;
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/NTL_1_A/judge/6171712/C&#43;&#43;17">提出コード</a></p> <h3 id=atcoder_beginner_contest_084_d_-_2017-like_number ><a href="#atcoder_beginner_contest_084_d_-_2017-like_number" class=header-anchor >AtCoder Beginner Contest 084 D - 2017-like Number</a></h3> <p><a href="https://atcoder.jp/contests/abc084/tasks/abc084_d">問題</a></p> <ul> <li><p>エラトステネスのふるいで素数判定テーブルを作る</p> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mn>0</mn><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[0,r]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >]</span></span></span></span> の範囲に 2017 に似た数がいくつあるかを保持する累積和を作る</p> <li><p><code>cum&#91;r&#93; - cum&#91;l-1&#93;</code> を答える</p> </ul> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> MAX = <span class=hljs-number >100005</span>;
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >isprime</span><span class=hljs-params >(MAX, <span class=hljs-literal >false</span>)</span></span>;
    <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> i = <span class=hljs-number >2</span>; i &lt; MAX; i++) {
        <span class=hljs-keyword >if</span> (!isprime[i]) {
            <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> j = i+i; j &lt; MAX; j+=i) {
                isprime[j] = <span class=hljs-literal >true</span>;
            }
        }
    }
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,MAX) isprime[i] = !isprime[i];

    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >like2017</span><span class=hljs-params >(MAX, <span class=hljs-number >0</span>)</span></span>;
    <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> i = <span class=hljs-number >3</span>; i &lt; MAX; i+=<span class=hljs-number >2</span>) {
        <span class=hljs-keyword >if</span> (isprime[i] &amp;&amp; isprime[(i+<span class=hljs-number >1</span>)/<span class=hljs-number >2</span>]) like2017[i] = <span class=hljs-number >1</span>;
    }
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >cum</span><span class=hljs-params >(MAX, <span class=hljs-number >0</span>)</span></span>;
    <span class=hljs-built_in >rep</span>(i,MAX<span class=hljs-number >-1</span>) cum[i+<span class=hljs-number >1</span>] += cum[i] + like2017[i+<span class=hljs-number >1</span>];

    <span class=hljs-type >int</span> q;
    cin &gt;&gt; q;
    <span class=hljs-built_in >rep</span>(i,q) {
        <span class=hljs-type >int</span> l, r;
        cin &gt;&gt; l &gt;&gt; r;
        cout &lt;&lt; cum[r] - cum[l<span class=hljs-number >-1</span>] &lt;&lt; endl;
    }
}</code></pre> <p><a href="https://atcoder.jp/contests/abc084/submissions/28303166">提出コード</a></p> <h2 id="高速なべき乗計算"><a href="#高速なべき乗計算" class=header-anchor >高速なべき乗計算</a></h2> <h3 id="ntl1b_-_べき乗"><a href="#ntl1b_-_べき乗" class=header-anchor >NTL<em>1</em>B - べき乗</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/NTL_1_B">問題</a></p> <pre><code class="cpp hljs"><span class=hljs-function >ll <span class=hljs-title >powmod</span><span class=hljs-params >(ll a, ll n, ll mod)</span> </span>{
    ll ret = <span class=hljs-number >1</span>;
    <span class=hljs-keyword >while</span> (n) {
        <span class=hljs-keyword >if</span> (n&amp;<span class=hljs-number >1</span>) ret = ret * a % mod;
        a = a * a % mod;
        n /= <span class=hljs-number >2</span>;
    }
    <span class=hljs-keyword >return</span> ret;
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> m, n;
    cin &gt;&gt; m &gt;&gt; n;
    cout &lt;&lt; <span class=hljs-built_in >powmod</span>(m, n, (ll)<span class=hljs-number >1e9</span>+<span class=hljs-number >7</span>) &lt;&lt; endl;
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/NTL_1_B/judge/6171740/C&#43;&#43;17">提出コード</a></p> <h3 id="square869120contest_1_e_-_散歩"><a href="#square869120contest_1_e_-_散歩" class=header-anchor >Square869120Contest #1 E - 散歩</a></h3> <p><a href="https://atcoder.jp/contests/s8pc-1/tasks/s8pc_1_e">問題</a></p> <pre><code class="cpp hljs"><span class=hljs-type >const</span> ll MOD = (ll)<span class=hljs-number >1e9</span> + <span class=hljs-number >7</span>;

<span class=hljs-function >ll <span class=hljs-title >powmod</span><span class=hljs-params >(ll a, ll n, ll mod)</span> </span>{
    ll ret = <span class=hljs-number >1</span>;
    <span class=hljs-keyword >while</span> (n) {
        <span class=hljs-keyword >if</span> (n&amp;<span class=hljs-number >1</span>) ret = ret * a % mod;
        a = a * a % mod;
        n /= <span class=hljs-number >2</span>;
    }
    <span class=hljs-keyword >return</span> ret;
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n, q;
    cin &gt;&gt; n &gt;&gt; q;
    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >a</span><span class=hljs-params >(n)</span>, <span class=hljs-title >c</span><span class=hljs-params >(q+<span class=hljs-number >2</span>, <span class=hljs-number >0</span>)</span></span>;
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; a[i];
    <span class=hljs-built_in >rep</span>(i,q) cin &gt;&gt; c[i+<span class=hljs-number >1</span>], c[i+<span class=hljs-number >1</span>]--;

    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >len</span><span class=hljs-params >(n, <span class=hljs-number >0</span>)</span></span>;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,n) len[i] = <span class=hljs-built_in >powmod</span>(a[i<span class=hljs-number >-1</span>], a[i], MOD);
    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >cumlen</span><span class=hljs-params >(n+<span class=hljs-number >1</span>, <span class=hljs-number >0</span>)</span></span>;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,n+<span class=hljs-number >1</span>) {
        cumlen[i] += cumlen[i<span class=hljs-number >-1</span>] + len[i];
        cumlen[i] %= MOD;
    }

    ll ans = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,q+<span class=hljs-number >2</span>) {
        <span class=hljs-type >int</span> a = c[i];
        <span class=hljs-type >int</span> b = c[i<span class=hljs-number >-1</span>];
        <span class=hljs-keyword >if</span> (a &gt; b) <span class=hljs-built_in >swap</span>(a,b);
        ans += (cumlen[b] - cumlen[a] + MOD) % MOD;
        ans %= MOD;
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/s8pc-1/submissions/28303428">提出コード</a></p> <h2 id="逆元を使う問題"><a href="#逆元を使う問題" class=header-anchor >逆元を使う問題</a></h2> <h3 id="atcoder_beginner_contest_034_c_-_経路"><a href="#atcoder_beginner_contest_034_c_-_経路" class=header-anchor >AtCoder Beginner Contest 034 C - 経路</a></h3> <p><a href="https://atcoder.jp/contests/abc034/tasks/abc034_c">問題</a></p> <pre><code class="cpp hljs"><span class=hljs-function >ll <span class=hljs-title >powmod</span><span class=hljs-params >(ll x, ll n, ll mod)</span> </span>{
    ll ret = <span class=hljs-number >1</span>;
    <span class=hljs-keyword >while</span> (n) {
        <span class=hljs-keyword >if</span> (n&amp;<span class=hljs-number >1</span>) ret = ret * x % mod;
        x = x * x % mod;
        n /= <span class=hljs-number >2</span>;
    }
    <span class=hljs-keyword >return</span> ret;
}

<span class=hljs-function >ll <span class=hljs-title >invmod</span><span class=hljs-params >(ll x, ll mod)</span> </span>{
    <span class=hljs-keyword >return</span> <span class=hljs-built_in >powmod</span>(x, mod<span class=hljs-number >-2</span>, mod);
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >const</span> ll MOD = (ll)<span class=hljs-number >1e9</span> + <span class=hljs-number >7</span>;
    <span class=hljs-type >const</span> ll MAX = (ll)<span class=hljs-number >2e5</span> + <span class=hljs-number >5</span>;
    ll W, H;
    cin &gt;&gt; W &gt;&gt; H;
    <span class=hljs-comment >// (W+H) choose W</span>
    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >fac</span><span class=hljs-params >(MAX, <span class=hljs-number >1</span>)</span>, <span class=hljs-title >invfac</span><span class=hljs-params >(MAX, <span class=hljs-number >1</span>)</span></span>;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,MAX) fac[i] = (fac[i<span class=hljs-number >-1</span>] * i) % MOD;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,MAX) invfac[i] = <span class=hljs-built_in >invmod</span>(fac[i], MOD);

    W--, H--;
    ll ans = <span class=hljs-number >1</span>;
    ans = ans * fac[H+W] % MOD;
    ans = ans * invfac[H] % MOD;
    ans = ans * invfac[W] % MOD;
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/abc034/submissions/28303535">提出コード</a></p> <h3 id=atcoder_beginner_contest_145_d_-_knight ><a href="#atcoder_beginner_contest_145_d_-_knight" class=header-anchor >AtCoder Beginner Contest 145 D - Knight</a></h3> <p><a href="https://atcoder.jp/contests/abc145/tasks/abc145_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>j</mi><mo>+</mo><mn>2</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(i+1,j+2)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >2</span><span class=mclose >)</span></span></span></span> の操作を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span></span></span></span> 回, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mi>i</mi><mo>+</mo><mn>2</mn><mo separator=true >,</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(i+2,j+1)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span></span> の操作を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span> 回行うとすると</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.2500em  columnalign=right  columnspacing=""><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow><mo fence=true >{</mo><mtable rowspacing=0.2500em  columnalign=right  columnspacing=""><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mi>a</mi><mo>+</mo><mn>2</mn><mi>b</mi><mo>=</mo><mi>X</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mn>2</mn><mi>a</mi><mo>+</mo><mi>b</mi><mo>=</mo><mi>Y</mi></mrow></mstyle></mtd></mtr></mtable></mrow><mo>⇒</mo><mrow><mo fence=true >{</mo><mtable rowspacing=0.2500em  columnalign=right  columnspacing=""><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mi>a</mi><mo>=</mo><mfrac><mrow><mn>2</mn><mi>Y</mi><mo>−</mo><mi>X</mi></mrow><mn>3</mn></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mi>b</mi><mo>=</mo><mfrac><mrow><mn>2</mn><mi>X</mi><mo>−</mo><mi>Y</mi></mrow><mn>3</mn></mfrac></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \left\{ \begin{aligned} a + 2b = X \\ 2a + b = Y \end{aligned} \right. \Rightarrow \left\{ \begin{aligned} a = \frac{2Y - X}{3} \\ b = \frac{2X - Y}{3} \end{aligned} \right. \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:5.10004em;vertical-align:-2.3000200000000004em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.8000199999999995em;"><span style="top:-4.80002em;"><span class=pstrut  style="height:4.65002em;"></span><span class=mord ><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >2</span><span class="mord mathnormal">b</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span><span style="top:-2.41em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >⇒</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=minner ><span class=mopen ><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.65002em;"><span style="top:-1.8999899999999998em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-1.8919899999999998em;"><span class=pstrut  style="height:3.15em;"></span><span style="height:0.6160000000000001em;width:0.889em;"><svg width='0.889em' height='0.6160000000000001em' style='width:0.889em' viewBox='0 0 889 616' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V616 H384z M384 0 H504 V616 H384z'/></svg></span></span><span style="top:-3.15001em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292009999999999em;"><span class=pstrut  style="height:3.15em;"></span><span style="height:0.6160000000000001em;width:0.889em;"><svg width='0.889em' height='0.6160000000000001em' style='width:0.889em' viewBox='0 0 889 616' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V616 H384z M384 0 H504 V616 H384z'/></svg></span></span><span style="top:-4.90002em;"><span class=pstrut  style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:2.15002em;"><span></span></span></span></span></span></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:2.59633em;"><span style="top:-4.59633em;"><span class=pstrut  style="height:3.3603300000000003em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.36033em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >3</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.2500000000000004em;"><span class=pstrut  style="height:3.3603300000000003em;"></span><span class=mord ><span class="mord mathnormal">b</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.36033em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >3</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:2.09633em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:2.3000200000000004em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>が成り立つ. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a &lt; 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> or <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">b &lt; 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">b</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> のとき条件を満たす操作はない.</p> <p>操作できるときは <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><msub><mrow></mrow><mrow><mi>a</mi><mo>+</mo><mi>b</mi></mrow></msub><msub><mi mathvariant=normal >C</mi><mi>a</mi></msub><mo>=</mo><mfrac><mrow><mo stretchy=false >(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy=false >)</mo><mo stretchy=false >!</mo></mrow><mrow><mi>a</mi><mo stretchy=false >!</mo><mtext> </mtext><mi>b</mi><mo stretchy=false >!</mo></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {}_{ a+b}\mathrm{C}_{ a} = \frac{(a+b)!}{a!~b!}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.891661em;vertical-align:-0.208331em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">b</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.113em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=mclose >!</span><span class="mspace nobreak"> </span><span class="mord mathnormal">b</span><span class=mclose >!</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class=mclose >)!</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> を求めればよい</p> <pre><code class="cpp hljs"><span class=hljs-function >ll <span class=hljs-title >powmod</span><span class=hljs-params >(ll x, ll n, ll mod)</span> </span>{
    ll ret = <span class=hljs-number >1</span>;
    <span class=hljs-keyword >while</span> (n) {
        <span class=hljs-keyword >if</span>(n&amp;<span class=hljs-number >1</span>) ret = ret * x % mod;
        x = x * x % mod;
        n &gt;&gt;= <span class=hljs-number >1</span>;
    }
    <span class=hljs-keyword >return</span> ret;
}

<span class=hljs-function >ll <span class=hljs-title >invmod</span><span class=hljs-params >(ll x, ll mod)</span> </span>{
    <span class=hljs-keyword >return</span> <span class=hljs-built_in >powmod</span>(x, mod<span class=hljs-number >-2</span>, mod);
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    ll MAX = (ll)<span class=hljs-number >2e6</span> + <span class=hljs-number >6</span>;
    ll MOD = (ll)<span class=hljs-number >1e9</span> + <span class=hljs-number >7</span>;
    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >fac</span><span class=hljs-params >(MAX, <span class=hljs-number >1</span>)</span>, <span class=hljs-title >invfac</span><span class=hljs-params >(MAX, <span class=hljs-number >1</span>)</span></span>;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,MAX) fac[i] = fac[i<span class=hljs-number >-1</span>] * i % MOD;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,MAX) invfac[i] = <span class=hljs-built_in >invmod</span>(fac[i], MOD);

    ll x, y;
    cin &gt;&gt; x &gt;&gt; y;
    ll a = <span class=hljs-number >2</span>* x - y;
    ll b = <span class=hljs-number >2</span>* y - x;
    <span class=hljs-keyword >if</span> (a &gt;= <span class=hljs-number >0</span> &amp;&amp; b &gt;= <span class=hljs-number >0</span> &amp;&amp; a % <span class=hljs-number >3</span> == <span class=hljs-number >0</span> &amp;&amp; b % <span class=hljs-number >3</span> == <span class=hljs-number >0</span>) {
        a /= <span class=hljs-number >3</span>, b /= <span class=hljs-number >3</span>;
        ll ans = fac[a+b] * (invfac[a] * invfac[b] % MOD) % MOD;
        cout &lt;&lt; ans &lt;&lt; endl;
        <span class=hljs-keyword >return</span>;
    }
    cout &lt;&lt; <span class=hljs-number >0</span> &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/abc145/submissions/28303725">提出コード</a></p> <h3 id="atcoder_beginner_contest_021_d_-_多重ループ"><a href="#atcoder_beginner_contest_021_d_-_多重ループ" class=header-anchor >AtCoder Beginner Contest 021 D - 多重ループ</a></h3> <p><a href="https://atcoder.jp/contests/abc021/tasks/abc021_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mi>i</mi><mo mathvariant=normal >′</mo></msubsup><mo>=</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a^\prime_i = a_i + k-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.010556em;vertical-align:-0.258664em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.258664em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.73333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> とおくと <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><msubsup><mi>a</mi><mn>1</mn><mo mathvariant=normal >′</mo></msubsup><mo>&lt;</mo><mo>⋯</mo><mo>&lt;</mo><msubsup><mi>a</mi><mi>k</mi><mo mathvariant=normal >′</mo></msubsup><mo>≤</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1 \leq a^\prime_1 &lt; \cdots &lt; a^\prime_k \leq n + k - 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.24810799999999997em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.035em;vertical-align:-0.2831079999999999em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-2.4168920000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2831079999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> となる. よって <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mn>1</mn><mo separator=true >,</mo><mi>n</mi><mo>−</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[1, n-k-1]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span></span></span></span> の範囲の数字を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 個選んで昇順に並べると題意を条件を満たした数列を構築できる. そのような選び方は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><msub><mrow></mrow><mrow><mi>n</mi><mo>+</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><msub><mi mathvariant=normal >C</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><mo stretchy=false >(</mo><mi>n</mi><mo>+</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo stretchy=false >!</mo></mrow><mrow><mi>k</mi><mo stretchy=false >!</mo><mtext> </mtext><mo stretchy=false >(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo stretchy=false >!</mo></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {}_{ n+k-1}\mathrm{C}_{ k} = \frac{(n+k-1)!}{k! ~ (n-1)!}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.891661em;vertical-align:-0.208331em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.363em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >!</span><span class="mspace nobreak"> </span><span class=mopen >(</span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >)!</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mopen >(</span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >)!</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 通りある.</p> <pre><code class="cpp hljs"><span class=hljs-function >ll <span class=hljs-title >powmod</span><span class=hljs-params >(ll x, ll n, ll mod)</span> </span>{
    ll ret = <span class=hljs-number >1</span>;
    <span class=hljs-keyword >while</span> (n) {
        <span class=hljs-keyword >if</span>(n&amp;<span class=hljs-number >1</span>) ret = ret * x % mod;
        x = x * x % mod;
        n &gt;&gt;= <span class=hljs-number >1</span>;
    }
    <span class=hljs-keyword >return</span> ret;
}

<span class=hljs-function >ll <span class=hljs-title >invmod</span><span class=hljs-params >(ll x, ll mod)</span> </span>{
    <span class=hljs-keyword >return</span> <span class=hljs-built_in >powmod</span>(x, mod<span class=hljs-number >-2</span>, mod);
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    ll MAX = (ll)<span class=hljs-number >2e5</span> + <span class=hljs-number >5</span>;
    ll MOD = (ll)<span class=hljs-number >1e9</span> + <span class=hljs-number >7</span>;
    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >fac</span><span class=hljs-params >(MAX, <span class=hljs-number >1</span>)</span>, <span class=hljs-title >invfac</span><span class=hljs-params >(MAX, <span class=hljs-number >1</span>)</span></span>;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,MAX) fac[i] = fac[i<span class=hljs-number >-1</span>] * i % MOD;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,MAX) invfac[i] = <span class=hljs-built_in >invmod</span>(fac[i], MOD);

    ll n, k;
    cin &gt;&gt; n &gt;&gt; k;
    ll ans = fac[n+k<span class=hljs-number >-1</span>] * (invfac[k] * invfac[n<span class=hljs-number >-1</span>] % MOD) % MOD;
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/abc021/submissions/28303844">提出コード</a></p> <h3 id=atcoder_beginner_contest_149_f_-_surrounded_nodes ><a href="#atcoder_beginner_contest_149_f_-_surrounded_nodes" class=header-anchor >AtCoder Beginner Contest 149 F - Surrounded Nodes</a></h3> <p><a href="https://atcoder.jp/contests/abc149/tasks/abc149_f">問題</a></p> <p>解けていない</p> <h2 id="全国統一プログラミング王決定戦本戦_a_-_abundant_resources"><a href="#全国統一プログラミング王決定戦本戦_a_-_abundant_resources" class=header-anchor >全国統一プログラミング王決定戦本戦 A - Abundant Resources</a></h2> <h3 id="全国統一プログラミング王決定戦本戦_a_-_abundant_resources__2"><a href="#全国統一プログラミング王決定戦本戦_a_-_abundant_resources__2" class=header-anchor >全国統一プログラミング王決定戦本戦 A - Abundant Resources</a></h3> <p><a href="https://atcoder.jp/contests/nikkei2019-final/tasks/nikkei2019_final_a">問題</a> <a href="https://atcoder.jp/contests/nikkei2019-final/submissions/28306263">提出コード</a></p> <h3 id="joi_2010_本選_1_-_旅人"><a href="#joi_2010_本選_1_-_旅人" class=header-anchor >JOI 2010 本選 1 - 旅人</a></h3> <p><a href="https://atcoder.jp/contests/joi2010ho/tasks/joi2010ho_a">問題</a> <a href="https://atcoder.jp/contests/joi2010ho/submissions/28306419">提出コード</a></p> <h3 id="joi_2011_本選_1_-_惑星探査"><a href="#joi_2011_本選_1_-_惑星探査" class=header-anchor >JOI 2011 本選 1 - 惑星探査</a></h3> <p><a href="https://atcoder.jp/contests/joi2011ho/tasks/joi2011ho1">問題</a></p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo stretchy=false >]</mo><mo>=</mo><mi>s</mi><mo stretchy=false >[</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo stretchy=false >]</mo><mo>+</mo><mi>s</mi><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo>−</mo><mi>s</mi><mo stretchy=false >[</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo>+</mo><mo stretchy=false >(</mo><mi>g</mi><mi>r</mi><mi>i</mi><mi>d</mi><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo stretchy=false >]</mo><mo>=</mo><msup><mo>=</mo><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup><msup><mi>X</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">s[x][y] = s[x-1][y] + s[x][y-1] - s[x-1][y-1] + (grid[x][y] == &#x27;X&#x27;)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span></span><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mrel ><span class=mrel >=</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.001892em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> <p>といった感じで累積和を求める</p> <p><a href="https://atcoder.jp/contests/joi2011ho/submissions/28306857">提出コード</a></p> <h3 id=atcoder_beginner_contest_106_d_-_atcoder_express_2 ><a href="#atcoder_beginner_contest_106_d_-_atcoder_express_2" class=header-anchor >AtCoder Beginner Contest 106 D - AtCoder Express 2</a></h3> <p><a href="https://atcoder.jp/contests/abc106/tasks/abc106_d">問題</a> <a href="https://atcoder.jp/contests/abc106/submissions/28309629">提出コード</a></p> <h3 id="gigacode_2019_d_-_家の建設"><a href="#gigacode_2019_d_-_家の建設" class=header-anchor >GigaCode 2019 D - 家の建設</a></h3> <p><a href="https://atcoder.jp/contests/gigacode-2019/tasks/gigacode_2019_d">問題</a> <a href="https://atcoder.jp/contests/gigacode-2019/submissions/28310222">提出コード</a></p> <h3 id=atcoder_beginner_contest_014_c_-_atcolor ><a href="#atcoder_beginner_contest_014_c_-_atcolor" class=header-anchor >AtCoder Beginner Contest 014 C - AtColor</a></h3> <p><a href="https://atcoder.jp/contests/abc014/tasks/abc014_3">問題</a> <a href="https://atcoder.jp/contests/abc014/submissions/28310306">提出コード</a></p> <h3 id="aoj_2013_-_大崎"><a href="#aoj_2013_-_大崎" class=header-anchor >AOJ 2013 - 大崎</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/2013">問題</a> <a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/2013/judge/6172945/C&#43;&#43;17">提出コード</a></p> <h3 id="joi_2015_本選_1_-_鉄道運賃"><a href="#joi_2015_本選_1_-_鉄道運賃" class=header-anchor >JOI 2015 本選 1 - 鉄道運賃</a></h3> <p><a href="https://atcoder.jp/contests/joi2015ho/tasks/joi2015ho_a">問題</a></p> <p>各鉄道を何回乗るかをいもす法で調べて, きっぷまたは IC のうち安い方を使うようにする.</p> <p><a href="https://atcoder.jp/contests/joi2015ho/submissions/28311058">提出コード</a></p> <h3 id="joi_2012_本選_4_-_釘"><a href="#joi_2012_本選_4_-_釘" class=header-anchor >JOI 2012 本選 4 - 釘</a></h3> <p><a href="https://atcoder.jp/contests/joi2012ho/tasks/joi2012ho4">問題</a></p> <p>理解しきれなかったので一旦飛ばし</p> <h2 id=union-find ><a href="#union-find" class=header-anchor >Union-Find</a></h2> <h3 id="dsl1a_-_互いに素な集合"><a href="#dsl1a_-_互いに素な集合" class=header-anchor >DSL<em>1</em>A - 互いに素な集合</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/DSL_1_A">問題</a> <a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/DSL_1_A/judge/6175933/C&#43;&#43;17">提出コード</a></p> <h3 id=atcoder_beginner_contest_075_c_-_bridge ><a href="#atcoder_beginner_contest_075_c_-_bridge" class=header-anchor >AtCoder Beginner Contest 075 C - Bridge</a></h3> <p><a href="https://atcoder.jp/contests/abc075/tasks/abc075_c">問題</a> <a href="https://atcoder.jp/contests/abc075/submissions/28324991">提出コード</a></p> <h3 id=atcoder_beginner_contest_120_d_-_decayed_bridge ><a href="#atcoder_beginner_contest_120_d_-_decayed_bridge" class=header-anchor >AtCoder Beginner Contest 120 D - Decayed Bridge</a></h3> <p><a href="https://atcoder.jp/contests/abc120/tasks/abc120_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> を反転させて, 橋を構築していくごとに不便さがどう減るかを考える. これを逆順にすれば問題の答えとなる.</p> <p>橋が全くなかったときの不便さは <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><msub><mrow></mrow><mi>n</mi></msub><msub><mi mathvariant=normal >C</mi><mn>2</mn></msub><mo>=</mo><mfrac><mrow><mi>n</mi><mo stretchy=false >(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><mn>2</mn></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {}_{ n}\mathrm{C}_{ 2} = \frac{n(n-1)}{2}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.113em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=mopen >(</span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> となる. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> 個の島が橋によって行き来できるようになったとすると不便さは <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mi>x</mi></msub><msub><mi mathvariant=normal >C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{}_{ x}\mathrm{C}_{ 2}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 減る. また <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> 個の島からなる島群と, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 個の島からなる島群が橋によってつながると不便さは <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><msub><mrow></mrow><mi>x</mi></msub><msub><mi mathvariant=normal >C</mi><mn>2</mn></msub><mo>+</mo><msub><mrow></mrow><mi>y</mi></msub><msub><mi mathvariant=normal >C</mi><mn>2</mn></msub><mo>−</mo><msub><mrow></mrow><mrow><mi>x</mi><mo>+</mo><mi>y</mi></mrow></msub><msub><mi mathvariant=normal >C</mi><mn>2</mn></msub><mo>=</mo><mfrac><mrow><mi>x</mi><mo stretchy=false >(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><mn>2</mn></mfrac><mo>+</mo><mfrac><mrow><mi>y</mi><mo stretchy=false >(</mo><mi>y</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><mn>2</mn></mfrac><mo>−</mo><mfrac><mrow><mo stretchy=false >(</mo><mi>x</mi><mo>+</mo><mi>y</mi><mo stretchy=false >)</mo><mo stretchy=false >(</mo><mi>x</mi><mo>+</mo><mi>y</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><mn>2</mn></mfrac><mo>=</mo><mi>x</mi><mi>y</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {}_{ x}\mathrm{C}_{ 2} + {}_{ y}\mathrm{C}_{ 2} - {}_{ x+y}\mathrm{C}_{ 2} = \frac{x(x-1)}{2} + \frac{y(y-1)}{2} - \frac{(x+y)(x+y-1)}{2} = xy</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord ></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathrm">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.113em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.113em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.113em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> だけ減る.</p> <pre><code class="cpp hljs"><span class=hljs-keyword >struct</span> <span class="hljs-title class_">UnionFind</span> {
    vector&lt;<span class=hljs-type >int</span>&gt; d;
    <span class=hljs-built_in >UnionFind</span>(<span class=hljs-type >int</span> n) : <span class=hljs-built_in >d</span>(n, <span class=hljs-number >-1</span>) {}
    <span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >find</span><span class=hljs-params >(<span class=hljs-type >int</span> x)</span> </span>{
        <span class=hljs-keyword >if</span> (d[x] &lt; <span class=hljs-number >0</span>) <span class=hljs-keyword >return</span> x;
        <span class=hljs-keyword >return</span> d[x] = <span class=hljs-built_in >find</span>(d[x]);
    }
    <span class=hljs-function ><span class=hljs-type >bool</span> <span class=hljs-title >unite</span><span class=hljs-params >(<span class=hljs-type >int</span> x, <span class=hljs-type >int</span> y)</span> </span>{
        x = <span class=hljs-built_in >find</span>(x), y = <span class=hljs-built_in >find</span>(y);
        <span class=hljs-keyword >if</span> (x == y) <span class=hljs-keyword >return</span> <span class=hljs-literal >false</span>;
        <span class=hljs-keyword >if</span> (d[x] &gt; d[y]) <span class=hljs-built_in >swap</span>(x,y);
        d[x] += d[y];
        d[y] = x;
        <span class=hljs-keyword >return</span> <span class=hljs-literal >true</span>;
    }
    <span class=hljs-function ><span class=hljs-type >bool</span> <span class=hljs-title >same</span><span class=hljs-params >(<span class=hljs-type >int</span> x, <span class=hljs-type >int</span> y)</span> </span>{
        <span class=hljs-keyword >return</span> <span class=hljs-built_in >find</span>(x) == <span class=hljs-built_in >find</span>(y);
    }
    <span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >size</span><span class=hljs-params >(<span class=hljs-type >int</span> x)</span> </span>{
        <span class=hljs-keyword >return</span> -d[<span class=hljs-built_in >find</span>(x)];
    }
};

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    ll n, m;
    cin &gt;&gt; n &gt;&gt; m;
    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >a</span><span class=hljs-params >(m)</span>, <span class=hljs-title >b</span><span class=hljs-params >(m)</span></span>;
    <span class=hljs-built_in >rep</span>(i,m) {
        cin &gt;&gt; a[i] &gt;&gt; b[i];
        a[i]--, b[i]--;
    }
    <span class=hljs-built_in >reverse</span>(<span class=hljs-built_in >all</span>(a));
    <span class=hljs-built_in >reverse</span>(<span class=hljs-built_in >all</span>(b));

    ll inconvenient = n * (n<span class=hljs-number >-1</span>) / <span class=hljs-number >2</span>;
    <span class=hljs-function >UnionFind <span class=hljs-title >uf</span><span class=hljs-params >(n)</span></span>;
    vector&lt;ll&gt; ans;
    ans.<span class=hljs-built_in >reserve</span>(m);
    ans.<span class=hljs-built_in >push_back</span>(inconvenient);
    <span class=hljs-built_in >rep</span>(i,m<span class=hljs-number >-1</span>) {
        <span class=hljs-keyword >if</span> (uf.<span class=hljs-built_in >same</span>(a[i], b[i])) {
            ans.<span class=hljs-built_in >push_back</span>(inconvenient);
        } <span class=hljs-keyword >else</span> {
            ll asize = uf.<span class=hljs-built_in >size</span>(a[i]);
            ll bsize = uf.<span class=hljs-built_in >size</span>(b[i]);
            inconvenient -= asize * bsize;
            ans.<span class=hljs-built_in >push_back</span>(inconvenient);
            uf.<span class=hljs-built_in >unite</span>(a[i], b[i]);
        }
    }
    <span class=hljs-built_in >reverse</span>(<span class=hljs-built_in >all</span>(ans));
    <span class=hljs-keyword >for</span> (ll x : ans) cout &lt;&lt; x &lt;&lt; endl;
}</code></pre> <pre><code class="cpp hljs"><span class=hljs-built_in >rep</span>(i,m<span class=hljs-number >-1</span>) {
    <span class=hljs-keyword >if</span> (uf.<span class=hljs-built_in >same</span>(a[i], b[i])) {
        ans.<span class=hljs-built_in >push_back</span>(inconvenient);
    } <span class=hljs-keyword >else</span> {
        ll asize = uf.<span class=hljs-built_in >size</span>(a[i]);
        ll bsize = uf.<span class=hljs-built_in >size</span>(b[i]);
        inconvenient -= asize * bsize;
        ans.<span class=hljs-built_in >push_back</span>(inconvenient);
        uf.<span class=hljs-built_in >unite</span>(a[i], b[i]);
    }
}</code></pre> <p>のように loop の回数が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 回で良い理由は, 1つの目の橋が壊れるときの不便さは 2個目 ~ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span> 個目の橋を構築したときの不便さなので <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">A_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">B_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 間の橋のことは考えなくてよい.</p> <p><a href="https://atcoder.jp/contests/abc120/submissions/28329931">提出コード</a></p> <p>その他のテクニック</p> <h3 id="joi_2008_本選_1_-_碁石ならべ"><a href="#joi_2008_本選_1_-_碁石ならべ" class=header-anchor >JOI 2008 本選 1 - 碁石ならべ</a></h3> <p><a href="https://atcoder.jp/contests/joi2008ho/tasks/joi2008ho_a">問題</a> <a href="https://atcoder.jp/contests/joi2008ho/submissions/28329897">提出コード</a></p> <h3 id="joi_2013_本選_1_-_電飾"><a href="#joi_2013_本選_1_-_電飾" class=header-anchor >JOI 2013 本選 1 - 電飾</a></h3> <p><a href="https://atcoder.jp/contests/joi2013ho/tasks/joi2013ho1">問題</a> <a href="https://atcoder.jp/contests/joi2013ho/submissions/28340054">提出コード</a></p> <h3 id=square869120contest_5_b_-_emblem ><a href="#square869120contest_5_b_-_emblem" class=header-anchor >Square869120Contest #5 B - Emblem</a></h3> <p><a href="https://atcoder.jp/contests/s8pc-5/tasks/s8pc_5_b">問題</a></p> <p>半径が決まっていない円の半径を全て同じペースで大きくしていって, どれかの円の接したときの半径が取りうる最大の半径となると考え, 二分探索で取れる半径の最大値を探した. 解説によるとそんな複雑なことはしなくてよかったらしい.</p> <p><a href="https://atcoder.jp/contests/s8pc-5/submissions/28340947">提出コード</a></p> <h3 id=atcoder_beginner_contest_144_d_-_water_bottle ><a href="#atcoder_beginner_contest_144_d_-_water_bottle" class=header-anchor >AtCoder Beginner Contest 144 D - Water Bottle</a></h3> <p><a href="https://atcoder.jp/contests/abc144/tasks/abc144_d">問題</a> <a href="https://atcoder.jp/contests/abc144/submissions/28341673">提出コード</a></p> <h3 id="aoj_1193_-_連鎖消滅パズル"><a href="#aoj_1193_-_連鎖消滅パズル" class=header-anchor >AOJ 1193 - 連鎖消滅パズル</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/1193">問題</a> <a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/1193/judge/6184833/C&#43;&#43;17">提出コード</a></p> <h3 id="square869120contest_3_b_-_石落としゲーム"><a href="#square869120contest_3_b_-_石落としゲーム" class=header-anchor >Square869120Contest #3 B - 石落としゲーム</a></h3> <p><a href="https://atcoder.jp/contests/s8pc-3/tasks/s8pc_3_b">問題</a> <a href="https://atcoder.jp/contests/s8pc-3/submissions/28353405">提出コード</a></p> <h3 id="aoj_1149_-_ケーキカット"><a href="#aoj_1149_-_ケーキカット" class=header-anchor >AOJ 1149 - ケーキカット</a></h3> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/1149">問題</a> <a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/1149/judge/6185660/C&#43;&#43;17">提出コード</a></p> <h3 id=atcoder_beginner_contest_149_b_-_greedy_takahashi ><a href="#atcoder_beginner_contest_149_b_-_greedy_takahashi" class=header-anchor >AtCoder Beginner Contest 149 B - Greedy Takahashi</a></h3> <p><a href="https://atcoder.jp/contests/abc149/tasks/abc149_b">問題</a> <a href="https://atcoder.jp/contests/abc149/submissions/28354817">提出コード</a></p> <h3 id=atcoder_beginner_contest_139_d_-_modsum ><a href="#atcoder_beginner_contest_139_d_-_modsum" class=header-anchor >AtCoder Beginner Contest 139 D - ModSum</a></h3> <p><a href="https://atcoder.jp/contests/abc139/tasks/abc139_d">問題</a> <a href="https://atcoder.jp/contests/abc139/submissions/28362718">提出コード</a></p> <h3 id=atcoder_beginner_contest_150_d_-_semi_common_multiple ><a href="#atcoder_beginner_contest_150_d_-_semi_common_multiple" class=header-anchor >AtCoder Beginner Contest 150 D - Semi Common Multiple</a></h3> <p><a href="https://atcoder.jp/contests/abc150/tasks/abc150_d">問題</a> <a href="https://atcoder.jp/contests/abc150/submissions/28363212">提出コード</a></p> <h3 id="三井住友信託銀行プログラミングコンテスト2019_予選_e_-_colorful_hats_2"><a href="#三井住友信託銀行プログラミングコンテスト2019_予選_e_-_colorful_hats_2" class=header-anchor >三井住友信託銀行プログラミングコンテスト2019 予選 E - Colorful Hats 2</a></h3> <p><a href="https://atcoder.jp/contests/sumitrust2019/tasks/sumitb2019_e">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">A_i = k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>N</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 \leq k \leq N-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>&#41; だったとき, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目の人の帽子の選び方を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> とすると</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.2500em  columnalign=right  columnspacing=""><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mrow><mo fence=true >{</mo><mtable rowspacing=0.2500em  columnalign="right left" columnspacing=0em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mn>3</mn><mo>−</mo><mtext>(それまでに出た </mtext><mn>0</mn><mtext> と言った人の数) if </mtext><mi>k</mi><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo stretchy=false >(</mo><mtext>それまでに出た </mtext><mi>k</mi><mo>−</mo><mn>1</mn><mtext> と言った人の数</mtext><mo stretchy=false >)</mo><mo>−</mo><mo stretchy=false >(</mo><mtext>それまでに出た </mtext><mi>k</mi><mtext> と言った人の数</mtext><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} T_i = \left\{ \begin{aligned} &amp;3 - \text{(それまでに出た } 0 \text{ と言った人の数) if } k = 0 \\ &amp; (\text{それまでに出た } k-1 \text{ と言った人の数}) - (\text{それまでに出た } k \text{ と言った人の数}) \end{aligned} \right. \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3.3000300000000005em;vertical-align:-1.400015em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.9000150000000005em;"><span style="top:-3.9000150000000002em;"><span class=pstrut  style="height:3.75em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.7500000000000002em;"><span style="top:-3.75em;"><span class=pstrut  style="height:2.84em;"></span><span class=mord ></span></span><span style="top:-2.25em;"><span class=pstrut  style="height:2.84em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.2500000000000002em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.7500000000000002em;"><span style="top:-3.91em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ></span><span class=mord >3</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord text"><span class=mord >(</span><span class="mord cjk_fallback">それまでに出た</span><span class=mord > </span></span><span class=mord >0</span><span class="mord text"><span class=mord > </span><span class="mord cjk_fallback">と言った人の数</span><span class=mord >) if </span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span></span></span><span style="top:-2.41em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ></span><span class=mopen >(</span><span class="mord text"><span class="mord cjk_fallback">それまでに出た</span><span class=mord > </span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class="mord text"><span class=mord > </span><span class="mord cjk_fallback">と言った人の数</span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mopen >(</span><span class="mord text"><span class="mord cjk_fallback">それまでに出た</span><span class=mord > </span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord text"><span class=mord > </span><span class="mord cjk_fallback">と言った人の数</span></span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.2500000000000002em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.400015em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>通りである. よって答えは <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><munder><mo>∏</mo><mi>i</mi></munder><msub><mi>T</mi><mi>i</mi></msub><mspace></mspace><mspace width=1em /><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >d</mi></mrow><mtext> </mtext><mtext> </mtext><mn>1000000007</mn></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \prod_i T_i \mod 1000000007</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.327674em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace  style="margin-right:1em;"></span></span><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">mod</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >1000000007</span></span></span></span>.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >A</span><span class=hljs-params >(n)</span></span>;
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; A[i], A[i]++;

    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >cnt</span><span class=hljs-params >(n+<span class=hljs-number >1</span>, <span class=hljs-number >0</span>)</span></span>;
    cnt[<span class=hljs-number >0</span>] = <span class=hljs-number >3</span>;
    ll ans = <span class=hljs-number >1</span>;
    <span class=hljs-built_in >rep</span>(i,n) {
        ans *= cnt[A[i]<span class=hljs-number >-1</span>];
        ans %= MOD;
        cnt[A[i]]++;
        cnt[A[i]<span class=hljs-number >-1</span>]--;
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/sumitrust2019/submissions/28364331">提出コード</a></p> <h3 id="ddcc2020_予選_d_-_digit_sum_replace"><a href="#ddcc2020_予選_d_-_digit_sum_replace" class=header-anchor >DDCC2020 予選 D - Digit Sum Replace</a></h3> <p><a href="https://atcoder.jp/contests/ddcc2020-qual/tasks/ddcc2020_qual_d">問題</a> <a href="https://www.youtube.com/watch?v&#61;BssyLgQvdcY">公式解説</a></p> <p>公式解説補足</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span></span></span> が1桁になるまでに 9 を引く回数を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> とすると <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>s</mi><mo>−</mo><mn>9</mn><mi>x</mi><mo>≤</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">1 \leq s - 9x \leq 9</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >9</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >9</span></span></span></span> が成り立つ. よって</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mfrac><mrow><mi>s</mi><mo>−</mo><mn>9</mn></mrow><mn>9</mn></mfrac><mo>≤</mo><mi>x</mi><mo>≤</mo><mfrac><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow><mn>9</mn></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \frac{s-9}{9} \leq x \leq \frac{s-1}{9}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >9</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >9</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >9</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> を満たす整数 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>x</mi><mo>=</mo><mrow><mo fence=true >⌊</mo><mfrac><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow><mn>9</mn></mfrac><mo fence=true >⌋</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle x = \left\lfloor \frac{s-1}{9} \right\rfloor</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">⌊</span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >9</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">⌋</span></span></span></span></span></span>.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> m;
    cin &gt;&gt; m;
    <span class=hljs-function >vector&lt;ll&gt; <span class=hljs-title >d</span><span class=hljs-params >(m)</span>, <span class=hljs-title >c</span><span class=hljs-params >(m)</span></span>;
    <span class=hljs-built_in >rep</span>(i,m) cin &gt;&gt; d[i] &gt;&gt; c[i];
    ll keta = <span class=hljs-number >0</span>;
    ll sum = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep</span>(i,m) {
        keta += c[i];
        sum += d[i] * c[i];
    }

    cout &lt;&lt; keta - <span class=hljs-number >1</span> + (sum - <span class=hljs-number >1</span>) / <span class=hljs-number >9</span> &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/ddcc2020-qual/submissions/28365947">提出コード</a></p> <h3 id=tenka1_programmer_beginner_contest_d_-_crossing ><a href="#tenka1_programmer_beginner_contest_d_-_crossing" class=header-anchor >Tenka1 Programmer Beginner Contest D - Crossing</a></h3> <p><a href="https://atcoder.jp/contests/tenka1-2018-beginner/tasks/tenka1_2018_d">問題</a> <a href="https://atcoder.jp/contests/tenka1-2018-beginner/submissions/28366912">提出コード</a></p> <div class=page-foot > <div class=copyright > &copy; <a href=https://github.com/goropikari>goropikari</a>. Last modified: February 02, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. This site source is located at <a href=https://goropikari.github.io/CompetitiveProgramming>goropikari/CompetitiveProgramming</a> </div> </div> </div> </div>