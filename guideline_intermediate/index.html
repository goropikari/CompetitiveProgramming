<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/CompetitiveProgramming/libs/katex/katex.min.css"> <link rel=stylesheet  href="/CompetitiveProgramming/libs/highlight/github.min.css"> <link rel=stylesheet  href="/CompetitiveProgramming/css/franklin.css"> <link rel=stylesheet  href="/CompetitiveProgramming/css/poole_hyde.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <link rel=icon  href="/CompetitiveProgramming/assets/favicon.png"> <title>AtCoder上達のガイドライン 中級編</title> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <h1><a href="/CompetitiveProgramming/">競プロ メモ</a></h1> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/CompetitiveProgramming/">Home</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/algorithm/">Algorithm</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/atcoder/">AtCoder</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/abc/">ABC</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/arc/">ARC</a> </nav> <p>&copy; <a href=https://github.com/goropikari>goropikari</a>.</p> </div> </div> <div class="content container"> <div class=franklin-content > <h1 id="レッドコーダーが教える競プロatcoder上達のガイドライン中級編目指せ水色コーダー_掲載問題メモ"><a href="#レッドコーダーが教える競プロatcoder上達のガイドライン中級編目指せ水色コーダー_掲載問題メモ" class=header-anchor >『 レッドコーダーが教える、競プロ・AtCoder上達のガイドライン【中級編：目指せ水色コーダー！】 』掲載問題メモ</a></h1> <p><a href="https://qiita.com/e869120/items/eb50fdaece12be418faa">元記事</a></p> <div class=franklin-toc ><ol><li><a href="#dpl1b_0-1_ナップザック問題">DPL<em>1</em>B: 0-1 ナップザック問題</a><li><a href="#dpl1c_ナップザック問題">DPL<em>1</em>C ナップザック問題</a><li><a href="#dpl1a_コイン問題">DPL<em>1</em>A コイン問題</a><li><a href="#alds110c_最長共通部分列">ALDS1<em>10</em>C 最長共通部分列</a><li><a href="#joi_2011_予選_4_-_1_年生">JOI 2011 予選 4 - 1 年生</a><li><a href="#joi_2012_予選_4_-_パスタ">JOI 2012 予選 4 - パスタ</a><li><a href="#joi_2013_予選_4_-_暑い日々">JOI 2013 予選 4 - 暑い日々</a><li><a href="#joi_2015_予選_4_-_シルクロード">JOI 2015 予選 4 - シルクロード</a><li><a href="#パ研杯2019_d_-_パ研軍旗">パ研杯2019 D - パ研軍旗</a><li><a href="#aoj_1167_-_ポロック予想">AOJ 1167 - ポロック予想</a><li><a href="#aoj_2199_-_差分パルス符号変調">AOJ 2199 - 差分パルス符号変調</a><li><a href="#alds10b_-_連鎖行列積">ALDS<em>10</em>B - 連鎖行列積</a><li><a href="#joi_2015_本選_2_-_ケーキの切り分け_2">JOI 2015 本選 2 - ケーキの切り分け 2</a><li><a href="#aoj_1611_ダルマ落とし">AOJ 1611 ダルマ落とし</a></ol></div> <h2 id="dpl1b_0-1_ナップザック問題"><a href="#dpl1b_0-1_ナップザック問題" class=header-anchor >DPL<em>1</em>B: 0-1 ナップザック問題</a></h2> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/DPL_1_B">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目までの品物を使って重さの総和が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 以下のときの価値の最大値</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目の品物を使わなかったときと <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i-1][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span> と, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目の品物を使うとき <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mi>w</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i-1][j-w[i]]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]]</span></span></span></span> の大きい方を選ぶ.</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false >(</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo separator=true >,</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mi>w</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >]</mo><mo>+</mo><mi>v</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">dp[i][j] = \max(dp[i-1][j], dp[i-1][j-w[i]] + v[i])</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >max</span><span class=mopen >(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >])</span></span></span></span> <pre><code class="cpp hljs">vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >dp</span>(N+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(W+<span class=hljs-number >1</span>,<span class=hljs-number >0</span>));
<span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,N+<span class=hljs-number >1</span>) {
    <span class=hljs-built_in >rep</span>(j,W+<span class=hljs-number >1</span>) {
        <span class=hljs-keyword >if</span> (j-w[i] &gt;= <span class=hljs-number >0</span>) <span class=hljs-built_in >chmax</span>(dp[i][j], dp[i<span class=hljs-number >-1</span>][j-w[i]] + v[i]);
        <span class=hljs-built_in >chmax</span>(dp[i][j], dp[i<span class=hljs-number >-1</span>][j]);
    }
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/DPL_1_B/judge/6163387/C&#43;&#43;17">提出コード</a></p> <h2 id="dpl1c_ナップザック問題"><a href="#dpl1c_ナップザック問題" class=header-anchor >DPL<em>1</em>C ナップザック問題</a></h2> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/DPL_1_C">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>w</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[w]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mclose >]</span></span></span></span>: 重さが <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span> を以下のときの価値の最大値</p> <pre><code class="cpp hljs"><span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >dp</span><span class=hljs-params >(W+<span class=hljs-number >1</span>,<span class=hljs-number >0</span>)</span></span>;
<span class=hljs-built_in >rep</span>(j,W+<span class=hljs-number >1</span>) {
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,N+<span class=hljs-number >1</span>) {
        <span class=hljs-keyword >if</span> (j + w[i] &lt;= W) <span class=hljs-built_in >chmax</span>(dp[j+w[i]], dp[j]+v[i]);
    }
}
ans = dp[W];</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/DPL_1_C/judge/6163401/C&#43;&#43;14">提出コード</a></p> <h2 id="dpl1a_コイン問題"><a href="#dpl1a_コイン問題" class=header-anchor >DPL<em>1</em>A コイン問題</a></h2> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/DPL_1_A">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>n</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[n]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">n</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> 円払うときのコインの最小枚数</p> <p>0円払うとき必要なコインは 0 枚だから <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mn>0</mn><mo stretchy=false >]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">dp[0] = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class=mord >0</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>.</p> <pre><code class="cpp hljs"><span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >dp</span><span class=hljs-params >(n+<span class=hljs-number >1</span>, INF)</span></span>;
dp[<span class=hljs-number >0</span>] = <span class=hljs-number >0</span>;
<span class=hljs-built_in >rep</span>(i,n+<span class=hljs-number >1</span>) {
    <span class=hljs-built_in >rep</span>(j,m) {
        <span class=hljs-keyword >if</span> (i+coins[j] &lt;= n) <span class=hljs-built_in >chmin</span>(dp[i+coins[j]], dp[i] + <span class=hljs-number >1</span>);
    }
}
<span class=hljs-comment >// ans = dp[n];</span></code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/DPL_1_A/judge/6163410/C&#43;&#43;17">提出コード</a></p> <h2 id="alds110c_最長共通部分列"><a href="#alds110c_最長共通部分列" class=header-anchor >ALDS1<em>10</em>C 最長共通部分列</a></h2> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/ALDS1_10_C">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span>: 文字列 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 文字目, 文字列 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 文字目まで見たときの最長共通部分列</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><msub><mi>Y</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">X_i = Y_j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> のとき <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo>=</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">dp[i][j] = dp[i-1][j-1] + 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span></p> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo mathvariant=normal >≠</mo><msub><mi>Y</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">X_i \neq Y_j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class="mord vbox"><span class=thinbox ><span class=rlap ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class=mord ><span class=mrel ></span></span></span><span class=fix ></span></span></span></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> のとき, 文字列 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> の見ている文字を右に進めるか, 文字列 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> の見ている文字を右に進めるかの2択. よって <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i-1][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span> または <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][j-1]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span></span></span></span> のうちの大きい方 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false >(</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo separator=true >,</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">dp[i][j] = \max(dp[i-1][j], dp[i][j-1])</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >max</span><span class=mopen >(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >])</span></span></span></span>.</p> </ul> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >lcs</span><span class=hljs-params >(string s, string t)</span> </span>{
    <span class=hljs-type >int</span> lens = s.<span class=hljs-built_in >size</span>(), lent = t.<span class=hljs-built_in >size</span>();
    vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >dp</span>(lens+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(lent+<span class=hljs-number >1</span>, <span class=hljs-number >0</span>));
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,lens+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep2</span>(j,<span class=hljs-number >1</span>,lent+<span class=hljs-number >1</span>) {
            <span class=hljs-keyword >if</span> (s[i<span class=hljs-number >-1</span>] == t[j<span class=hljs-number >-1</span>]) dp[i][j] = dp[i<span class=hljs-number >-1</span>][j<span class=hljs-number >-1</span>] + <span class=hljs-number >1</span>;
            <span class=hljs-keyword >else</span> dp[i][j] = <span class=hljs-built_in >max</span>(dp[i<span class=hljs-number >-1</span>][j], dp[i][j<span class=hljs-number >-1</span>]);
        }
    }

    <span class=hljs-keyword >return</span> dp[lens][lent];
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/ALDS1_10_C/judge/6163429/C&#43;&#43;17">提出コード</a></p> <h2 id="joi_2011_予選_4_-_1_年生"><a href="#joi_2011_予選_4_-_1_年生" class=header-anchor >JOI 2011 予選 4 - 1 年生</a></h2> <p><a href="https://atcoder.jp/contests/joi2011yo/tasks/joi2011yo_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][x]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目までの数字を足し引きをして <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> となる場合の数 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 番目の数字を足し引きして <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> 番目の数字と同じになる場合の数が答え</p> <p>一番はじめの数は足す一択だから <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>a</mi><mo stretchy=false >[</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >]</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">dp[1][a[1]] = 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">a</span><span class=mopen >[</span><span class=mord >1</span><span class=mclose >]]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>.</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> が小さい方から決めていく.</p> <p>配る dp の場合</p> <pre><code class="cpp hljs"><span class=hljs-comment >// dp[i][x]: i 番目の数字を足し引きして x となる場合の数</span>
vector&lt;vector&lt;ll&gt;&gt; <span class=hljs-built_in >dp</span>(n+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;ll&gt;(<span class=hljs-number >21</span>,<span class=hljs-number >0</span>));
<span class=hljs-comment >// 1 番目の数は足す一択</span>
dp[<span class=hljs-number >1</span>][a[<span class=hljs-number >1</span>]] = <span class=hljs-number >1</span>;

<span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,n) {
    <span class=hljs-built_in >rep</span>(x,<span class=hljs-number >21</span>) {
        <span class=hljs-comment >// i 番目の数が x+a[i] となるのは dp[i-1] のとき x で i 番目の数字 a[i] を足したとき</span>
        <span class=hljs-keyword >if</span> (x+a[i] &lt;= <span class=hljs-number >20</span>) dp[i][x+a[i]] += dp[i<span class=hljs-number >-1</span>][x];

        <span class=hljs-comment >// i 番目の数が x-a[i] となるのは dp[i-1] のとき x で i 番目の数字 a[i] を引いたとき</span>
        <span class=hljs-keyword >if</span> (x-a[i] &gt;= <span class=hljs-number >0</span>) dp[i][x-a[i]] += dp[i<span class=hljs-number >-1</span>][x];
    }
}

<span class=hljs-comment >// n-1 番目の数を足し引きして, n 番目の数と一致する場合な数</span>
cout &lt;&lt; dp[n<span class=hljs-number >-1</span>][a[n]] &lt;&lt; endl;</code></pre> <p><a href="https://atcoder.jp/contests/joi2011yo/submissions/28253843">提出コード</a></p> <p>集める dp の場合</p> <pre><code class="cpp hljs"><span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,n) {
    <span class=hljs-built_in >rep</span>(x,<span class=hljs-number >21</span>) {
        <span class=hljs-comment >// i 番目の数字が x のなるのは i-1 の数字が x-a[i] で, i番目で a[i] を足したとき</span>
        <span class=hljs-keyword >if</span> (x-a[i] &gt;= <span class=hljs-number >0</span>) dp[i][x] += dp[i<span class=hljs-number >-1</span>][x-a[i]];

        <span class=hljs-comment >// i 番目の数字が x のなるのは i-1 の数字が x+a[i] で, i番目で a[i] を引いたとき</span>
        <span class=hljs-keyword >if</span> (x+a[i] &lt;= <span class=hljs-number >20</span>) dp[i][x] += dp[i<span class=hljs-number >-1</span>][x+a[i]];
    }
}</code></pre> <p><a href="https://atcoder.jp/contests/joi2011yo/submissions/28253965">提出コード</a></p> <h2 id="joi_2012_予選_4_-_パスタ"><a href="#joi_2012_予選_4_-_パスタ" class=header-anchor >JOI 2012 予選 4 - パスタ</a></h2> <p><a href="https://atcoder.jp/contests/joi2012yo/tasks/joi2012yo_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][x][y]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目にソース x を食べ, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> にソース y を食べたときの場合の数.</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 日目にソース x を食べたとき, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">i-2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span></span></span></span> 日目には x 以外のソースを食べる必要があるため <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo>=</mo><munder><mo>∑</mo><mrow><mi>k</mi><mo mathvariant=normal >≠</mo><mi>x</mi></mrow></munder><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>k</mi><mo stretchy=false >]</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[i][x][x] = \sum_{k \neq x} dp[i-1][x][k]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.488226em;vertical-align:-1.438221em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.050005em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class=fix ></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.0500049999999996em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.438221em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span></span></span></span></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 日目に食べるソースが違った場合は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">i-2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span></span></span></span> 日目に何を食べてもよいので <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo stretchy=false >]</mo><mo>=</mo><munder><mo>∑</mo><mi>k</mi></munder><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>k</mi><mo stretchy=false >]</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[i][x][y] = \sum_{k} dp[i-1][y][k]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.3521180000000004em;vertical-align:-1.3021129999999999em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000005em;"><span style="top:-1.847887em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.3021129999999999em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span></span></span></span></p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> N, K;
    cin &gt;&gt; N &gt;&gt; K;
    <span class=hljs-comment >// dp[i][x][y]: i日目にソース x を食べ, i-1 日目にはソース y を食べたときの場合の数</span>
    <span class=hljs-comment >// ソースの種類 1 &lt;= x, y &lt;= 3</span>
    <span class=hljs-comment >// y = 0 のときは食べなかったことを表す</span>
    <span class=hljs-type >int</span> dp[<span class=hljs-number >105</span>][<span class=hljs-number >4</span>][<span class=hljs-number >4</span>];
    <span class=hljs-built_in >rep</span>(i,<span class=hljs-number >105</span>) <span class=hljs-built_in >rep</span>(j,<span class=hljs-number >4</span>) <span class=hljs-built_in >rep</span>(k,<span class=hljs-number >4</span>) dp[i][j][k] = <span class=hljs-number >0</span>;

    map&lt;<span class=hljs-type >int</span>,<span class=hljs-type >int</span>&gt; mp;
    <span class=hljs-built_in >rep</span>(i,K) {
        <span class=hljs-type >int</span> a, b;
        cin &gt;&gt; a &gt;&gt; b;
        mp[a] = b;
    }

    <span class=hljs-type >const</span> <span class=hljs-type >int</span> MOD = <span class=hljs-number >10000</span>;
    <span class=hljs-keyword >if</span> (mp.<span class=hljs-built_in >find</span>(<span class=hljs-number >1</span>) != mp.<span class=hljs-built_in >end</span>()) {
        dp[<span class=hljs-number >1</span>][mp[<span class=hljs-number >1</span>]][<span class=hljs-number >0</span>] = <span class=hljs-number >1</span>;
    } <span class=hljs-keyword >else</span> {
        <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,<span class=hljs-number >4</span>) dp[<span class=hljs-number >1</span>][i][<span class=hljs-number >0</span>] = <span class=hljs-number >1</span>;
    }

    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,N+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep2</span>(x,<span class=hljs-number >1</span>,<span class=hljs-number >4</span>) {
            <span class=hljs-keyword >if</span> (mp.<span class=hljs-built_in >find</span>(i) != mp.<span class=hljs-built_in >end</span>()) {
                <span class=hljs-comment >// i 日目に食べるものが決まっていた場合は, それ以外の候補は除外する</span>
                <span class=hljs-keyword >if</span> (x != mp[i]) <span class=hljs-keyword >continue</span>;
            }
            <span class=hljs-built_in >rep</span>(y,<span class=hljs-number >4</span>) {
                <span class=hljs-keyword >if</span> (x == y) {
                    <span class=hljs-built_in >rep</span>(z,<span class=hljs-number >4</span>) {
                        <span class=hljs-comment >// i, i-1 日目にソース x を食べたとき, i-2 日目には x 以外のソースを食べる必要がある</span>
                        <span class=hljs-keyword >if</span> (z != x) {
                            dp[i][x][x] += dp[i<span class=hljs-number >-1</span>][x][z];
                            dp[i][x][x] %= MOD;
                        }
                    }
                } <span class=hljs-keyword >else</span> {
                    <span class=hljs-built_in >rep</span>(z,<span class=hljs-number >4</span>) {
                        dp[i][x][y] += dp[i<span class=hljs-number >-1</span>][y][z];
                        dp[i][x][y] %= MOD;
                    }
                }
            }
        }
    }


    ll ans = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,<span class=hljs-number >4</span>) <span class=hljs-built_in >rep2</span>(j,<span class=hljs-number >1</span>,<span class=hljs-number >4</span>) {
        ans += dp[N][i][j];
        ans %= MOD;
    }
    cout &lt;&lt; ans &lt;&lt; endl;</code></pre> <p><a href="https://atcoder.jp/contests/joi2012yo/submissions/28232419">提出コード</a></p> <h2 id="joi_2013_予選_4_-_暑い日々"><a href="#joi_2013_予選_4_-_暑い日々" class=header-anchor >JOI 2013 予選 4 - 暑い日々</a></h2> <p><a href="https://atcoder.jp/contests/joi2013yo/tasks/joi2013yo_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目に服 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> を着たときの <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi mathvariant=normal >∣</mi><msub><mi>C</mi><msub><mi>x</mi><mi>k</mi></msub></msub><mo>−</mo><msub><mi>C</mi><msub><mi>x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></msub><mi mathvariant=normal >∣</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \sum_{k=1}^{i-1} |C_{x_k} - C_{x_{k+1}}|</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3.1137820000000005em;vertical-align:-1.302113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8116690000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.302113em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >∣</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139199999999997em;"><span style="top:-2.55em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.25586em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.0475249999999998em;vertical-align:-0.29752499999999993em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139199999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.21074999999999994em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.29752499999999993em;"><span></span></span></span></span></span></span><span class=mord >∣</span></span></span></span> の最大値</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目に服 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> を着たときの最大値は, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 日目に服 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">1 \leq k \leq N</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>&#41;を着たときからの遷移だから</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo>=</mo><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mrow><mo fence=true >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>k</mi><mo stretchy=false >]</mo><mo>+</mo><mi mathvariant=normal >∣</mi><mi>C</mi><mo stretchy=false >[</mo><mi>k</mi><mo stretchy=false >]</mo><mo>−</mo><mi>C</mi><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mi mathvariant=normal >∣</mi><mo fence=true >}</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[i][j] = \max_{k} \left\{ dp[i-1][k] + |C[k] - C[j]| \right\}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.502108em;vertical-align:-0.752108em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.43055999999999994em;"><span style="top:-2.347892em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >max</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.752108em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mord >∣</span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span> <p>ただし, 最高気温に適した服のみ選ぶ.</p> <p>答えは <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> 日目に着ていた服のうち, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>D</mi><mo>−</mo><mn>1</mn></mrow></munderover><mi mathvariant=normal >∣</mi><msub><mi>C</mi><msub><mi>x</mi><mi>i</mi></msub></msub><mo>−</mo><msub><mi>C</mi><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></msub><mi mathvariant=normal >∣</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \sum_{i=1}^{D-1} |C_{x_i} - C_{x_{i+1}}|</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:3.1060050000000006em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.8283360000000004em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >∣</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139199999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2501em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.041765em;vertical-align:-0.291765em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32808571428571426em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.20252142857142857em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.291765em;"><span></span></span></span></span></span></span><span class=mord >∣</span></span></span></span> が最大となるもの.</p> <pre><code class="cpp hljs">vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >dp</span>(D+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(N+<span class=hljs-number >1</span>, <span class=hljs-number >0</span>));
<span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >2</span>,D+<span class=hljs-number >1</span>) {
    <span class=hljs-built_in >rep2</span>(j,<span class=hljs-number >1</span>,N+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep2</span>(k,<span class=hljs-number >1</span>,N+<span class=hljs-number >1</span>) {
            <span class=hljs-comment >// i 日目に j を, i-1 日目に k を着る</span>
            <span class=hljs-keyword >if</span> (A[j] &lt;= T[i] &amp;&amp; T[i] &lt;= B[j] &amp;&amp; A[k] &lt;= T[i<span class=hljs-number >-1</span>] &amp;&amp; T[i<span class=hljs-number >-1</span>] &lt;= B[k]) {
                <span class=hljs-built_in >chmax</span>(dp[i][j], dp[i<span class=hljs-number >-1</span>][k]+<span class=hljs-built_in >abs</span>(C[k]-C[j]));
            }
        }
    }
}

<span class=hljs-type >int</span> ans = <span class=hljs-number >0</span>;
<span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,N+<span class=hljs-number >1</span>) <span class=hljs-built_in >chmax</span>(ans, dp[D][i]);</code></pre> <p><a href="https://atcoder.jp/contests/joi2013yo/submissions/28234808">提出コード</a></p> <h2 id="joi_2015_予選_4_-_シルクロード"><a href="#joi_2015_予選_4_-_シルクロード" class=header-anchor >JOI 2015 予選 4 - シルクロード</a></h2> <p><a href="https://atcoder.jp/contests/joi2015yo/tasks/joi2015yo_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目に都市 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> にいるときの最小コスト</p> <p>0 日目に都市 0 にいるコストは 0, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mn>0</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mn>0</mn><mo stretchy=false >]</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">dp[0][0] = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class=mord >0</span><span class=mclose >]</span><span class=mopen >[</span><span class=mord >0</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>.</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目に都市 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> にいるときのコストは, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i-k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 日目に都市 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> にいて, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 日目に都市 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> に移動してきた, または, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 日目には都市 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> にいて, そのまま動かなかった場合のいずれか. そのうちの最小コストが <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span> となる.</p> <ul> <li><p>移動してくる: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mo stretchy=false >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mi>k</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo>+</mo><mi>c</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo>×</mo><mi>d</mi><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \min_k \{dp[i-k][j-1] + c[i] \times d[j]\}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.5021079999999998em;vertical-align:-0.7521079999999999em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.347892em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.7521079999999999em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]}</span></span></span></span></p> <li><p>移動しない: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i-1][j]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span></span></span></span></p> </ul> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo>=</mo><mi>min</mi><mo>⁡</mo><mrow><mo fence=true >(</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo separator=true >,</mo><mtext> </mtext><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mo stretchy=false >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo>−</mo><mi>k</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo>+</mo><mi>c</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo>×</mo><mi>d</mi><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo stretchy=false >}</mo><mo fence=true >)</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[i][j] = \min \left(dp[i-1][j],~ \min_k \{dp[i-k][j-1] + c[i] \times d[j]\} \right)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=mop >min</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mpunct >,</span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.347892em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.7521079999999999em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">c</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">d</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]}</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span> <p>答えは <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>m</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>n</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[m][n]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">m</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">n</span><span class=mclose >]</span></span></span></span>.</p> <pre><code class="cpp hljs">vector&lt;vector&lt;ll&gt;&gt; <span class=hljs-built_in >dp</span>(m+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;ll&gt;(n+<span class=hljs-number >1</span>, INF));

dp[<span class=hljs-number >0</span>][<span class=hljs-number >0</span>] = <span class=hljs-number >0</span>;
<span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,m+<span class=hljs-number >1</span>) {
    <span class=hljs-built_in >rep2</span>(j,<span class=hljs-number >1</span>,n+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep2</span>(k,<span class=hljs-number >1</span>,i+<span class=hljs-number >1</span>) {
            <span class=hljs-built_in >chmin</span>(dp[i][j], dp[i-k][j<span class=hljs-number >-1</span>] + c[i] * d[j]);
            <span class=hljs-built_in >chmin</span>(dp[i][j], dp[i<span class=hljs-number >-1</span>][j]);
        }
    }
}

cout &lt;&lt; dp[m][n] &lt;&lt; endl;</code></pre> <p><a href="https://atcoder.jp/contests/joi2015yo/submissions/28237554">提出コード</a></p> <h2 id="パ研杯2019_d_-_パ研軍旗"><a href="#パ研杯2019_d_-_パ研軍旗" class=header-anchor >パ研杯2019 D - パ研軍旗</a></h2> <p><a href="https://atcoder.jp/contests/pakencamp-2019-day3/tasks/pakencamp_2019_day3_d">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[j][x]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 列目の色を x で塗ったときの最小コスト</p> <p>2列連続で同じ色は使えないから, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[j][x]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span></span></span></span> は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 列目を色 y &#40;x &#33;&#61; y&#41; で塗ったときのコストと j 列目を x で塗るときのコストの和のうち最小となるもの.</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>j</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo>=</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>x</mi><mo mathvariant=normal >≠</mo><mi>y</mi></mrow></munder><mo stretchy=false >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>y</mi><mo stretchy=false >]</mo><mo>+</mo><mo stretchy=false >(</mo><mtext># of not x at j th column</mtext><mo stretchy=false >)</mo><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[j][x] = \min_{x \neq y} \{ dp[j-1][y] + (\text{\# of not x at j th column}) \}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.638216em;vertical-align:-0.8882159999999999em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.3478920000000003em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class=fix ></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.8882159999999999em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord text"><span class=mord ># of not x at j th column</span></span><span class=mclose >)}</span></span></span></span> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-type >int</span> nrow = <span class=hljs-number >5</span>;
    vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >flag</span>(nrow, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(n+<span class=hljs-number >1</span>,<span class=hljs-number >0</span>));
    <span class=hljs-built_in >rep</span>(i,nrow) {
        <span class=hljs-built_in >rep</span>(j,n) {
            <span class=hljs-type >char</span> c;
            cin &gt;&gt; c;
            <span class=hljs-keyword >if</span> (c == <span class=hljs-string >&#x27;R&#x27;</span>) flag[i][j+<span class=hljs-number >1</span>] = <span class=hljs-number >0</span>;
            <span class=hljs-keyword >if</span> (c == <span class=hljs-string >&#x27;B&#x27;</span>) flag[i][j+<span class=hljs-number >1</span>] = <span class=hljs-number >1</span>;
            <span class=hljs-keyword >if</span> (c == <span class=hljs-string >&#x27;W&#x27;</span>) flag[i][j+<span class=hljs-number >1</span>] = <span class=hljs-number >2</span>;
            <span class=hljs-keyword >if</span> (c == <span class=hljs-string >&#x27;#&#x27;</span>) flag[i][j+<span class=hljs-number >1</span>] = <span class=hljs-number >3</span>;
        }
    }

    <span class=hljs-comment >// dp[j][x]: j-1 列目までの色は確定しており, j 列目を色 x で塗ったときの最小コスト</span>
    vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >dp</span>(n+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(<span class=hljs-number >3</span>, INF));
    <span class=hljs-built_in >rep</span>(x,<span class=hljs-number >3</span>) dp[<span class=hljs-number >0</span>][x] = <span class=hljs-number >0</span>;

    <span class=hljs-built_in >rep2</span>(j,<span class=hljs-number >1</span>,n+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep</span>(x,<span class=hljs-number >3</span>) {
            <span class=hljs-type >int</span> numnotx = <span class=hljs-number >0</span>;
            <span class=hljs-built_in >rep</span>(i,nrow) {
                numnotx += flag[i][j] != x;
            }

            <span class=hljs-built_in >rep</span>(y,<span class=hljs-number >3</span>) {
                <span class=hljs-keyword >if</span> (x == y) <span class=hljs-keyword >continue</span>;
                <span class=hljs-built_in >chmin</span>(dp[j][x], dp[j<span class=hljs-number >-1</span>][y] + numnotx);
            }
        }
    }

    <span class=hljs-type >int</span> ans = INF;
    <span class=hljs-built_in >rep</span>(x,<span class=hljs-number >3</span>) <span class=hljs-built_in >chmin</span>(ans, dp[n][x]);
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/pakencamp-2019-day3/submissions/28253637">提出コード</a></p> <h2 id="aoj_1167_-_ポロック予想"><a href="#aoj_1167_-_ポロック予想" class=header-anchor >AOJ 1167 - ポロック予想</a></h2> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/1167">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[x]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span></span></span></span>: x を表すのに必要な正四面体数の個数の最小値</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo><mo>=</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>i</mi></munder><mo stretchy=false >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>x</mi><mo>−</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=false >]</mo><mo>+</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=false >]</mo><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle dp[x] = \min_{i}\{ dp[x-s_i] + dp[s_i] \}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.4776639999999999em;vertical-align:-0.727664em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.372336em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.727664em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >]}</span></span></span></span> ここで <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">s_i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> 番目の正四面体数.</p> <p>x が小さいところから順に確定させていく</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-comment >// sq[i]: i 番目の正四面体数</span>
    vector&lt;<span class=hljs-type >int</span>&gt; sq;
    <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> n = <span class=hljs-number >1</span>; n*(n+<span class=hljs-number >1</span>)*(n+<span class=hljs-number >2</span>)/<span class=hljs-number >6</span> &lt;= (<span class=hljs-type >int</span>)<span class=hljs-number >1e6</span>; n++) {
        sq.<span class=hljs-built_in >push_back</span>(n*(n+<span class=hljs-number >1</span>)*(n+<span class=hljs-number >2</span>)/<span class=hljs-number >6</span>);
    }

    <span class=hljs-comment >// dp[x]: x を表すのに必要な正四面体数の個数の最小値</span>
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >dp</span><span class=hljs-params >((<span class=hljs-type >int</span>)<span class=hljs-number >1e6</span>+<span class=hljs-number >5</span>, INF)</span></span>;
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >odddp</span><span class=hljs-params >((<span class=hljs-type >int</span>)<span class=hljs-number >1e6</span>+<span class=hljs-number >5</span>, INF)</span></span>;
    <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> x : sq) {
        dp[x] = <span class=hljs-number >1</span>;
        <span class=hljs-keyword >if</span> (x&amp;<span class=hljs-number >1</span>) odddp[x] = <span class=hljs-number >1</span>;
    }

    <span class=hljs-built_in >rep</span>(x,(<span class=hljs-type >int</span>)<span class=hljs-number >1e6</span>+<span class=hljs-number >1</span>) {
        <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> s : sq) {
            <span class=hljs-keyword >if</span> (x - s &gt;= <span class=hljs-number >0</span>) {
                <span class=hljs-built_in >chmin</span>(dp[x], dp[x-s] + dp[s]);
                <span class=hljs-keyword >if</span> (s&amp;<span class=hljs-number >1</span>) <span class=hljs-built_in >chmin</span>(odddp[x], odddp[x-s] + odddp[s]);
            }
        }
    }

    <span class=hljs-keyword >while</span> (<span class=hljs-number >1</span>) {
        <span class=hljs-type >int</span> x;
        cin &gt;&gt; x;
        <span class=hljs-keyword >if</span> (x == <span class=hljs-number >0</span>) <span class=hljs-keyword >return</span>;
        cout &lt;&lt; dp[x] &lt;&lt; <span class=hljs-string >&quot; &quot;</span> &lt;&lt; odddp[x] &lt;&lt; endl;
    }
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/1167/judge/6165707/C&#43;&#43;17">提出コード</a></p> <h2 id="aoj_2199_-_差分パルス符号変調"><a href="#aoj_2199_-_差分パルス符号変調" class=header-anchor >AOJ 2199 - 差分パルス符号変調</a></h2> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/2199">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>i</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>x</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">dp[i][x]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">i</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal">x</span><span class=mclose >]</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y_i = x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> となるときの考えうる二乗和のうちの最小値</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>C</mi><mo stretchy=false >[</mo><mi>l</mi><mo stretchy=false >]</mo><mo>&gt;</mo><mn>255</mn></mrow><annotation encoding="application/x-tex">y_{i-1} + C[l] &gt; 255</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.791661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >255</span></span></span></span> のとき <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>255</mn></mrow><annotation encoding="application/x-tex">y_i = 255</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >255</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>C</mi><mo stretchy=false >[</mo><mi>l</mi><mo stretchy=false >]</mo><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y_{i-1} + C[l] &lt; 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.791661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mclose >]</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> のとき <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y_i = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> になるので配る dp で書くと楽そう</p> <p>答えは <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi>k</mi></munder><mo stretchy=false >{</mo><mi>d</mi><mi>p</mi><mo stretchy=false >[</mo><mi>n</mi><mo stretchy=false >]</mo><mo stretchy=false >[</mo><mi>k</mi><mo stretchy=false >]</mo><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \min_k \{ dp[n][k] \}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.5021079999999998em;vertical-align:-0.7521079999999999em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.347892em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.7521079999999999em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class=mopen >[</span><span class="mord mathnormal">n</span><span class=mclose >]</span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >]}</span></span></span></span>.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >(<span class=hljs-type >int</span> n, <span class=hljs-type >int</span> m)</span> </span>{
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >C</span><span class=hljs-params >(m+<span class=hljs-number >1</span>)</span>, <span class=hljs-title >x</span><span class=hljs-params >(n+<span class=hljs-number >1</span>)</span></span>;
    <span class=hljs-built_in >rep</span>(i,m) cin &gt;&gt; C[i+<span class=hljs-number >1</span>];
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; x[i+<span class=hljs-number >1</span>];

    <span class=hljs-comment >// dp[i][x]: y_i が x だったときの二乗和の最小値</span>
    vector&lt;vector&lt;<span class=hljs-type >int</span>&gt;&gt; <span class=hljs-built_in >dp</span>(n+<span class=hljs-number >1</span>, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(<span class=hljs-number >256</span>,INF));
    dp[<span class=hljs-number >0</span>][<span class=hljs-number >128</span>] = <span class=hljs-number >0</span>;

    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,n+<span class=hljs-number >1</span>) {
        <span class=hljs-built_in >rep</span>(k,<span class=hljs-number >256</span>) {
            <span class=hljs-built_in >rep2</span>(j,<span class=hljs-number >1</span>,m+<span class=hljs-number >1</span>) {
                <span class=hljs-type >int</span> s = k + C[j];
                <span class=hljs-keyword >if</span> (s &gt; <span class=hljs-number >255</span>) s = <span class=hljs-number >255</span>;
                <span class=hljs-keyword >if</span> (s &lt; <span class=hljs-number >0</span>) s = <span class=hljs-number >0</span>;
                <span class=hljs-built_in >chmin</span>(dp[i][s], dp[i<span class=hljs-number >-1</span>][k] + (s-x[i])*(s-x[i]));
            }
        }
    }

    <span class=hljs-type >int</span> ans = INF;
    <span class=hljs-built_in >rep</span>(i,<span class=hljs-number >256</span>) <span class=hljs-built_in >chmin</span>(ans, dp[n][i]);
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/2199/judge/6166950/C&#43;&#43;17">提出コード</a></p> <h2 id="alds10b_-_連鎖行列積"><a href="#alds10b_-_連鎖行列積" class=header-anchor >ALDS<em>10</em>B - 連鎖行列積</a></h2> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/ALDS1_10_B">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">f(l,r)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span></span></span></span> を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>l</mi></msub><msub><mi>M</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>⋯</mo><msub><mi>M</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">M_l M_{l+1} \cdots M_r</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.891661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> のスカラー乗算の回数が最小値とする。</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mi>f</mi><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo><mo>=</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>k</mi><mo>∈</mo><mo stretchy=false >[</mo><mn>0</mn><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo><mo separator=true >,</mo><mi>k</mi><mo>∈</mo><mi mathvariant=double-struck >Z</mi></mrow></munder><mo stretchy=false >{</mo><mi>f</mi><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>k</mi><mo stretchy=false >)</mo><mo>+</mo><mi>f</mi><mo stretchy=false >(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo><mo>+</mo><mo stretchy=false >(</mo><mtext># of row of </mtext><msub><mi>M</mi><mi>l</mi></msub><mo stretchy=false >)</mo><mo>×</mo><mo stretchy=false >(</mo><mtext># of column of </mtext><msub><mi>M</mi><mi>k</mi></msub><mo stretchy=false >)</mo><mo>×</mo><mo stretchy=false >(</mo><mtext># of column of </mtext><msub><mi>M</mi><mi>r</mi></msub><mo stretchy=false >)</mo><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle f(l, r) = \min_{k \in [0, r), k \in \mathbb Z} \{ f(l,k) + f(k+1, r) + (\text{\# of row of } M_l) \times (\text{\# of column of } M_k) \times (\text{\# of column of } M_r) \}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.716em;vertical-align:-0.966em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.3089999999999997em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">∈</span><span class="mopen mtight">[</span><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mclose mtight">)</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">∈</span><span class="mord mathbb mtight">Z</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.966em;"><span></span></span></span></span></span><span class=mopen >{</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord text"><span class=mord ># of row of </span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord text"><span class=mord ># of column of </span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord text"><span class=mord ># of column of </span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)}</span></span></span></span> となる。</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >dfs</span><span class=hljs-params >(<span class=hljs-type >int</span> l, <span class=hljs-type >int</span> r)</span> </span>{
    <span class=hljs-keyword >if</span> (l &lt; <span class=hljs-number >0</span> || r &gt;= n) <span class=hljs-keyword >return</span> INF;
    <span class=hljs-keyword >if</span> (visited[l][r]) <span class=hljs-keyword >return</span> dp[l][r];
    visited[l][r] = <span class=hljs-number >1</span>;

    <span class=hljs-built_in >rep2</span>(k,l,r) {
        <span class=hljs-built_in >chmin</span>(dp[l][r], <span class=hljs-built_in >dfs</span>(l,k) + <span class=hljs-built_in >dfs</span>(k+<span class=hljs-number >1</span>,r) + mats[l].first * mats[k].second * mats[r].second);
    }

    <span class=hljs-keyword >return</span> dp[l][r];
}


<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    cin &gt;&gt; n;
    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-type >int</span> a, b;
        cin &gt;&gt; a &gt;&gt; b;
        mats.<span class=hljs-built_in >push_back</span>({a,b});
    }

    <span class=hljs-comment >// dp[l][r]: [l, r] の範囲の連鎖行列のスカラー乗算回数の最小値</span>
    dp.<span class=hljs-built_in >resize</span>(n, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(n, INF));
    visited.<span class=hljs-built_in >resize</span>(n, <span class=hljs-built_in >vector</span>&lt;<span class=hljs-type >int</span>&gt;(n, <span class=hljs-number >0</span>));
    <span class=hljs-built_in >rep</span>(i,n) {
        dp[i][i] = <span class=hljs-number >0</span>;
        visited[i][i] = <span class=hljs-number >1</span>;
    }

    cout &lt;&lt; <span class=hljs-built_in >dfs</span>(<span class=hljs-number >0</span>, n<span class=hljs-number >-1</span>) &lt;&lt; endl;
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/ALDS1_10_B/judge/6167331/C&#43;&#43;17">提出コード</a></p> <h2 id="joi_2015_本選_2_-_ケーキの切り分け_2"><a href="#joi_2015_本選_2_-_ケーキの切り分け_2" class=header-anchor >JOI 2015 本選 2 - ケーキの切り分け 2</a></h2> <p><a href="https://atcoder.jp/contests/joi2015ho/tasks/joi2015ho_b">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo separator=true >,</mo><mi>f</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">calc(s, f)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mclose >)</span></span></span></span>: JOI の番が終わった状態で、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">A_s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">A_f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> が端として残っているときから操作をすることで JOI が獲得できるスコアの最大値とする。&#40;すでに食べられた部分のことは考えない&#41;</p> <p>次のターンで IOI は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">A_s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> と <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">A_f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> のうち大きい方を食べる。</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub><mo>&gt;</mo><msub><mi>A</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">A_s &gt; A_f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> のとき</p> </ul> <p>IOI が <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">A_s</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> を食べ、次のターンに JOI は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">A_{s-1}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.891661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> または <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">A_f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> を食べる。 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">A_{s-1}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.891661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> を食べたときの得点は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo>−</mo><mn>2</mn><mo separator=true >,</mo><mi>f</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">A_{s-1} + calc(s-2, f)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.891661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mclose >)</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">A_f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> を食べたときの得点は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>f</mi></msub><mo>+</mo><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo separator=true >,</mo><mi>f</mi><mo>+</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">A_f + calc(s-1, f+1)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span></span>. この2通りのうち大きいほうが <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo separator=true >,</mo><mi>f</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">calc(s, f)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mclose >)</span></span></span></span> となるので</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo separator=true >,</mo><mi>f</mi><mo stretchy=false >)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false >(</mo><msub><mi>A</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo>−</mo><mn>2</mn><mo separator=true >,</mo><mi>f</mi><mo stretchy=false >)</mo><mo separator=true >,</mo><msub><mi>A</mi><mi>f</mi></msub><mo>+</mo><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo separator=true >,</mo><mi>f</mi><mo>+</mo><mn>1</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">calc(s, f) = \max(A_{s-1} + calc(s-2, f), A_f + calc(s-1, f+1))</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >max</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class=mord >2</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mclose >)</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >))</span></span></span></span>.</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>s</mi></msub><mo>&lt;</mo><msub><mi>A</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">A_s &lt; A_f</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> のとき</p> </ul> <p>同様にして</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo separator=true >,</mo><mi>f</mi><mo stretchy=false >)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=false >(</mo><msub><mi>A</mi><mi>s</mi></msub><mo>+</mo><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo>−</mo><mn>1</mn><mo separator=true >,</mo><mi>f</mi><mo>+</mo><mn>1</mn><mo stretchy=false >)</mo><mo separator=true >,</mo><msub><mi>A</mi><mrow><mi>f</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>c</mi><mi>a</mi><mi>l</mi><mi>c</mi><mo stretchy=false >(</mo><mi>s</mi><mo separator=true >,</mo><mi>f</mi><mo>+</mo><mn>2</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">calc(s, f) = \max(A_s + calc(s-1, f+1), A_{f+1} + calc(s, f+2))</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >max</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class=mopen >(</span><span class="mord mathnormal">s</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >2</span><span class=mclose >))</span></span></span></span>.</p> <p>あとは JOI がピースのどの部分から食べるかを全探索することで答えを得られる。</p> <pre><code class="cpp hljs"><span class=hljs-type >int</span> n;
vector&lt;vector&lt;ll&gt;&gt; dp, visited;
vector&lt;ll&gt; A;

<span class=hljs-comment >// calc(s, f): JOI の番が終わった段階で A_s と A_f が端として残っているとき、</span>
<span class=hljs-comment >//             JOI が獲得できる最大のスコア</span>
<span class=hljs-comment >// s+1, ..., f-1 (mod n) の範囲がすでに食べられている</span>
<span class=hljs-function >ll <span class=hljs-title >calc</span><span class=hljs-params >(<span class=hljs-type >int</span> s, <span class=hljs-type >int</span> f)</span> </span>{
    <span class=hljs-keyword >if</span> (s == f) <span class=hljs-keyword >return</span> <span class=hljs-number >0</span>; <span class=hljs-comment >// 残りが1つのときは JOI に得点は入らない</span>
    <span class=hljs-keyword >if</span> (s == (f+<span class=hljs-number >1</span>)%n) <span class=hljs-keyword >return</span> <span class=hljs-built_in >min</span>(A[s], A[f]); <span class=hljs-comment >// 残り2つのとき小さいほうが JOI の得点</span>
    <span class=hljs-keyword >if</span> (visited[s][f]) <span class=hljs-keyword >return</span> dp[s][f];
    visited[s][f] = <span class=hljs-number >1</span>;

    <span class=hljs-comment >// JOI の番が終わった状態で A[s], A[f] が残っているとき、IOI は A[s] または A[f] の</span>
    <span class=hljs-comment >// 大きい方を食べる</span>
    <span class=hljs-keyword >if</span> (A[s] &gt; A[f]) {
        <span class=hljs-comment >// IOI が A[s] をたべる</span>
        <span class=hljs-comment >// IOI のあとに JOI は A[s-1] または A[f] を食べる。</span>
        <span class=hljs-keyword >return</span> dp[s][f] = <span class=hljs-built_in >max</span>(
            <span class=hljs-built_in >calc</span>((s<span class=hljs-number >-2</span>+n)%n, f) + A[(s<span class=hljs-number >-1</span>+n)%n], <span class=hljs-comment >// JOI が A[s-1] を食べる</span>
            <span class=hljs-built_in >calc</span>((s<span class=hljs-number >-1</span>+n)%n, (f+<span class=hljs-number >1</span>)%n) + A[f]    <span class=hljs-comment >// JOI が A[f] を食べる</span>
        );
    }
    <span class=hljs-keyword >return</span> dp[s][f] = <span class=hljs-built_in >max</span>(
        <span class=hljs-built_in >calc</span>((s<span class=hljs-number >-1</span>+n)%n, (f+<span class=hljs-number >1</span>)%n) + A[s], <span class=hljs-comment >// JOI が A[s] を食べる</span>
        <span class=hljs-built_in >calc</span>(s, (f+<span class=hljs-number >2</span>)%n) + A[(f+<span class=hljs-number >1</span>)%n]    <span class=hljs-comment >// JOI が A[f+1] を食べる</span>
    );
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    cin &gt;&gt; n;
    dp.<span class=hljs-built_in >resize</span>(n, <span class=hljs-built_in >vector</span>&lt;ll&gt;(n, <span class=hljs-number >0</span>));
    visited.<span class=hljs-built_in >resize</span>(n, <span class=hljs-built_in >vector</span>&lt;ll&gt;(n, <span class=hljs-number >0</span>));
    A.<span class=hljs-built_in >resize</span>(n);
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; A[i];

    ll ans = <span class=hljs-number >0</span>;
    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-type >int</span> s = (i - <span class=hljs-number >1</span> + n) % n;
        <span class=hljs-type >int</span> f = (i + <span class=hljs-number >1</span>) % n;
        <span class=hljs-built_in >chmax</span>(ans, A[i] + <span class=hljs-built_in >calc</span>(s,f));
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}</code></pre> <p><a href="https://atcoder.jp/contests/joi2015ho/submissions/28264730">提出コード</a></p> <h2 id="aoj_1611_ダルマ落とし"><a href="#aoj_1611_ダルマ落とし" class=header-anchor >AOJ 1611 ダルマ落とし</a></h2> <p><a href="https://onlinejudge.u-aizu.ac.jp/problems/1611">問題</a></p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\mathrm{dfs}(l, r)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span></span></span></span>: <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[l, r]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >]</span></span></span></span> の区間のブロックを落とせる最大値とする</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo>=</mo><mi>l</mi><mo>−</mo><mi>r</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mathrm{dfs}(l+1, r-1) = l-r-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> のとき</p> </ul> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[l+1, r-1]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >]</span></span></span></span> の範囲のブロックをすべて落とせるということだから</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo><mo>=</mo><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo>+</mo><mo stretchy=false >(</mo><mi mathvariant=normal >∣</mi><msub><mi>w</mi><mi>l</mi></msub><mo>−</mo><msub><mi>w</mi><mi>r</mi></msub><mi mathvariant=normal >∣</mi><mo>≤</mo><mn>1</mn><mo stretchy=false >)</mo><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\mathrm{dfs}(l, r) = \mathrm{dfs}(l+1, r-1) + (|w_l - w_r| \leq 1) \times 2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >∣</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >∣</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >2</span></span></span></span> <ul> <li><p>適当な <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>∈</mo><mo stretchy=false >[</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">k \in [l, r]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >]</span></span></span></span> で上下を分離して考えたとき</p> </ul> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo><mo>=</mo><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mrow><mi>k</mi><mo>∈</mo><mo stretchy=false >[</mo><mi>l</mi><mo separator=true >,</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo stretchy=false >]</mo></mrow></munder><mo stretchy=false >{</mo><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo separator=true >,</mo><mi>k</mi><mo stretchy=false >)</mo><mo>+</mo><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>r</mi><mo stretchy=false >)</mo><mo stretchy=false >}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \mathrm{dfs}(l, r) = \min_{k \in [l,r-1]} \{ \mathrm{dfs}(l, k) + \mathrm{dfs}(k+1, r) \}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.716em;vertical-align:-0.966em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-2.3089999999999997em;margin-left:0em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">∈</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span><span class=mop >min</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.966em;"><span></span></span></span></span></span><span class=mopen >{</span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mclose >)}</span></span></span></span> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> 番目のブロックが <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∣</mi><msub><mi>w</mi><mi>k</mi></msub><mo>−</mo><msub><mi>w</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mi mathvariant=normal >∣</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|w_k - w_{k+1}| \leq 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >∣</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mord >∣</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> を満たしていてもそれをここで考慮する必要はない。 なぜなら, そのようなケースの場合は <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >s</mi></mrow><mo stretchy=false >(</mo><mi>l</mi><mo>+</mo><mn>1</mn><mo separator=true >,</mo><mi>r</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo><mo>=</mo><mi>l</mi><mo>−</mo><mi>r</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mathrm{dfs}(l+1, r-1) = l-r-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">dfs</span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> のときの条件ですでに考慮されているため。</p> <pre><code class="cpp hljs"><span class=hljs-type >int</span> n;
<span class=hljs-type >const</span> <span class=hljs-type >int</span> MAX = <span class=hljs-number >305</span>;
<span class=hljs-type >int</span> w[MAX], dp[MAX][MAX], visited[MAX][MAX];

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >init</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-built_in >rep</span>(i,n) cin &gt;&gt; w[i];
    <span class=hljs-built_in >rep</span>(i,MAX) <span class=hljs-built_in >rep</span>(j,MAX) dp[i][j] = visited[i][j] = <span class=hljs-number >0</span>;
}

<span class=hljs-comment >// dfs(l, r): [l, r] の範囲で落とせる最大の数</span>
<span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >dfs</span><span class=hljs-params >(<span class=hljs-type >int</span> l, <span class=hljs-type >int</span> r)</span> </span>{
    <span class=hljs-keyword >if</span> (l &gt;= r) <span class=hljs-keyword >return</span> <span class=hljs-number >0</span>;
    <span class=hljs-keyword >if</span> (visited[l][r]) <span class=hljs-keyword >return</span> dp[l][r];
    visited[l][r] = <span class=hljs-number >1</span>;

    <span class=hljs-keyword >if</span> (<span class=hljs-built_in >dfs</span>(l+<span class=hljs-number >1</span>, r<span class=hljs-number >-1</span>) == r-l<span class=hljs-number >-1</span>) {
        <span class=hljs-built_in >chmax</span>(dp[l][r], <span class=hljs-built_in >dfs</span>(l+<span class=hljs-number >1</span>, r<span class=hljs-number >-1</span>) + (<span class=hljs-built_in >abs</span>(w[l] - w[r]) &lt;= <span class=hljs-number >1</span>) * <span class=hljs-number >2</span>);
    }
    <span class=hljs-built_in >rep2</span>(k,l,r) {
        <span class=hljs-built_in >chmax</span>(dp[l][r], <span class=hljs-built_in >dfs</span>(l, k) + <span class=hljs-built_in >dfs</span>(k+<span class=hljs-number >1</span>, r));
    }

    <span class=hljs-keyword >return</span> dp[l][r];
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-built_in >init</span>();
    cout &lt;&lt; <span class=hljs-built_in >dfs</span>(<span class=hljs-number >0</span>, n<span class=hljs-number >-1</span>) &lt;&lt; endl;
}</code></pre> <p><a href="https://onlinejudge.u-aizu.ac.jp/status/users/goropikari/submissions/1/1611/judge/6167977/C&#43;&#43;17">提出コード</a></p> <div class=page-foot > <div class=copyright > &copy; <a href=https://github.com/goropikari>goropikari</a>. Last modified: December 31, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. This site source is located at <a href=https://goropikari.github.io/CompetitiveProgramming>goropikari/CompetitiveProgramming</a> </div> </div> </div> </div>