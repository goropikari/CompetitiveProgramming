<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/CompetitiveProgramming/libs/katex/katex.min.css"> <link rel=stylesheet  href="/CompetitiveProgramming/libs/highlight/github.min.css"> <link rel=stylesheet  href="/CompetitiveProgramming/css/franklin.css"> <link rel=stylesheet  href="/CompetitiveProgramming/css/poole_hyde.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } .result-title a { text-decoration: none; } .result-title a:hover { text-decoration: underline; } .result-preview { color: #808080; } .resultCount { color: #808080; } .result-query { font-weight: bold; } #lunrSearchForm { margin-top: 1em; } </style> <link rel=icon  href="/CompetitiveProgramming/assets/favicon.png"> <title>Algorithm</title> <script src="/CompetitiveProgramming/libs/lunr/lunr.min.js"></script> <script src="/CompetitiveProgramming/libs/lunr/lunr_index.js"></script> <script src="/CompetitiveProgramming/libs/lunr/lunrclient.min.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112840751-3"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-112840751-3'); </script> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <h1><a href="/CompetitiveProgramming/">競プロ メモ</a></h1> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/CompetitiveProgramming/">Home</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/algorithm/">Algorithm</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/atcoder/">AtCoder</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/abc/">ABC</a> <a class="sidebar-nav-item " href="/CompetitiveProgramming/tag/arc/">ARC</a> <form id=lunrSearchForm  name=lunrSearchForm > <input class=search-input  name=q  placeholder="Enter search term" type=text > <input type=submit  value=Search  formaction="/CompetitiveProgramming/src/search"> </form> </nav> <p>&copy; <a href=https://github.com/goropikari>goropikari</a>.</p> </div> </div> <div class="content container"> <div class=franklin-content > <h1 id=algorithm ><a href="#algorithm" class=header-anchor >Algorithm</a></h1> <div class=franklin-toc ><ol><li><a href="#int_-_string">int &lt;-&gt; string</a><li><a href="#priority_queue">priority queue</a><li><a href="#sort">sort</a><li><a href="#ceil_floor">ceil, floor</a><li><a href="#gcd_lcm">gcd, lcm</a><li><a href="#cumsum">cumsum</a><li><a href="#高速べき乗計算">高速べき乗計算</a><li><a href="#素数">素数</a><ol><li><a href="#エラトステネスのふるい">エラトステネスのふるい</a></ol><li><a href="#逆元">逆元</a><ol><li><a href="#exponential_mod">exponential mod</a></ol><li><a href="#行列操作">行列操作</a><ol><li><a href="#rotr90">rotr90</a><li><a href="#rotl90">rotl90</a><li><a href="#transpose">transpose</a><li><a href="#上下反転">上下反転</a><li><a href="#左右反転">左右反転</a></ol><li><a href="#最長増加部分列_lis_longest_increasing_subsequence">最長増加部分列 &#40;LIS: Longest Increasing Subsequence&#41;</a><li><a href="#最短経路">最短経路</a><ol><li><a href="#ダイクストラ法_dijkstra">ダイクストラ法 &#40;Dijkstra&#41;</a></ol><li><a href="#最小全域木minimum_spanning_tree">最小全域木&#40;minimum spanning tree&#41;</a><ol><li><a href="#プリム法">プリム法</a><li><a href="#クラスカル法">クラスカル法</a></ol></ol></div> <h2 id=int_-_string ><a href="#int_-_string" class=header-anchor >int &lt;-&gt; string</a></h2> <pre><code class="cpp hljs"><span class=hljs-built_in >to_string</span>(<span class=hljs-type >int</span>) -&gt; <span class=hljs-function >string
<span class=hljs-title >to_string</span><span class=hljs-params >(ll)</span> -&gt; string
<span class=hljs-title >stoi</span><span class=hljs-params >(string)</span> -&gt; <span class=hljs-type >int</span>
<span class=hljs-title >stoll</span><span class=hljs-params >(string)</span> -&gt; ll</span></code></pre> <h2 id=priority_queue ><a href="#priority_queue" class=header-anchor >priority queue</a></h2> <p>昇順</p> <pre><code class="cpp hljs"><span class=hljs-meta >#<span class=hljs-keyword >include</span> <span class=hljs-string >&lt;iostream&gt;</span></span>
<span class=hljs-meta >#<span class=hljs-keyword >include</span> <span class=hljs-string >&lt;queue&gt;</span></span>

<span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >main</span><span class=hljs-params >()</span>
</span>{
  <span class=hljs-comment >// intを要素に持つ優先順位付きキュー.</span>
  <span class=hljs-comment >// 降順に処理する</span>
  std::priority_queue&lt;<span class=hljs-type >int</span>&gt; que;

  <span class=hljs-comment >// データを追加する</span>
  que.<span class=hljs-built_in >push</span>(<span class=hljs-number >3</span>);
  que.<span class=hljs-built_in >push</span>(<span class=hljs-number >1</span>);
  que.<span class=hljs-built_in >push</span>(<span class=hljs-number >4</span>);

  <span class=hljs-comment >// 処理順に出力する</span>
  <span class=hljs-keyword >while</span> (!que.<span class=hljs-built_in >empty</span>()) {
    std::cout &lt;&lt; que.<span class=hljs-built_in >top</span>() &lt;&lt; std::endl;
    que.<span class=hljs-built_in >pop</span>();
  }
}</code></pre> <pre><code class="julia hljs"><span class=hljs-number >4</span>
<span class=hljs-number >3</span>
<span class=hljs-number >1</span></code></pre> <p>降順に出力</p> <pre><code class="cpp hljs"><span class=hljs-meta >#<span class=hljs-keyword >include</span> <span class=hljs-string >&lt;iostream&gt;</span></span>
<span class=hljs-meta >#<span class=hljs-keyword >include</span> <span class=hljs-string >&lt;queue&gt;</span></span>

<span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >main</span><span class=hljs-params >()</span>
</span>{
  <span class=hljs-comment >// intを要素に持つ優先順位付きキュー.</span>
  <span class=hljs-comment >// 降順に処理する</span>
  std::priority_queue&lt;<span class=hljs-type >int</span>, vector&lt;<span class=hljs-type >int</span>&gt;, greater&lt;<span class=hljs-type >int</span>&gt;&gt; que;

  <span class=hljs-comment >// データを追加する</span>
  que.<span class=hljs-built_in >push</span>(<span class=hljs-number >3</span>);
  que.<span class=hljs-built_in >push</span>(<span class=hljs-number >1</span>);
  que.<span class=hljs-built_in >push</span>(<span class=hljs-number >4</span>);

  <span class=hljs-comment >// 降順順に出力する</span>
  <span class=hljs-keyword >while</span> (!que.<span class=hljs-built_in >empty</span>()) {
    std::cout &lt;&lt; que.<span class=hljs-built_in >top</span>() &lt;&lt; std::endl;
    que.<span class=hljs-built_in >pop</span>();
  }
}</code></pre> <pre><code class="julia hljs"><span class=hljs-number >1</span>
<span class=hljs-number >3</span>
<span class=hljs-number >4</span></code></pre> <h2 id=sort ><a href="#sort" class=header-anchor >sort</a></h2> <p>自作 struct に関して sort する.</p> <pre><code class="cpp hljs"><span class=hljs-meta >#<span class=hljs-keyword >include</span> <span class=hljs-string >&lt;iostream&gt;</span></span>
<span class=hljs-meta >#<span class=hljs-keyword >include</span> <span class=hljs-string >&lt;vector&gt;</span></span>
<span class=hljs-meta >#<span class=hljs-keyword >include</span> <span class=hljs-string >&lt;algorithm&gt;</span></span>

<span class=hljs-keyword >using</span> <span class=hljs-keyword >namespace</span> std;

<span class=hljs-keyword >struct</span> <span class="hljs-title class_">Hoge</span> {
    <span class=hljs-type >int</span> x, y;
};

<span class=hljs-function ><span class=hljs-type >bool</span> <span class=hljs-title >compare</span><span class=hljs-params >(Hoge a, Hoge b)</span> </span>{ <span class=hljs-keyword >return</span> a.y &gt; b.y; }

<span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >main</span><span class=hljs-params >(<span class=hljs-type >int</span> argc, <span class=hljs-type >char</span>* argv[])</span>
</span>{
    vector&lt;Hoge&gt; v = { {<span class=hljs-number >0</span>, <span class=hljs-number >1</span>}, {<span class=hljs-number >1</span>, <span class=hljs-number >9</span>} };

    <span class=hljs-built_in >sort</span>(v.<span class=hljs-built_in >begin</span>(), v.<span class=hljs-built_in >end</span>(), compare);

    <span class=hljs-keyword >for</span> (Hoge item : v) {
        cout &lt;&lt; item.x &lt;&lt; <span class=hljs-string >&quot; &quot;</span> &lt;&lt; item.y &lt;&lt; endl;
    }
    <span class=hljs-keyword >return</span> <span class=hljs-number >0</span>;
}</code></pre> <pre><code class="julia hljs"><span class=hljs-number >1</span> <span class=hljs-number >9</span>
<span class=hljs-number >0</span> <span class=hljs-number >1</span></code></pre> <h2 id=ceil_floor ><a href="#ceil_floor" class=header-anchor >ceil, floor</a></h2> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant=normal >/</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">x / y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class=mord >/</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> が負のときにも対応</p> <pre><code class="cpp hljs"><span class=hljs-comment >// ceil(x/y)</span>
<span class=hljs-function >ll <span class=hljs-title >ceil</span><span class=hljs-params >(ll x, ll y)</span> </span>{
    <span class=hljs-keyword >if</span> ((x &gt; <span class=hljs-number >0</span> &amp;&amp; y &gt; <span class=hljs-number >0</span>) || (x &lt; <span class=hljs-number >0</span> &amp;&amp; y &lt; <span class=hljs-number >0</span>)) {
        x = <span class=hljs-built_in >abs</span>(x), y = <span class=hljs-built_in >abs</span>(y);
        <span class=hljs-keyword >return</span> (x + y - <span class=hljs-number >1</span>) / y;
    }

    <span class=hljs-comment >// x/y が負の数のときは整数除算の x/y が切り上げになる</span>
    <span class=hljs-keyword >return</span> x / y;
}

<span class=hljs-comment >// floor(x/y)</span>
<span class=hljs-function >ll <span class=hljs-title >floor</span><span class=hljs-params >(ll x, ll y)</span> </span>{
    <span class=hljs-keyword >if</span> ((x &gt; <span class=hljs-number >0</span> &amp;&amp; y &lt; <span class=hljs-number >0</span>) || (x &gt; <span class=hljs-number >0</span> &amp;&amp; y &lt; <span class=hljs-number >0</span>)) {
        <span class=hljs-keyword >if</span> (x % y != <span class=hljs-number >0</span>) <span class=hljs-keyword >return</span> x / y - <span class=hljs-number >1</span>;
    }

    <span class=hljs-keyword >return</span> x / y;
}</code></pre> <h2 id=gcd_lcm ><a href="#gcd_lcm" class=header-anchor >gcd, lcm</a></h2> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >g</mi><mi mathvariant=normal >c</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><mi>a</mi><mo separator=true >,</mo><mi>b</mi><mo stretchy=false >)</mo><mo>=</mo><mrow><mi mathvariant=normal >g</mi><mi mathvariant=normal >c</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><mi>b</mi><mo separator=true >,</mo><mi>a</mi><mi mathvariant=normal >%</mi><mi>b</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\mathrm{gcd}(a, b) = \mathrm{gcd}(b, a \% b)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">gcd</span></span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">gcd</span></span><span class=mopen >(</span><span class="mord mathnormal">b</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class=mord >%</span><span class="mord mathnormal">b</span><span class=mclose >)</span></span></span></span>.</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle scriptlevel=0  displaystyle=true ><mrow><mi mathvariant=normal >l</mi><mi mathvariant=normal >c</mi><mi mathvariant=normal >m</mi></mrow><mo stretchy=false >(</mo><mi>a</mi><mo separator=true >,</mo><mi>b</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mrow><mi>a</mi><mo>×</mo><mi>b</mi></mrow><mrow><mrow><mi mathvariant=normal >g</mi><mi mathvariant=normal >c</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><mi>a</mi><mo separator=true >,</mo><mi>b</mi><mo stretchy=false >)</mo></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \mathrm{lcm}(a,b) = \frac{a \times b}{\mathrm{gcd}(a,b)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">lcm</span></span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.30744em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">gcd</span></span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> <p>Suppose <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mrow><mi mathvariant=normal >g</mi><mi mathvariant=normal >c</mi><mi mathvariant=normal >d</mi></mrow><mo stretchy=false >(</mo><mi>a</mi><mo separator=true >,</mo><mi>b</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">d = \mathrm{gcd}(a,b)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">gcd</span></span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span></span></span></span>. This means <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mi>d</mi></mrow><annotation encoding="application/x-tex">a = k_1 d</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">d</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><msub><mi>k</mi><mn>2</mn></msub><mi>d</mi></mrow><annotation encoding="application/x-tex">b = k_2 d</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">d</span></span></span></span> for some integers <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo separator=true >,</mo><msub><mi>k</mi><mn>2</mn></msub><mo>∈</mo><mi mathvariant=double-struck >Z</mi></mrow><annotation encoding="application/x-tex">k_1, k_2 \in \mathbb Z</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">Z</span></span></span></span>.</p> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mi>q</mi><mi>b</mi><mo>+</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">a = qb + r</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord mathnormal">b</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mn>0</mn><mo>≤</mo><mi>r</mi><mo>&lt;</mo><mi>b</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(0 \leq r &lt; b)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class=mclose >)</span></span></span></span>, for some integer <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span>.</p> <p>Then <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi mathvariant=normal >%</mi><mi>b</mi><mo>=</mo><mi>r</mi><mo>=</mo><mi>a</mi><mo>−</mo><mi>q</mi><mi>b</mi><mo>=</mo><mi>d</mi><mo stretchy=false >(</mo><msub><mi>k</mi><mn>1</mn></msub><mo>−</mo><mi>q</mi><msub><mi>k</mi><mn>2</mn></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">a\% b = r = a - qb = d(k_1 - qk_2)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord mathnormal">a</span><span class=mord >%</span><span class="mord mathnormal">b</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord mathnormal">b</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span>.</p> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >gcd</span><span class=hljs-params >(<span class=hljs-type >int</span> a, <span class=hljs-type >int</span> b)</span> </span>{
    <span class=hljs-keyword >if</span> (a == <span class=hljs-number >0</span>) <span class=hljs-keyword >return</span> b;
    <span class=hljs-keyword >return</span> <span class=hljs-built_in >gcd</span>(b, a%b);
}

<span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >lcm</span><span class=hljs-params >(<span class=hljs-type >int</span> a, <span class=hljs-type >int</span> b)</span> </span>{
    <span class=hljs-keyword >return</span> a / <span class=hljs-built_in >gcd</span>(a,b) * b;
}</code></pre> <h2 id=cumsum ><a href="#cumsum" class=header-anchor >cumsum</a></h2> <pre><code class="cpp hljs"><span class=hljs-function ><span class=hljs-keyword >template</span>&lt;<span class=hljs-keyword >typename</span> T&gt;
vector&lt;T&gt; <span class=hljs-title >cumsum</span><span class=hljs-params >(vector&lt;T&gt; v)</span> </span>{
    <span class=hljs-type >int</span> n = v.<span class=hljs-built_in >size</span>();
    <span class=hljs-built_in >rep2</span>(i,<span class=hljs-number >1</span>,n) v[i] += v[i<span class=hljs-number >-1</span>];
    <span class=hljs-keyword >return</span> v;
}</code></pre> <h2 id="高速べき乗計算"><a href="#高速べき乗計算" class=header-anchor >高速べき乗計算</a></h2> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">x^n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.664392em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> を高速に求める</p> <pre><code class="cpp hljs"><span class=hljs-comment >// x^n</span>
<span class=hljs-function >ll <span class=hljs-title >pow</span><span class=hljs-params >(ll x, ll n)</span> </span>{
    <span class=hljs-type >long</span> <span class=hljs-type >long</span> ret = <span class=hljs-number >1</span>;
    <span class=hljs-keyword >while</span> (n &gt; <span class=hljs-number >0</span>) {
        <span class=hljs-keyword >if</span> (n &amp; <span class=hljs-number >1</span>) ret *= x;
        x *= x;
        n &gt;&gt;= <span class=hljs-number >1</span>;
    }
    <span class=hljs-keyword >return</span> ret;
}</code></pre> <p>ref: <a href="#逆元">逆元</a></p> <h2 id="素数"><a href="#素数" class=header-anchor >素数</a></h2> <h3 id="エラトステネスのふるい"><a href="#エラトステネスのふるい" class=header-anchor >エラトステネスのふるい</a></h3> <pre><code class="cpp hljs"><span class=hljs-type >int</span> MAX = <span class=hljs-number >100005</span>;
<span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >isprime</span><span class=hljs-params >(MAX, <span class=hljs-literal >true</span>)</span></span>;
isprime[<span class=hljs-number >0</span>] = isprime[<span class=hljs-number >1</span>] = <span class=hljs-literal >false</span>;
<span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> i = <span class=hljs-number >2</span>; i &lt; MAX; i++) {
    <span class=hljs-keyword >if</span> (isprime[i]) {
        <span class=hljs-keyword >for</span> (<span class=hljs-type >int</span> j = i+i; j &lt; MAX; j+=i) {
            isprime[j] = <span class=hljs-literal >false</span>;
        }
    }
}</code></pre> <h2 id="逆元"><a href="#逆元" class=header-anchor >逆元</a></h2> <p>ref: <a href="https://qiita.com/drken/items/3b4fdf0a78e7a138cd9a">「1000000007 で割ったあまり」の求め方を総特集！ 〜 逆元から離散対数まで 〜</a></p> <h3 id=exponential_mod ><a href="#exponential_mod" class=header-anchor >exponential mod</a></h3> <pre><code class="julia hljs">// べき乗 mod
// x^n mod m
ll modpow(ll x, ll n, ll mod) {
    long long ret = <span class=hljs-number >1</span>;
    <span class=hljs-keyword >while</span> (n &gt; <span class=hljs-number >0</span>) {
        <span class=hljs-keyword >if</span> (n &amp; <span class=hljs-number >1</span>) ret = (ret * x) % mod;
        x = (x * x) % mod;
        n &gt;&gt;= <span class=hljs-number >1</span>;
    }
    <span class=hljs-keyword >return</span> ret;
}</code></pre> <p>フェルマーの小定理より素数 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> に対して <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>≡</mo><mn>1</mn><mspace></mspace><mspace width=0.6666666666666666em /><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">a^{p-1} \equiv 1 \mod p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≡</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span><span class="mspace allowbreak"></span><span class=mspace  style="margin-right:0.6666666666666666em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">mod</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span></span></span></span> であるから <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>≡</mo><msup><mi>a</mi><mrow><mi>p</mi><mo>−</mo><mn>2</mn></mrow></msup><mspace></mspace><mspace width=0.6666666666666666em /><mrow><mi mathvariant=normal >m</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">a^{-1} \equiv a^{p-2} \mod p</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≡</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class=mspace  style="margin-right:0.6666666666666666em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class=mord ><span class="mord mathrm">mod</span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span></span></span></span></p> <pre><code class="cpp hljs"><span class=hljs-comment >// べき乗 inv mod</span>
<span class=hljs-comment >// x^{-1} mod m</span>
<span class=hljs-function >ll <span class=hljs-title >modinvpow</span><span class=hljs-params >(ll x, ll mod)</span> </span>{
    <span class=hljs-keyword >return</span> <span class=hljs-built_in >modpow</span>(x, mod<span class=hljs-number >-2</span>, mod);
}</code></pre> <h2 id="行列操作"><a href="#行列操作" class=header-anchor >行列操作</a></h2> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>×</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">H \times W</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >×</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> の行列 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> を考える. <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> に以下の操作を加えたでできた行列を <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mo mathvariant=normal >′</mo></msup></mrow><annotation encoding="application/x-tex">A^\prime</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span> とする. このとき <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mo mathvariant=normal >′</mo></msup></mrow><annotation encoding="application/x-tex">A^\prime</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">A</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span> の <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><msup><mi>i</mi><mo mathvariant=normal >′</mo></msup><mo separator=true >,</mo><msup><mi>j</mi><mo mathvariant=normal >′</mo></msup><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(i^\prime, j^\prime)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.001892em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">i</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span> 成分と <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> の <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><mi>i</mi><mo separator=true >,</mo><mi>j</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(i,j)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal">i</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mclose >)</span></span></span></span> 成分の対応は以下の通りである.</p> <p>各操作を愚直に行うと <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy=false >(</mo><mi>H</mi><mi>W</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">O(HW)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class=mclose >)</span></span></span></span> かかるが, index のみを更新することで <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy=false >(</mo><mi>H</mi><mo>+</mo><mi>W</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">O(H+W)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class=mclose >)</span></span></span></span> に計算量を落とすことができる.</p> <h3 id=rotr90 ><a href="#rotr90" class=header-anchor >rotr90</a></h3> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>i</mi><mo mathvariant=normal >′</mo></msup><mo>=</mo><mi>j</mi><mspace linebreak=newline ></mspace><msup><mi>j</mi><mo mathvariant=normal >′</mo></msup><mo>=</mo><mi>H</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>i</mi></mrow><annotation encoding="application/x-tex"> i^\prime = j \\ j^\prime = H - 1 - i </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">i</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span class="mspace newline"></span><span class=base ><span class=strut  style="height:0.946332em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> <h3 id=rotl90 ><a href="#rotl90" class=header-anchor >rotl90</a></h3> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>i</mi><mo mathvariant=normal >′</mo></msup><mo>=</mo><mi>W</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>j</mi><mspace linebreak=newline ></mspace><msup><mi>j</mi><mo mathvariant=normal >′</mo></msup><mo>=</mo><mi>i</mi></mrow><annotation encoding="application/x-tex"> i^\prime = W - 1 - j \\ j^\prime = i </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">i</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span class="mspace newline"></span><span class=base ><span class=strut  style="height:0.946332em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> <h3 id=transpose ><a href="#transpose" class=header-anchor >transpose</a></h3> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>i</mi><mo mathvariant=normal >′</mo></msup><mo>=</mo><mi>j</mi><mspace linebreak=newline ></mspace><msup><mi>j</mi><mo mathvariant=normal >′</mo></msup><mo>=</mo><mi>i</mi></mrow><annotation encoding="application/x-tex"> i^\prime = j \\ j^\prime = i </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">i</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span class="mspace newline"></span><span class=base ><span class=strut  style="height:0.946332em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> <h3 id="上下反転"><a href="#上下反転" class=header-anchor >上下反転</a></h3> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>i</mi><mo mathvariant=normal >′</mo></msup><mo>=</mo><mi>H</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>i</mi><mspace linebreak=newline ></mspace><msup><mi>j</mi><mo mathvariant=normal >′</mo></msup><mo>=</mo><mi>j</mi></mrow><annotation encoding="application/x-tex"> i^\prime = H - 1 - i \\ j^\prime = j </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">i</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span><span class="mspace newline"></span><span class=base ><span class=strut  style="height:0.946332em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> <h3 id="左右反転"><a href="#左右反転" class=header-anchor >左右反転</a></h3> <p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>i</mi><mo mathvariant=normal >′</mo></msup><mo>=</mo><mi>i</mi><mspace linebreak=newline ></mspace><msup><mi>j</mi><mo mathvariant=normal >′</mo></msup><mo>=</mo><mi>W</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>j</mi></mrow><annotation encoding="application/x-tex"> i^\prime = i \\ j^\prime = W - 1 - j </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.751892em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">i</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span><span class="mspace newline"></span><span class=base ><span class=strut  style="height:0.946332em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.72777em;vertical-align:-0.08333em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> <pre><code class="cpp hljs"><span class=hljs-meta >#<span class=hljs-keyword >include</span> <span class=hljs-string >&lt;iostream&gt;</span></span>
<span class=hljs-meta >#<span class=hljs-keyword >include</span> <span class=hljs-string >&lt;vector&gt;</span></span>
<span class=hljs-meta >#<span class=hljs-keyword >define</span> rep(i,n) for (int i = 0; i &lt; (n); ++i)</span>
<span class=hljs-keyword >using</span> <span class=hljs-keyword >namespace</span> std;
<span class=hljs-keyword >using</span> ll = <span class=hljs-type >long</span> <span class=hljs-type >long</span>;
<span class=hljs-keyword >using</span> P = pair&lt;<span class=hljs-type >int</span>,<span class=hljs-type >int</span>&gt;;

<span class=hljs-keyword >template</span>&lt;<span class=hljs-keyword >typename</span> T&gt;
<span class=hljs-keyword >struct</span> <span class="hljs-title class_">Matrix</span> {
    <span class=hljs-built_in >Matrix</span>(<span class=hljs-type >int</span> h, <span class=hljs-type >int</span> w): <span class=hljs-built_in >isSwap</span>(<span class=hljs-literal >false</span>), <span class=hljs-built_in >H</span>(h), <span class=hljs-built_in >W</span>(w), <span class=hljs-built_in >grid</span>(h, <span class=hljs-built_in >vector</span>&lt;T&gt;(w,<span class=hljs-number >0</span>)), <span class=hljs-built_in >xid</span>(h), <span class=hljs-built_in >yid</span>(w) {
        <span class=hljs-built_in >rep</span>(i,h) xid[i] = i;
        <span class=hljs-built_in >rep</span>(i,w) yid[i] = i;
    }


    <span class=hljs-function >T <span class=hljs-title >find</span><span class=hljs-params >(<span class=hljs-type >int</span> x, <span class=hljs-type >int</span> y)</span> </span>{
        P p = <span class=hljs-built_in >index</span>(x,y);
        <span class=hljs-keyword >return</span> grid[p.first][p.second];
    }

    <span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >set</span><span class=hljs-params >(<span class=hljs-type >int</span> x, <span class=hljs-type >int</span> y, T val)</span> </span>{
        P p = <span class=hljs-built_in >index</span>(x,y);
        grid[p.first][p.second] = val;
    }

    <span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >rotr90</span><span class=hljs-params >()</span> </span>{
        isSwap = !isSwap;
        <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >new_yid</span><span class=hljs-params >(H)</span></span>;
        <span class=hljs-built_in >rep</span>(i,H) new_yid[i] = H - <span class=hljs-number >1</span> - xid[i];
        <span class=hljs-built_in >swap</span>(H, W);
        xid = yid;
        yid = new_yid;
    }

    <span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >rotl90</span><span class=hljs-params >()</span> </span>{
        isSwap = !isSwap;
        <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >new_xid</span><span class=hljs-params >(W)</span></span>;
        <span class=hljs-built_in >rep</span>(i,W) new_xid[i] = W - <span class=hljs-number >1</span> - yid[i];
        <span class=hljs-built_in >swap</span>(H, W);
        yid = xid;
        xid = new_xid;
    }

    <span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >topbottom</span><span class=hljs-params >()</span> </span>{
        <span class=hljs-built_in >rep</span>(i,H/<span class=hljs-number >2</span>) <span class=hljs-built_in >swap</span>(xid[i], xid[H<span class=hljs-number >-1</span>-i]);
    }

    <span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >leftright</span><span class=hljs-params >()</span> </span>{
        <span class=hljs-built_in >rep</span>(i,W/<span class=hljs-number >2</span>) <span class=hljs-built_in >swap</span>(yid[i], yid[W<span class=hljs-number >-1</span>-i]);
    }

    <span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >transpose</span><span class=hljs-params >()</span> </span>{
        isSwap = !isSwap;
        <span class=hljs-built_in >swap</span>(xid, yid);
        <span class=hljs-built_in >swap</span>(H, W);
    }

    <span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >print</span><span class=hljs-params >()</span> </span>{
        <span class=hljs-built_in >rep</span>(i,H) {
            <span class=hljs-built_in >rep</span>(j,W) {
                cout &lt;&lt; <span class=hljs-built_in >find</span>(i,j) &lt;&lt; <span class=hljs-string >&quot; &quot;</span>;
            }
            cout &lt;&lt; endl;
        }
    }

    <span class=hljs-keyword >private</span>:
        <span class=hljs-type >bool</span> isSwap;
        <span class=hljs-type >int</span> H, W;
        vector&lt;vector&lt;T&gt;&gt; grid;

        <span class=hljs-comment >// 新しい行列の index と original の行列の index との対応表</span>
        <span class=hljs-comment >// 新しい行列の i, j 成分は</span>
        <span class=hljs-comment >// swap is false のとき</span>
        <span class=hljs-comment >//   grid[xid[i]][yid[j]]</span>
        <span class=hljs-comment >// swap is true のとき</span>
        <span class=hljs-comment >//   grid[yid[j]][xid[i]]</span>
        vector&lt;<span class=hljs-type >int</span>&gt; xid, yid;

        <span class=hljs-function >pair&lt;<span class=hljs-type >int</span>,<span class=hljs-type >int</span>&gt; <span class=hljs-title >index</span><span class=hljs-params >(<span class=hljs-type >int</span> x, <span class=hljs-type >int</span> y)</span> </span>{
            <span class=hljs-type >int</span> i = xid[x];
            <span class=hljs-type >int</span> j = yid[y];
            <span class=hljs-keyword >if</span> (isSwap) <span class=hljs-built_in >swap</span>(i,j);
            <span class=hljs-keyword >return</span> {i,j};
        }
};

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> h = <span class=hljs-number >2</span>, w = <span class=hljs-number >3</span>;
    <span class=hljs-function >Matrix&lt;<span class=hljs-type >char</span>&gt; <span class=hljs-title >mat</span><span class=hljs-params >(<span class=hljs-number >2</span>, <span class=hljs-number >3</span>)</span></span>;
    <span class=hljs-built_in >rep</span>(i,h) <span class=hljs-built_in >rep</span>(j,w) mat.<span class=hljs-built_in >set</span>(i, j, <span class=hljs-string >&#x27;a&#x27;</span> + i*w + j);
    <span class=hljs-built_in >printf</span>(<span class=hljs-string >&quot;original\n&quot;</span>);
    mat.<span class=hljs-built_in >print</span>();
    cout &lt;&lt; endl;

    <span class=hljs-built_in >printf</span>(<span class=hljs-string >&quot;rotr90\n&quot;</span>);
    mat.<span class=hljs-built_in >rotr90</span>();
    mat.<span class=hljs-built_in >print</span>();
    cout &lt;&lt; endl;

    <span class=hljs-built_in >printf</span>(<span class=hljs-string >&quot;set &#x27;z&#x27; at (0, 1)\n&quot;</span>);
    mat.<span class=hljs-built_in >set</span>(<span class=hljs-number >0</span>, <span class=hljs-number >1</span>, <span class=hljs-string >&#x27;z&#x27;</span>);
    mat.<span class=hljs-built_in >print</span>();
    cout &lt;&lt; endl;

    <span class=hljs-built_in >printf</span>(<span class=hljs-string >&quot;rotr90\n&quot;</span>);
    mat.<span class=hljs-built_in >rotr90</span>();
    mat.<span class=hljs-built_in >print</span>();
    cout &lt;&lt; endl;

    <span class=hljs-built_in >printf</span>(<span class=hljs-string >&quot;rotl90\n&quot;</span>);
    mat.<span class=hljs-built_in >rotl90</span>();
    mat.<span class=hljs-built_in >print</span>();
    cout &lt;&lt; endl;

    <span class=hljs-built_in >printf</span>(<span class=hljs-string >&quot;transpose\n&quot;</span>);
    mat.<span class=hljs-built_in >transpose</span>();
    mat.<span class=hljs-built_in >print</span>();
    cout &lt;&lt; endl;
}

<span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >main</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-built_in >solve</span>();
    <span class=hljs-keyword >return</span> <span class=hljs-number >0</span>;
}</code></pre> </p> <p>output</p> <pre><code class="julia hljs">original
a b c
d e f

rotr90
d a
e b
f c

set <span class=hljs-string >&#x27;z&#x27;</span> at (<span class=hljs-number >0</span>, <span class=hljs-number >1</span>)
d z
e b
f c

rotr90
f e d
c b z

rotl90
d z
e b
f c

transpose
d e f
z b c</code></pre> <h2 id="最長増加部分列_lis_longest_increasing_subsequence"><a href="#最長増加部分列_lis_longest_increasing_subsequence" class=header-anchor >最長増加部分列 &#40;LIS: Longest Increasing Subsequence&#41;</a></h2> <p>数列 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo separator=true >,</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=true >,</mo><mo>⋯</mo><mtext> </mtext><mo separator=true >,</mo><msub><mi>a</mi><mrow><mi>n</mi><mtext>−</mtext><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">A=a_0,a_1,\cdots, a_{n−1}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.638891em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">−1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> の最長増加部分列 &#40;LIS: Longest Increasing Subsequence&#41; とは 数列 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> の増加部分列 <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><msub><mi>i</mi><mn>0</mn></msub></msub><mo separator=true >,</mo><mo>⋯</mo><mtext> </mtext><mo separator=true >,</mo><msub><mi>a</mi><msub><mi>i</mi><mi>k</mi></msub></msub></mrow><annotation encoding="application/x-tex">a_{i_0}, \cdots, a_{i_k}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68642em;vertical-align:-0.25586em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2501em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.25586em;"><span></span></span></span></span></span></span></span></span></span> &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>i</mi><mn>0</mn></msub><mo>&lt;</mo><msub><mi>i</mi><mn>1</mn></msub><mo>&lt;</mo><mo>⋯</mo><mo>&lt;</mo><msub><mi>i</mi><mi>k</mi></msub><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">0 \leq i_0 &lt; i_1 &lt; \cdots &lt; i_k &lt; n</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.78041em;vertical-align:-0.13597em;"></span><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >≤</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.80952em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">i</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.80952em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">i</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.80952em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">i</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> かつ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><msub><mi>i</mi><mn>0</mn></msub></msub><mo>&lt;</mo><msub><mi>a</mi><msub><mi>i</mi><mn>1</mn></msub></msub><mo>&lt;</mo><mo>⋯</mo><mo>&lt;</mo><msub><mi>a</mi><msub><mi>i</mi><mi>k</mi></msub></msub></mrow><annotation encoding="application/x-tex">a_{i_0} &lt; a_{i_1} &lt; \cdots &lt; a_{i_k}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7892em;vertical-align:-0.2501em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2501em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.7892em;vertical-align:-0.2501em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2501em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class=minner >⋯</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68642em;vertical-align:-0.25586em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.25586em;"><span></span></span></span></span></span></span></span></span></span>&#41; のうち最も <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> が大きいもの.</p> <ul> <li><p><a href="https://qiita.com/python_walker/items/d1e2be789f6e7a0851e5">Qiita - 最長増加部分列&#40;LIS&#41;の長さを求める</a></p> <li><p><a href="https://onlinejudge.u-aizu.ac.jp/problems/DPL_1_D">AOJ - 最長増加部分列</a></p> </ul> <pre><code class="cpp hljs"><span class=hljs-comment >// is_strong = true のとき increasing</span>
<span class=hljs-comment >// is_strong = false のとき non-decreasing</span>
<span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >LIS</span><span class=hljs-params >(vector&lt;<span class=hljs-type >int</span>&gt;&amp; A, <span class=hljs-type >bool</span> is_strong)</span> </span>{
    <span class=hljs-type >int</span> n = A.<span class=hljs-built_in >size</span>();
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >dp</span><span class=hljs-params >(n, INF)</span></span>;

    <span class=hljs-built_in >rep</span>(i,n) {
        <span class=hljs-comment >// A_{i_{k}} &lt; A_{i_{k+1}}</span>
        <span class=hljs-keyword >if</span> (is_strong) *<span class=hljs-built_in >lower_bound</span>(<span class=hljs-built_in >all</span>(dp), A[i]) = A[i];
        <span class=hljs-comment >// A_{i_{k}} &lt;= A_{i_{k+1}}</span>
        <span class=hljs-keyword >else</span> *<span class=hljs-built_in >upper_bound</span>(<span class=hljs-built_in >all</span>(dp), A[i]) = A[i];
    }

    <span class=hljs-keyword >return</span> <span class=hljs-built_in >lower_bound</span>(<span class=hljs-built_in >all</span>(dp), INF) - dp.<span class=hljs-built_in >begin</span>();
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n;
    cin &gt;&gt; n;
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >a</span><span class=hljs-params >(n)</span></span>;
    <span class=hljs-built_in >rep</span>(i, n) cin &gt;&gt; a[i];
    cout &lt;&lt; <span class=hljs-built_in >LIS</span>(a, <span class=hljs-literal >true</span>) &lt;&lt; endl;
}</code></pre> <h2 id="最短経路"><a href="#最短経路" class=header-anchor >最短経路</a></h2> <h3 id="ダイクストラ法_dijkstra"><a href="#ダイクストラ法_dijkstra" class=header-anchor >ダイクストラ法 &#40;Dijkstra&#41;</a></h3> <pre><code class="cpp hljs"><span class=hljs-keyword >using</span> Graph = vector&lt;vector&lt;Edge&gt;&gt;;

<span class=hljs-comment >// node s からの最短距離を求める</span>
<span class=hljs-comment >// 到達できない node との距離は INF になる.</span>
<span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >dijkstra</span><span class=hljs-params >(Graph &amp;graph, <span class=hljs-type >int</span> s)</span> </span>{
    <span class=hljs-type >int</span> n = graph.<span class=hljs-built_in >size</span>();
    <span class=hljs-function >vector&lt;<span class=hljs-type >int</span>&gt; <span class=hljs-title >dist</span><span class=hljs-params >(n, INF)</span></span>;
    dist[s] = <span class=hljs-number >0</span>;
    <span class=hljs-comment >// P: cost, node</span>
    priority_queue&lt;P, vector&lt;P&gt;, greater&lt;P&gt;&gt; pq;
    pq.<span class=hljs-built_in >push</span>({<span class=hljs-number >0</span>, s});
    <span class=hljs-keyword >while</span> (!pq.<span class=hljs-built_in >empty</span>()) {
        <span class=hljs-keyword >auto</span> node = pq.<span class=hljs-built_in >top</span>();
        pq.<span class=hljs-built_in >pop</span>();

        <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> e : graph[node.second]) {
            <span class=hljs-keyword >if</span> (dist[e.to] &gt; dist[node.second] + e.cost) {
                dist[e.to] = dist[node.second] + e.cost;
                pq.<span class=hljs-built_in >push</span>({dist[e.to], e.to});
            }
        }
    }

    <span class=hljs-keyword >return</span> dist;
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> v, e, r;
    cin &gt;&gt; v &gt;&gt; e &gt;&gt; r;
    <span class=hljs-function >Graph <span class=hljs-title >graph</span><span class=hljs-params >(v)</span></span>;
    <span class=hljs-built_in >rep</span>(i,e) {
        <span class=hljs-type >int</span> s, t, d;
        cin &gt;&gt; s &gt;&gt; t &gt;&gt; d;
        graph[s].<span class=hljs-built_in >push_back</span>({t, d});
    }

    <span class=hljs-keyword >auto</span> dist = <span class=hljs-built_in >dijkstra</span>(graph, r);
    <span class=hljs-built_in >rep</span>(i,v) {
        <span class=hljs-keyword >if</span> (dist[i] == INF) cout &lt;&lt; <span class=hljs-string >&quot;INF&quot;</span> &lt;&lt; endl;
        <span class=hljs-keyword >else</span> cout &lt;&lt; dist[i] &lt;&lt; endl;
    }
}</code></pre> <h2 id="最小全域木minimum_spanning_tree"><a href="#最小全域木minimum_spanning_tree" class=header-anchor >最小全域木&#40;minimum spanning tree&#41;</a></h2> <h3 id="プリム法"><a href="#プリム法" class=header-anchor >プリム法</a></h3> <p>適当な頂点&#40;本当にどこからでもいい&#41;を起点にして, まだ訪れていない頂点への最小のコストの辺を採用していく. すでに訪れた頂点への辺は捨てる.</p> <pre><code class="cpp hljs"><span class=hljs-keyword >struct</span> <span class="hljs-title class_">Edge</span> {
    <span class=hljs-type >int</span> to;
    ll cost;
};

<span class=hljs-type >bool</span> <span class=hljs-keyword >operator</span>&gt;(<span class=hljs-type >const</span> Edge &amp;a, <span class=hljs-type >const</span> Edge &amp;b) {
    <span class=hljs-keyword >return</span> a.cost &gt; b.cost;
}

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n, m;
    cin &gt;&gt; n &gt;&gt; m;
    vector&lt;vector&lt;Edge&gt;&gt; <span class=hljs-built_in >graph</span>(n);
    <span class=hljs-built_in >rep</span>(i,m) {
        <span class=hljs-type >int</span> s, t;
        ll w;
        cin &gt;&gt; s &gt;&gt; t &gt;&gt; w;
        graph[s].<span class=hljs-built_in >push_back</span>({t, w});
        graph[t].<span class=hljs-built_in >push_back</span>({s, w});
    }

    <span class=hljs-function >vint <span class=hljs-title >visited</span><span class=hljs-params >(n, <span class=hljs-number >0</span>)</span></span>;
    visited[<span class=hljs-number >0</span>] = <span class=hljs-number >1</span>;
    priority_queue&lt;Edge, vector&lt;Edge&gt;, greater&lt;Edge&gt;&gt; pq;
    <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> edge : graph[<span class=hljs-number >0</span>]) pq.<span class=hljs-built_in >push</span>(edge);
    vector&lt;Edge&gt; mst;
    <span class=hljs-keyword >while</span> (pq.<span class=hljs-built_in >size</span>()) {
        <span class=hljs-keyword >auto</span> t = pq.<span class=hljs-built_in >top</span>(); pq.<span class=hljs-built_in >pop</span>();
        <span class=hljs-keyword >if</span> (visited[t.to]) <span class=hljs-keyword >continue</span>;
        visited[t.to] = <span class=hljs-number >1</span>;
        mst.<span class=hljs-built_in >push_back</span>(t);
        <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> edge : graph[t.to]) {
            <span class=hljs-keyword >if</span> (visited[edge.to]) <span class=hljs-keyword >continue</span>;
            pq.<span class=hljs-built_in >push</span>(edge);
        }
    }

    ll tot = <span class=hljs-number >0</span>;
    <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> edge : mst) {
        tot += edge.cost;
    }
    cout &lt;&lt; tot &lt;&lt; endl;
}</code></pre> <h3 id="クラスカル法"><a href="#クラスカル法" class=header-anchor >クラスカル法</a></h3> <p>全ての辺をコストが小さい順に見ていき, 見ている辺をつないだときにサイクルができなければその辺を採用, それ以外のときは捨てる. サイクルの検出には Union Find を使うのが定石.</p> <pre><code class="cpp hljs"><span class=hljs-keyword >struct</span> <span class="hljs-title class_">Edge</span> {
    <span class=hljs-type >int</span> from;
    <span class=hljs-type >int</span> to;
    ll cost;
};

<span class=hljs-type >bool</span> <span class=hljs-keyword >operator</span>&lt;(<span class=hljs-type >const</span> Edge &amp;a, <span class=hljs-type >const</span> Edge &amp;b) {
    <span class=hljs-keyword >return</span> a.cost &lt; b.cost;
}

<span class=hljs-keyword >struct</span> <span class="hljs-title class_">UnionFind</span> {
    vint d;
    <span class=hljs-built_in >UnionFind</span>(<span class=hljs-type >int</span> n) : <span class=hljs-built_in >d</span>(n, <span class=hljs-number >-1</span>) {}
    <span class=hljs-function ><span class=hljs-type >int</span> <span class=hljs-title >leader</span><span class=hljs-params >(<span class=hljs-type >int</span> x)</span> </span>{
        <span class=hljs-keyword >if</span> (d[x] &lt; <span class=hljs-number >0</span>) <span class=hljs-keyword >return</span> x;
        <span class=hljs-keyword >return</span> d[x] = <span class=hljs-built_in >leader</span>(d[x]);
    }
    <span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >merge</span><span class=hljs-params >(<span class=hljs-type >int</span> x, <span class=hljs-type >int</span> y)</span> </span>{
        x = <span class=hljs-built_in >leader</span>(x), y = <span class=hljs-built_in >leader</span>(y);
        <span class=hljs-keyword >if</span> (x == y) <span class=hljs-keyword >return</span>;
        <span class=hljs-keyword >if</span> (d[x] &lt; d[y]) <span class=hljs-built_in >swap</span>(x, y);
        d[x] += d[y];
        d[y] = x;
    }
    <span class=hljs-function ><span class=hljs-type >bool</span> <span class=hljs-title >same</span><span class=hljs-params >(<span class=hljs-type >int</span> x, <span class=hljs-type >int</span> y)</span> </span>{
        <span class=hljs-keyword >return</span> <span class=hljs-built_in >leader</span>(x) == <span class=hljs-built_in >leader</span>(y);
    }
};

<span class=hljs-function ><span class=hljs-type >void</span> <span class=hljs-title >solve</span><span class=hljs-params >()</span> </span>{
    <span class=hljs-type >int</span> n, m;
    cin &gt;&gt; n &gt;&gt; m;
    vector&lt;Edge&gt; edges;
    <span class=hljs-built_in >rep</span>(i,m) {
        <span class=hljs-type >int</span> s, t;
        ll w;
        cin &gt;&gt; s &gt;&gt; t &gt;&gt; w;
        edges.<span class=hljs-built_in >push_back</span>({s, t, w});
        edges.<span class=hljs-built_in >push_back</span>({t, s, w});
    }
    <span class=hljs-built_in >sort</span>(<span class=hljs-built_in >all</span>(edges));

    vector&lt;Edge&gt; mst_edges;
    <span class=hljs-function >UnionFind <span class=hljs-title >uf</span><span class=hljs-params >(n)</span></span>;
    <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> [from, to, cost] : edges) {
        <span class=hljs-keyword >if</span> (!uf.<span class=hljs-built_in >same</span>(from, to)) {
            mst_edges.<span class=hljs-built_in >push_back</span>({from, to, cost});
            uf.<span class=hljs-built_in >merge</span>(from, to);
        }
    }

    ll tot = <span class=hljs-number >0</span>;
    <span class=hljs-keyword >for</span> (<span class=hljs-keyword >auto</span> edge : mst_edges) tot += edge.cost;
    cout &lt;&lt; tot &lt;&lt; endl;
}</code></pre> <div class=page-foot > <div class=copyright > &copy; <a href=https://github.com/goropikari>goropikari</a>. Last modified: March 07, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. This site source is located at <a href=https://goropikari.github.io/CompetitiveProgramming>goropikari/CompetitiveProgramming</a> </div> </div> </div> </div>